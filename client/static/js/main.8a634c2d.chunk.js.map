{"version":3,"sources":["components/Layout/Layout.module.css","websocketActions/sendUpdate.tsx","websocketActions/resources.tsx","websocketActions/websites.tsx","websocketActions/index.tsx","components/Svg/Svg.tsx","store/actions/builder.ts","store/actions/auth.tsx","store/actions/website.tsx","store/actions/resources.tsx","store/actions/webSocket.tsx","store/actions/index.tsx","utils/getEssentialData.tsx","store/actions/files.tsx","utils/getBoxType.tsx","containers/Auth/Auth.module.css","containers/Courses/Courses.module.css","components/UI/Spinner/Spinner.module.css","store/middleware/throttle.js","containers/Auth/Logout/Logout.tsx","hoc/asyncComponent.js","containers/Auth/Auth.tsx","components/UI/Spinner/Spinner.js","containers/Courses/Courses.tsx","components/Layout/Layout.jsx","App.tsx","utils/resourcesAreEqual.tsx","store/reducer/resources.tsx","store/reducer/reducer.tsx","store/reducer/images.tsx","store/reducer/auth.tsx","index.tsx","utils/basic.tsx","utils/resourceTypeIndex.tsx","components/ReserveWebsite/methods/getListOfNeededResources.js","components/ReserveWebsite/ReserveWebsite.js","utils/buildRelUrls.tsx"],"names":["module","exports","componentsLayoutDemoCustomTriggerTrigger","componentsLayoutDemoCustomTriggerLogo","siteLayoutSiteLayoutBackground","diffpatcher","require","create","objectHash","obj","id","propertyFilter","name","context","sendUpdate","type","changes","dispatch","getState","sessionStorage","getItem","alert","draft","currentDraft","mD","oldResource","resourcesObjects","includes","resourceDraftIndex","newResource","Object","objectSpread","pagesStructure","buildRelUrls","filesStructure","patch","diff","webSocket","readyState","send","JSON","stringify","messageCode","_id","__patch__","__v","markPublish","resourceItemIndex","notPublished","actions","addResource","duplicate","newResourceName","resourceData","callbackId","websiteId","currentWebsiteId","current","deleteResource","window","confirm","publishResource","revertResource","to","resourceObjectIndex","changeWebsiteProperty","key","value","currentWebsiteObject","cloneDeep","addWebsite","deleteWebsite","verifyCustomDomain","sharingRightsChange","userId","right","newSharing","sharing","account","find","item","newRights","concat","toConsumableArray","rights","filter","addUserInWebsiteSharing","prompt","deleteUserInWebsiteSharing","transferWebsite","userTo","saveDomainName","__webpack_require__","d","__webpack_exports__","sendUpdate_sendUpdate","resources_addResource","resources_deleteResource","resources_publishResource","resources_revertResource","websites_addWebsite","websites_deleteWebsite","websites_changeWebsiteProperty","websites_verifyCustomDomain","websites_sharingRightsChange","websites_addUserInWebsiteSharing","websites_deleteUserInWebsiteSharing","websites_transferWebsite","websites_saveDomainName","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","n","Svg","props","result","icon","objectSvg","svg","stack","length","trim","indexOf","substring","pop","curObj","children","attr","selfclosing","push","svgStringToObj","a","createElement","data-testid","datatestid","height","width","viewBox","className","map","element","index","svgChildrenToElements","elementIndex","fill","el","htmlparser","findElementIndex","currentBox","structure","findIndex","findRouteElements","mode","forEach","path","isEqual","trashIndex","saveElementsStructure","resourceDraft","newStructure","oldItem","itemInn","expanded","isNotForHistory","omit","saveElementsStructureFromBuilder","globalSettings","chooseBox","unhoverBox","changeBoxPropertyInStructure","boxId","deleteFromHoveredSizes","isObject","String","toString","slice","throttle","changeBoxPropertyInValues","values","defineProperty","saveHoveredElementRect","size","currentResource","removedElements","hoverBox","fromFrame","toggleFindMode","addBox","putInside","elementValues","isChildren","childrenTo","text","CMSVariableType","isPropagatingItem","newId","currentId","newCurrentId","isCMSVariable","tag","textMode","isElementFromCMSVariable","textContent","properties","propertiesString","CMSVariableSystemName","CMSVariableDescription","CMSVariableDefaultValue","deleteBox","withChildren","routeElements","itemInStructure","elementId","notRemove","newPageStructure","pathItem","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","err","return","trashItem","structureElementsToLeave","trash","style","duplicateBox","idPrefix","sourceChildren","idMatch","newValuesElements","newChildren","newItemId","splitText","start","end","textContent0","substr","textContent1","textContent2","newElements","newValues","textToSpan","spanId","changeMenuItemProperty","itemId","resource","menuItems","newMenuItems","currentMenuItem","markRefreshing","refreshing","markShouldRefreshing","mergeBoxToPlugin","onlyChildren","newResourcesIds","oldResourcesIds","resourceDataValues","resourceDataStructure","newItem","element_0","newPluginName","addWSCallback","i","wsActions","dissolvePluginToBox","plugin","pluginsStructure","pluginResource","present","pluginDataValues","pluginDataStructure","parseHTML","htmlArray","parseDOM","newElementsValues","parseToWebsiter","curArray","data","attribs","newElement","newElementValues","copyBox","cut","removedElementsIds","cutPath","oldStructure","structureElementsToRemain","valuesToLeave","saveToClipboard","pasteBox","inside","state","clipboard","pastToElementItem","onlyInside","fromElement","fromElementValues","toElement","toElementValues","fromType","getBoxType","toType","checkPossibilityToPaste","cookies","Cookies","authSuccess","deleteUser","logout","all","remove","axios","defaults","headers","common","logoutDo","authCheckState","setItem","tryWebsiter","get","removeItem","token","rememberMe","jwt","decode","post","put","delete","Accept","then","catch","error","message","changeBarSizeDo","savePropertiesOnLeave","_getState","barSizes","settings","userObject","changeBarSize","initiator","dif","dif2","value2","value3","Math","max","innerWidth","innerHeight","width2","width3","setActiveTab","activeKey","chooseWebsite","currentWebsite","saveObject","chooseUserInWebsiteSharing","setSizeIsChanging","isChanging","saveMainData","chooseResource","resourceType","websites","globalSettingsPageId","currentPageFSBId","addResourceVersion","meta","setActiveContainer","container","unsetActiveContainer","removeResourceFromUnsaved","removeResourceFromNewVersions","setActivePinnedElement","pinnedElement","removePinnedElement","addPinnedElement","pinPinnedElement","addResourceDo","updateUser","currentUser","resourceId","requestResource","updateWebsite","newWebsite","updateResource","isEmpty","builder_chooseBox","builder_addBox","builder_deleteBox","builder_duplicateBox","builder_saveElementsStructure","builder_saveElementsStructureFromBuilder","builder_changeBoxPropertyInStructure","builder_changeBoxPropertyInValues","builder_splitText","builder_textToSpan","builder_changeMenuItemProperty","builder_mergeBoxToPlugin","builder_dissolvePluginToBox","builder_parseHTML","builder_copyBox","builder_pasteBox","auth_logout","auth_authCheckState","auth_deleteUser","auth_changeBarSize","auth_savePropertiesOnLeave","website_chooseWebsite","files","resources_chooseResource","webSocket_updateUser","webSocket_updateWebsite","webSocket_updateResource","currentWebsiteItem","templatesStructure","currentPageItem","currentPageFSBItem","currentTemplateItem","currentPluginItem","currentFileItem","currentPageObject","currentPageFSBObject","currentTemplateObject","currentPluginObject","currentPageDraft","currentPageFSBDraft","currentTemplateDraft","currentPluginDraft","globalSettingsPageObject","globalSettingsPageDraft","globalSettingsTemplateId","globalSettingsTemplateDraft","pageTemplateItem","pageTemplateObject","pageTemplateDraft","pageTemplateFSBItem","pageTemplateFSBObject","pageTemplateFSBDraft","pinnedElementsWithTitles","courses","userCourses","currentPageId","currentTemplateId","currentPluginId","currentFileId","pageTemplateName","pageTemplateId","pageTemplateFSBName","pageTemplateFSBId","nextFileId","pinnedElements","currentWebsiteItemSettings","template","hidden","globalSettingsPageItem","generalSettings","globalSettingsTemplateItem","globalSettingsTemplateObject","process","getCurrentResourceValue","elementItem","_home_ndjs_websiter_websiter_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","title","prod","actionFailImageUpload","getSignedRequest","replace","editorMode","file","thumbnail","resolution","cleanName","namePrefix","k","serverName","fileDetails","v","thumbnailDetails","_home_ndjs_websiter_websiter_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__","fileName","fileType","fileSize","thumbnailName","thumbnailType","thumbnailSize","response","doUploadFile","status","signedRequestThumbnail","Content-Type","signedRequest","newFileItem","url","modifiedDate","Date","now","_home_ndjs_websiter_websiter_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__","createdDate","storage","newStorage","uploadFile","isCreated","reader","FileReader","onload","_ref","_home_ndjs_websiter_websiter_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__","_home_ndjs_websiter_websiter_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","mark","_callee","event","wrap","_context","prev","FileType","fromBuffer","target","sent","mime","resizeImageToSpecificSize","urltoFile","getResolution","stop","_x","apply","this","arguments","readAsArrayBuffer","filename","mimeType","match","fetch","res","arrayBuffer","buf","File","cb","resizeImageFromSrcToSpecificSize","readAsDataURL","src","img","Image","widthCoef","heightCoef","oc","document","octx","getContext","drawImage","toDataURL","_URL","URL","webkitURL","objectUrl","createObjectURL","revokeObjectURL","deleteFile","fileId","_basic__WEBPACK_IMPORTED_MODULE_0__","isFromBuffer","currentBoxType","resourceDraftStructure","resourceDraftValues","checkIfCapital","charAt","Container","socialButtons","Lesson","Cover","CANCEL","FLUSH","throttled","action","method","payload","types","Array","isArray","keys","t","Logout","onLogout","react_default","Redirect","Component","connect","asyncComponent","importComponent","_Component","_temp","_getPrototypeOf2","_this","classCallCheck","_len","args","_key","possibleConstructorReturn","getPrototypeOf","call","component","inherits","createClass","_this2","cmp","setState","default","C","Auth","_useState","useState","_useState2","slicedToArray","_useState3","_useState4","cookieConsent","setCookieConsent","useEffect","checkCookieConsent","remeberMeParam","basicURL","classes","Fragment","href","es_checkbox","checked","onChange","es_button","onClick","set","maxAge","open","spinner","spiningIcon","spin","indicator","LoadingOutlined_default","fontSize","tip","cover","getCourses","card","hoverable","backgroundImage","backgroundSize","backgroundPosition","Meta","description","Header","Layout","Sider","Content","withRouter","toggle","layout","collapsible","collapsed","onCollapse","menu","theme","defaultSelectedKeys","onSelect","history","Item","CoffeeOutlined_default","RocketOutlined_default","UserOutlined_default","LogoutOutlined_default","padding","React","MenuUnfoldOutlined","MenuFoldOutlined","margin","minHeight","asyncSiteBuilderLayout","Promise","e","bind","App","onTryAutoSignup","isAuthed","isAuthenticated","routes","Switch","Route","exact","render","containers_Courses_Courses","assign","location","pathname","loading","Spinner","resourcesAreEqual","draft1","draft2","notSavedResources","newVersionResources","initialState","domainNotOk","customDomainNotOk","maxStorage","uploadingImage","currentBoxInPlugin","currentImage","sizeIsChanging","pageZoom","hoveredElementId","hoveredElementSize","isRefreshing","findMode","hoverMode","search","shouldRefresh","currentUserInWebsiteSharing","activeContainer","activePinnedElement","currentPinnedElementId","activeTab","reducer","createReducer","REMOVE_RESOURCE_FROM_UNSAVED","resources","REMOVE_RESOURCE_FROM_NEW_VERSIONS","ACTION_START_IMAGE_UPLOAD","images","ACTION_FAIL_IMAGE_UPLOAD","ACTION_SUCCESS_IMAGE_UPLOAD","CHOOSE_IMAGE","image","SIZE_IS_CHANGING","ACTION_START","pagesLoading","ACTION_FAIL","ACTION_SUCCESS","ADD_RESOURCE_VERSION","newDraft","connectedResources","currentResourceId","future","AUTH_START","auth","AUTH_SUCCESS","accountInfo","AUTH_FAIL","AUTH_LOGOUT","CHANGE_BAR_SIZE","SAVE_HOVERED_ELEMENT_RECT","checkAndCreatePath","parent","REMOVE_FROM_HOVERED_SIZES","checkAndRemoveElement","child","removeFromHoveredSizes","HOVER_ELEMENT","UNHOVER_ELEMENT","TOGGLE_FIND_MODE","MARK_REFRESHING","MARK_SHOULD_REFRESHING","CHOOSE_USER_IN_WEBSITE_SHARING","SET_CURRENT_SITEBUILDER_MODE","currentSiteBuilderMode","SAVE_MAIN_DATA","ADD_RESOURCE","DELETE_RESOURCE","REVERT_RESOURCE","SAVE_OBJECT","SET_ACTIVE_CONTAINER","UNSET_ACTIVE_CONTAINER","SAVE_TO_CLIPBOARD","SET_ACTIVE_PINNED_ELEMENT","activePinnedItem","REMOVE_PINNED_ELEMENT","SET_ACTIVE_TAB","ADD_PINNED_ELEMENT","unpinned","pinned","PIN_PINNED_ELEMENT","src_store","baseURL","throttleMiddleware","defaultWait","defaultThrottleOption","store","shouldThrottle","wait","options","isNaN","leading","trailing","createStore","composeWithDevTools","applyMiddleware","thunk","app","es","BrowserRouter","src_App","inIframe","self","top","root","getElementById","ReactDOM","buildTree","getInheritedPropertyName","isEqualStructuresWithOmit","lodash_isEmpty__WEBPACK_IMPORTED_MODULE_0__","lodash_isEmpty__WEBPACK_IMPORTED_MODULE_0___default","lodash_isEqual__WEBPACK_IMPORTED_MODULE_1__","lodash_isEqual__WEBPACK_IMPORTED_MODULE_1___default","lodash_omit__WEBPACK_IMPORTED_MODULE_2__","lodash_omit__WEBPACK_IMPORTED_MODULE_2___default","char","toUpperCase","toLowerCase","_defineProperty","enumerable","configurable","writable","_objectWithoutProperties","source","excluded","sourceKeys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","prototype","propertyIsEnumerable","items","buildItem","ownKeys","sym","getOwnPropertyDescriptor","_objectSpread","structure1","structure2","page","addConnectedResources","newRequestedResourcesList","connectedResource","nextResourceItem","nextResourceObject","nextResourceDraft","currentCallbackId","callbacks","callback","fireCallback","ReserveWebsiteInn","requestedResources","taskId","pingTimeout","authInterval","WebSocket","heartbeat","clearTimeout","setTimeout","close","versions","onopen","user","setInterval","noRequest","onmessage","parse","confirmSaved","markNotFoundResource","onclose","clearInterval","checkInterval","check","reRequestResourcesInterval","reRequestResources","requestedResource","nextProps","from","Set","getListOfNeededResources","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_loop","requestItem","requestedResourceItem","_iterator2","ReserveWebsiteDo","mainData","getEssentialData","relUrl","reduce","totalPath","folderPage"],"mappings":"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","file":"static/js/main.8a634c2d.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"componentsLayoutDemoCustomTriggerTrigger\":\"Layout_componentsLayoutDemoCustomTriggerTrigger__XwSVl\",\"componentsLayoutDemoCustomTriggerLogo\":\"Layout_componentsLayoutDemoCustomTriggerLogo__1i_3g\",\"siteLayoutSiteLayoutBackground\":\"Layout_siteLayoutSiteLayoutBackground__3ZeZ0\"};","import { webSocket } from '../components/ReserveWebsite/ReserveWebsite'\nimport {\n    resourceItemIndex,\n    resourceDraftIndex,\n} from '../utils/resourceTypeIndex'\nimport * as actions from '../store/actions'\nimport buildRelUrls from '../utils/buildRelUrls'\n\nconst diffpatcher = require('jsondiffpatch/dist/jsondiffpatch.umd.js').create({\n    objectHash: obj => obj.id,\n    propertyFilter: (name, context) => name !== '__patch__',\n})\n\nexport const sendUpdate = (\n    type: 'user' | 'website' | 'page' | 'template' | 'plugin',\n    changes: {},\n    id: string\n) => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    const oldResource = mD.resourcesObjects[id]\n    if (oldResource) {\n        let draft, currentDraft\n        if (['page', 'template', 'plugin'].includes(type)) {\n            draft = oldResource.draft\n            currentDraft = mD[resourceDraftIndex[type]]\n        } else {\n            draft = oldResource\n            currentDraft = oldResource\n        }\n        if (draft && changes) {\n            const newResource = { ...currentDraft, ...changes }\n            if (type === 'website') {\n                newResource.pagesStructure = buildRelUrls(\n                    newResource.pagesStructure,\n                    true\n                )\n                newResource.filesStructure = buildRelUrls(\n                    newResource.filesStructure\n                )\n            }\n            const patch = diffpatcher.diff(draft, newResource)\n            if (patch) {\n                if (webSocket && webSocket.readyState !== 3) {\n                    webSocket.send(\n                        JSON.stringify({\n                            messageCode: 'updateResource',\n                            type,\n                            _id: id,\n                            __patch__: patch,\n                            __v: oldResource.__v,\n                            markPublish: [\n                                'page',\n                                'template',\n                                'plugin',\n                            ].includes(type)\n                                ? !mD[resourceItemIndex[type]].notPublished\n                                : false,\n                        })\n                    )\n                }\n            } else {\n                actions.removeResourceFromUnsaved({ _id: id })\n                actions.removeResourceFromNewVersions({ _id: id })\n            }\n        }\n    }\n}\n","import { webSocket } from '../components/ReserveWebsite/ReserveWebsite'\nimport { current, resourceObjectIndex } from '../utils/resourceTypeIndex'\nimport * as actions from '../store/actions'\n\nexport const addResource = (\n    type: 'page' | 'plugin' | 'template',\n    duplicate?: boolean,\n    newResourceName?: string,\n    resourceData?: {},\n    callbackId?: string\n) => (dispatch: Object, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'addResource',\n                type,\n                websiteId: mD.currentWebsiteId,\n                duplicate,\n                _id: mD[current[type]],\n                name: newResourceName,\n                resourceData,\n                callbackId,\n            })\n        )\n    }\n}\n\nexport const deleteResource = (type: 'page' | 'plugin' | 'template') => (\n    dispatch: Object,\n    getState\n) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (!window.confirm('Are you sure you want to delete this resource?'))\n        return\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'deleteResource',\n                type,\n                _id: mD[current[type]],\n                websiteId: mD.currentWebsiteId,\n            })\n        )\n    }\n}\n\nexport const publishResource = (type: 'page' | 'plugin' | 'template') => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'publishResource',\n                type,\n                _id: mD[current[type]],\n            })\n        )\n    }\n}\n\nexport const revertResource = (type, to) => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (to === 'draft') {\n        dispatch(\n            actions.revertResource({\n                _id: mD[current[type]],\n                draft: mD[resourceObjectIndex[type]].draft,\n                to,\n            })\n        )\n    } else {\n        if (webSocket && webSocket.readyState !== 3) {\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'revertResource',\n                    type,\n                    _id: mD[current[type]],\n                    to,\n                })\n            )\n        }\n    }\n}\n","import { webSocket } from '../components/ReserveWebsite/ReserveWebsite'\nimport { sendUpdate } from './sendUpdate'\nimport cloneDeep from 'lodash/cloneDeep'\n\nexport const changeWebsiteProperty = (key, value, id) => (\n    dispatch,\n    getState\n) => {\n    const { mD } = getState()\n    if (!mD.currentWebsiteObject || !mD.currentWebsiteId) return\n    const newResource = cloneDeep(\n        id ? mD.resourcesObjects[id] : mD.currentWebsiteObject\n    )\n    if (!newResource) return\n    newResource[key] = value\n    dispatch(sendUpdate('website', newResource, mD.currentWebsiteId))\n}\n\nexport const addWebsite = (duplicate?: boolean) => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'addWebsite',\n                _id: mD.currentWebsiteId,\n                duplicate,\n            })\n        )\n    }\n}\n\nexport const deleteWebsite = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (!window.confirm('Are you sure you want to delete this website?')) return\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'deleteWebsite',\n                _id: mD.currentWebsiteId,\n            })\n        )\n    }\n}\n\nexport const verifyCustomDomain = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'verifyCustomDomain',\n                _id: mD.currentWebsiteId,\n            })\n        )\n    }\n}\n\nexport const sharingRightsChange = (userId, right, value) => (\n    dispatch,\n    getState\n) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (mD.currentWebsiteObject) {\n        const newSharing = cloneDeep(mD.currentWebsiteObject.sharing)\n        const account = newSharing.find(item => item.userId === userId)\n        if (account) {\n            let newRights = []\n            if (value) {\n                newRights = [...account.rights, right]\n            } else {\n                newRights = account.rights.filter(item => item !== right)\n            }\n            // const updatedSharing = mD.currentWebsiteObject.sharing.filter(\n            //     item => item.userId !== userId\n            // )\n            // updatedSharing.push({\n            //     ...account,\n            //     rights: newRights,\n            // })\n            account.rights = newRights\n            dispatch(\n                changeWebsiteProperty(\n                    'sharing',\n                    newSharing,\n                    mD.currentWebsiteId\n                )\n            )\n        }\n    }\n}\n\nexport const addUserInWebsiteSharing = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (mD.currentWebsiteObject) {\n        const id = window.prompt('Paste the user id to share the website.')\n        if (!id) return\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'addUserInSharing',\n                _id: mD.currentWebsiteId,\n                userId: id,\n                type: 'add',\n            })\n        )\n    }\n}\n\nexport const deleteUserInWebsiteSharing = userId => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (\n        !window.confirm(\n            'Are you sure you want to delete this user from sharing?'\n        )\n    )\n        return\n    const { mD } = getState()\n    if (userId && userId !== mD.userId) {\n        if (\n            !window.confirm(\n                'Are you sure you want to remove this user from sharing?'\n            )\n        )\n            return\n    }\n\n    webSocket.send(\n        JSON.stringify({\n            messageCode: 'addUserInSharing',\n            _id: mD.currentWebsiteId,\n            userId,\n            type: 'delete',\n        })\n    )\n}\n\nexport const transferWebsite = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (mD.currentWebsiteObject) {\n        const userTo = window.prompt(\n            'Enter the user id to whom you would like to transfer the website. It can be found in the user account menu tab.'\n        )\n        if (\n            !userTo ||\n            !window.confirm(\n                'Are you sure you want to transfer this website to user - ' +\n                    userTo +\n                    '?'\n            )\n        )\n            return\n\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'transferWebsite',\n                _id: mD.currentWebsiteId,\n                userTo,\n            })\n        )\n    }\n}\n\nexport const saveDomainName = (name, type) => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (mD.currentWebsiteObject) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'saveDomainName',\n                _id: mD.currentWebsiteId,\n                name,\n                type,\n            })\n        )\n    }\n}\n","export { sendUpdate } from './sendUpdate'\n\nexport {\n    addResource,\n    deleteResource,\n    publishResource,\n    revertResource,\n} from './resources'\n\nexport {\n    addWebsite,\n    deleteWebsite,\n    changeWebsiteProperty,\n    verifyCustomDomain,\n    sharingRightsChange,\n    addUserInWebsiteSharing,\n    deleteUserInWebsiteSharing,\n    transferWebsite,\n    saveDomainName,\n} from './websites'\n","import React from 'react'\n\n// type Props = {\n//     className?: string,\n//     icon: ?string,\n//     datatestid?: string,\n// }\n\n// type Element = {\n//     type: string,\n//     children: Array<Element>,\n//     fill: string,\n//     d: string,\n// }\n\nexport const Svg = props => {\n    const svgStringToObj = svg => {\n        const obj = []\n\n        const stack = []\n\n        while (svg.length > 0) {\n            svg = svg.trim()\n            if (svg.indexOf('</') === 0) {\n                svg = svg.substring(2)\n                if (svg.indexOf('<') > 0) {\n                    svg = svg.substring(svg.indexOf('<'))\n                    stack.pop()\n                } else {\n                    svg = ''\n                }\n            } else {\n                svg = svg.substring(svg.indexOf('<'))\n                const curObj = {\n                    type: svg.substring(1, svg.indexOf(' ')),\n                    children: [],\n                }\n                svg = svg.substring(svg.indexOf(' '))\n                let attr = svg.substring(0, svg.indexOf('>'))\n                let selfclosing = attr.indexOf('/>') >= 0\n\n                svg = svg.substring(svg.indexOf('>') + 1).trim()\n                while (attr.length > 0) {\n                    let key = attr.substring(0, attr.indexOf('=')).trim()\n                    attr = attr.substring(attr.indexOf('\"') + 1)\n                    let value = attr.substring(0, attr.indexOf('\"')).trim()\n                    attr = attr.substring(attr.indexOf('\"') + 1).trim()\n                    curObj[key] = value\n                }\n                if (stack.length === 0) {\n                    obj.push(curObj)\n                } else {\n                    stack[stack.length - 1].children.push(curObj)\n                }\n                if (!selfclosing) {\n                    stack.push(curObj)\n                }\n            }\n        }\n        return obj[0]\n    }\n\n    const svgChildrenToElements = (element, elementIndex) => {\n        switch (element.type) {\n            case 'path':\n                return (\n                    <path key={elementIndex} d={element.d} fill={element.fill}>\n                        {element.children.map((el: Element, index) =>\n                            svgChildrenToElements(el, index)\n                        )}\n                    </path>\n                )\n            case 'g':\n                return (\n                    <g key={elementIndex} fill={element.fill}>\n                        {element.children.map((el: Element, index) =>\n                            svgChildrenToElements(el, index)\n                        )}\n                    </g>\n                )\n            default:\n                return\n        }\n    }\n\n    let result = null\n    if (props.icon) {\n        const objectSvg = svgStringToObj(props.icon)\n\n        result = (\n            <svg\n                data-testid={props.datatestid || 'svg'}\n                height={objectSvg.height}\n                width={objectSvg.width}\n                viewBox={objectSvg.viewBox}\n                className={props.className}\n            >\n                {objectSvg.children.map((element, index) =>\n                    svgChildrenToElements(element, index)\n                )}\n            </svg>\n        )\n    }\n    return result\n}\n\nexport default Svg\n","import * as actions from './index'\nimport * as wsActions from '../../websocketActions'\nimport isEqual from 'lodash/isEqual'\nimport omit from 'lodash/omit'\nimport isObject from 'lodash/isObject'\nimport { current, resourceDraftIndex } from '../../utils/resourceTypeIndex'\n\nimport getBoxType from '../../utils/getBoxType'\nimport { addWSCallback } from '../../components/ReserveWebsite/ReserveWebsite'\n// import type { resourceType } from '../../store/reducer/reducer'\nvar htmlparser = require('htmlparser2')\n\nconst findElementIndex = draft => {\n    if (!draft.currentBox) return -1\n    if (draft.currentBox.length < 1) return -1\n    return draft.structure.findIndex(item => item.id === draft.currentBox)\n}\n\nconst findRouteElements = (draft, mode: 'plugin' | 'template' | 'page') => {\n    const result = []\n    if (mode === 'plugin') {\n        result.push(0)\n    } else if (mode === 'template') {\n        draft.structure.forEach((item, index) => {\n            if (item.path.length === 0 || isEqual(item.path, ['element_01']))\n                result.push(index)\n        })\n    }\n    const trashIndex = draft.structure.findIndex(item => item.id === 'trash')\n    if (trashIndex >= 0) result.push(trashIndex)\n    return result\n}\n\nexport const saveElementsStructure = (type, structure) => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!mD || !type || !resourceDraft || !structure) return\n\n    const newStructure = structure.map(item => {\n        const oldItem = resourceDraft.structure.find(\n            itemInn => itemInn.id === item.id\n        )\n        if (oldItem)\n            return {\n                ...item,\n                ...oldItem,\n                expanded: item.expanded,\n                path: item.path,\n            }\n        else return item\n    })\n    const draft = { ...resourceDraft, structure: newStructure }\n\n    const isNotForHistory = isEqual(\n        resourceDraft.structure.map(item =>\n            omit(item, ['expanded', 'children', 'itemPath'])\n        ),\n        newStructure.map(item =>\n            omit(item, ['expanded', 'children', 'itemPath'])\n        )\n    )\n    dispatch(actions.addResourceVersion(mD, type, draft, {}, isNotForHistory))\n}\n\nexport const saveElementsStructureFromBuilder = (\n    type,\n    draft,\n    globalSettings?: boolean\n) => (dispatch, getState) => {\n    const { mD } = getState()\n    dispatch(\n        actions.addResourceVersion(mD, type, draft, {}, false, globalSettings)\n    )\n}\n\nexport const chooseBox = (type, item: string) => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!mD || !type || !item || !resourceDraft) return\n    const draft = { ...resourceDraft, currentBox: item }\n    dispatch(actions.addResourceVersion(mD, type, draft, {}, true))\n    dispatch(unhoverBox())\n}\n\nexport const changeBoxPropertyInStructure = (\n    type,\n    key: string | {},\n    value: any,\n    isNotForHistory?: boolean,\n    boxId?: string\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!mD || !type || !key || !resourceDraft) return\n    let elementIndex\n    if (boxId) {\n        elementIndex = resourceDraft.structure.findIndex(\n            item => item.id === boxId\n        )\n    } else {\n        elementIndex = findElementIndex(resourceDraft)\n    }\n    if (elementIndex < 0) return\n    if (key === 'tag') {\n        dispatch(\n            deleteFromHoveredSizes(mD[current[type]], [\n                resourceDraft.structure[elementIndex].id,\n            ])\n        )\n    }\n\n    let changes = {}\n    if (isObject(key) && !(typeof key === 'string' || key instanceof String))\n        changes = key\n    else changes[key.toString()] = value\n    const draft = {\n        ...resourceDraft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            {\n                ...resourceDraft.structure[elementIndex],\n                ...changes,\n            },\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n    }\n\n    dispatch(\n        actions.addResourceVersion(\n            mD,\n            type,\n            draft,\n            {\n                throttle: 100,\n            },\n            isNotForHistory\n        )\n    )\n}\n\nexport const changeBoxPropertyInValues = (\n    type,\n    key: string | {},\n    value: any,\n    isNotForHistory?: boolean,\n    boxId?: string\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!mD || !type || !key || !resourceDraft) return\n    let elementIndex\n    if (boxId) {\n        elementIndex = resourceDraft.structure.findIndex(\n            item => item.id === boxId\n        )\n    } else {\n        elementIndex = findElementIndex(resourceDraft)\n    }\n    if (elementIndex < 0) return\n    if (key === 'tag') {\n        dispatch(\n            deleteFromHoveredSizes(mD[current[type]], [\n                resourceDraft.structure[elementIndex].id,\n            ])\n        )\n    }\n\n    let changes = {}\n    if (isObject(key) && !(typeof key === 'string' || key instanceof String))\n        changes = key\n    else changes[key.toString()] = value\n\n    const draft = {\n        ...resourceDraft,\n        values: {\n            ...resourceDraft.values,\n            [resourceDraft.structure[elementIndex].id]: {\n                ...resourceDraft.values[\n                    resourceDraft.structure[elementIndex].id\n                ],\n                ...changes,\n            },\n        },\n    }\n\n    dispatch(\n        actions.addResourceVersion(\n            mD,\n            type,\n            draft,\n            {\n                throttle:\n                    typeof key === 'string' &&\n                    ['currentFileId', 'defaultFileUrl', 'fileUrl'].includes(key)\n                        ? 100\n                        : 1000,\n            },\n            isNotForHistory\n        )\n    )\n}\n\nexport const saveHoveredElementRect = (path: Array<string>, size: Object) => ({\n    type: 'SAVE_HOVERED_ELEMENT_RECT',\n    path,\n    size,\n})\n\nconst deleteFromHoveredSizes = (currentResource, removedElements) => ({\n    type: 'REMOVE_FROM_HOVERED_SIZES',\n    currentResource,\n    removedElements,\n})\n\nexport const hoverBox = (id: string, mode: string, fromFrame?: boolean) => ({\n    type: 'HOVER_ELEMENT',\n    id,\n    mode,\n    fromFrame,\n})\n\nexport const unhoverBox = () => ({\n    type: 'UNHOVER_ELEMENT',\n})\n\nexport const toggleFindMode = (value?: string) => ({\n    type: 'TOGGLE_FIND_MODE',\n    value,\n})\n\nexport const addBox = (\n    mode: 'plugin' | 'template' | 'page',\n    type?: 'children' | 'inside' | 'text' | 'cmsVariable' | 'page'\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[mode]]\n    if (!resourceDraft) return\n    const routeElements = findRouteElements(resourceDraft, mode)\n    let elementIndex = findElementIndex(resourceDraft)\n\n    let putInside\n    if (mode === 'plugin') {\n        if (elementIndex <= 0) {\n            elementIndex = 0\n            putInside = true\n        }\n    } else if (mode === 'template') {\n        if (elementIndex < 0)\n            elementIndex = resourceDraft.structure.findIndex(\n                item => item.id === 'element_1'\n            )\n\n        if (resourceDraft.structure[elementIndex].id === 'element_01')\n            elementIndex = resourceDraft.structure.findIndex(\n                item => item.id === 'element_1'\n            )\n\n        if (\n            resourceDraft.structure[elementIndex].path.length < 2 &&\n            !isEqual(resourceDraft.structure[elementIndex].path, ['element_02'])\n        )\n            putInside = true\n    }\n    const element = resourceDraft.structure[elementIndex]\n    const elementValues = resourceDraft.values[element.id]\n    if (element.isChildren) {\n        putInside = false\n    } else if (element.childrenTo) {\n        putInside = true\n    } else {\n        if (type === 'inside') putInside = true\n    }\n\n    if (type === 'inside' || (type === 'text' && !element.text))\n        putInside = true\n\n    if (type === 'page') {\n        if (\n            elementValues.CMSVariableType &&\n            elementValues.CMSVariableType.indexOf('propagating_') >= 0\n        ) {\n            putInside = true\n        } else if (element.isPropagatingItem) {\n            putInside = false\n        } else {\n            return\n        }\n    }\n    const newId =\n        mode === 'page'\n            ? `elementCMS_${resourceDraft.currentId}`\n            : `element_${resourceDraft.currentId}`\n    const newCurrentId = resourceDraft.currentId + 1\n\n    const isCMSVariable =\n        resourceDraft.structure[elementIndex].id === 'element_02' ||\n        (resourceDraft.structure[elementIndex].path.length > 0 &&\n            resourceDraft.structure[elementIndex].path[0] === 'element_02')\n\n    const draft = {\n        ...resourceDraft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex + 1),\n            {\n                id: newId,\n                path: putInside\n                    ? [\n                          ...resourceDraft.structure[elementIndex].path,\n                          resourceDraft.structure[elementIndex].id,\n                      ]\n                    : [...resourceDraft.structure[elementIndex].path],\n                tag:\n                    mode === 'page'\n                        ? 'Item'\n                        : type === 'text'\n                        ? 'text'\n                        : type === 'children'\n                        ? 'New children'\n                        : isCMSVariable\n                        ? 'New CMS variable'\n                        : 'div',\n                isPropagatingItem: mode === 'page',\n                textMode: 'text',\n                text: type === 'text',\n                isChildren: type === 'children',\n                isCMSVariable: isCMSVariable,\n                isElementFromCMSVariable: type === 'cmsVariable',\n            },\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            [newId]: {\n                textContent: '',\n                properties: {},\n                propertiesString: '',\n                CMSVariableType: 'text',\n                CMSVariableSystemName: 'newCmsVariable',\n                CMSVariableDescription: 'New CMS variable description',\n                CMSVariableDefaultValue: 'New CMS variable default value',\n            },\n        },\n        currentId: newCurrentId,\n        currentBox: newId,\n    }\n\n    dispatch(actions.addResourceVersion(mD, mode, draft))\n}\n\nexport const deleteBox = (\n    type: 'page' | 'plugin' | 'template',\n    withChildren?: string\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const routeElements = findRouteElements(resourceDraft, type)\n    let elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0 || routeElements.includes(elementIndex)) return\n\n    const itemInStructure = resourceDraft.structure[elementIndex]\n    if (!itemInStructure) return\n    const elementId = itemInStructure.id\n\n    if (withChildren === 'page') {\n        if (!itemInStructure.isPropagatingItem) {\n            return\n        }\n    }\n    let draft = {}\n    const removedElements = [elementId]\n    if (itemInStructure.path[0] === 'trash') {\n        if (withChildren) {\n            draft = {\n                ...resourceDraft,\n                structure: resourceDraft.structure.filter(item => {\n                    const notRemove =\n                        (withChildren === 'onlyChildren' ||\n                            elementId !== item.id) &&\n                        !item.path.includes(elementId)\n                    if (!notRemove) removedElements.push(item.id)\n                    return notRemove\n                }),\n            }\n        } else {\n            const newPageStructure = resourceDraft.structure.map(item => ({\n                ...item,\n                path: item.path.filter(pathItem => pathItem !== elementId),\n            }))\n\n            draft = {\n                ...resourceDraft,\n                structure: [\n                    ...newPageStructure.slice(0, elementIndex),\n                    ...newPageStructure.slice(elementIndex + 1),\n                ],\n            }\n        }\n        for (let item of removedElements) {\n            delete draft.values[item.id]\n        }\n    } else {\n        let trashItem = resourceDraft.structure.find(\n            item => item.id === 'trash'\n        )\n\n        if (withChildren) {\n            let structureElementsToLeave = resourceDraft.structure.filter(\n                item => {\n                    const notRemove =\n                        (withChildren === 'onlyChildren' ||\n                            elementId !== item.id) &&\n                        !item.path.includes(elementId)\n                    if (!notRemove) removedElements.push(item.id)\n                    return notRemove\n                }\n            )\n            draft = {\n                ...resourceDraft,\n                structure: [\n                    ...structureElementsToLeave,\n                    ...(!trashItem\n                        ? [\n                              {\n                                  id: 'trash',\n                                  path: [],\n                                  tag: 'Trash',\n                              },\n                          ]\n                        : []),\n                    ...resourceDraft.structure\n                        .filter(item => removedElements.includes(item.id))\n                        .map(item => ({\n                            ...item,\n                            path: [\n                                'trash',\n                                ...(item.id !== elementId\n                                    ? item.path.slice(\n                                          item.path.indexOf(elementId)\n                                      )\n                                    : []),\n                            ],\n                        })),\n                ],\n                values: {\n                    ...resourceDraft.values,\n                    trash: {\n                        properties: {},\n                        style: '',\n                    },\n                },\n            }\n        } else {\n            const newPageStructure = resourceDraft.structure.map(item => ({\n                ...item,\n                path: item.path.filter(pathItem => pathItem !== elementId),\n            }))\n\n            draft = {\n                ...resourceDraft,\n                structure: [\n                    ...newPageStructure.slice(0, elementIndex),\n                    ...newPageStructure.slice(elementIndex + 1),\n                    ...(!trashItem\n                        ? [\n                              {\n                                  id: 'trash',\n                                  path: [],\n                                  tag: 'Trash',\n                              },\n                          ]\n                        : []),\n                    { ...itemInStructure, path: ['trash'] },\n                ],\n                values: {\n                    ...resourceDraft.values,\n                    trash: {\n                        properties: {},\n                        style: '',\n                    },\n                },\n            }\n        }\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n    dispatch(deleteFromHoveredSizes(mD[current[type]], removedElements))\n}\n\nexport const duplicateBox = (\n    type: 'page' | 'plugin' | 'template',\n    withChildren?: boolean\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const routeElements = findRouteElements(resourceDraft, type)\n    let elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0 || routeElements.includes(elementIndex)) return\n\n    const elementId = resourceDraft.structure[elementIndex].id\n    const idPrefix = withChildren === 'page' ? 'elementCMS_' : 'element_'\n    if (withChildren === 'page') {\n        if (!resourceDraft.structure[elementIndex].isPropagatingItem) {\n            return\n        }\n    }\n    const sourceChildren = resourceDraft.structure.filter(item =>\n        item.path.includes(elementId)\n    )\n\n    const newId = idPrefix + resourceDraft.currentId\n    let draft = { currentId: resourceDraft.currentId + 1 }\n\n    if (withChildren) {\n        const idMatch = { [elementId]: newId }\n        const newValuesElements = { [newId]: resourceDraft.values[elementId] }\n        const newChildren = sourceChildren\n            .map(item => {\n                let newItemId = idPrefix + draft.currentId\n                draft.currentId += 1\n                idMatch[item.id] = newItemId\n                newValuesElements[newItemId] = resourceDraft.values[item.id]\n                return {\n                    ...item,\n                    id: newItemId,\n                }\n            })\n            .map(item => {\n                return {\n                    ...item,\n\n                    path: item.path.map(pathItem => {\n                        if (idMatch[pathItem]) {\n                            return idMatch[pathItem]\n                        } else {\n                            return pathItem\n                        }\n                    }),\n                }\n            })\n\n        draft = {\n            ...resourceDraft,\n            ...draft,\n            structure: [\n                ...resourceDraft.structure.slice(\n                    0,\n                    elementIndex + sourceChildren.length\n                ),\n                {\n                    ...resourceDraft.structure[elementIndex],\n                    id: newId,\n                },\n                ...newChildren,\n                ...resourceDraft.structure.slice(\n                    elementIndex + sourceChildren.length\n                ),\n            ],\n            values: {\n                ...resourceDraft.values,\n                ...newValuesElements,\n            },\n        }\n    } else {\n        draft = {\n            ...resourceDraft,\n            ...draft,\n            structure: [\n                ...resourceDraft.structure.slice(\n                    0,\n                    elementIndex + sourceChildren.length\n                ),\n                {\n                    ...resourceDraft.structure[elementIndex],\n                    id: newId,\n                },\n                ...resourceDraft.structure.slice(\n                    elementIndex + sourceChildren.length\n                ),\n            ],\n            values: {\n                ...resourceDraft.values,\n                [newId]: resourceDraft.values[elementId],\n            },\n        }\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n\nexport const splitText = (type, start: number, end: number) => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0) return\n\n    const itemInStructure = resourceDraft.structure[elementIndex]\n    if (!itemInStructure) return\n    const elementId = itemInStructure.id\n\n    const text = resourceDraft.values[elementId].textContent\n    if (!text) return\n\n    let draft = { currentId: resourceDraft.currentId }\n    let newId\n\n    const textContent0 = text.substr(0, start)\n    const textContent1 = text.substr(start, end - start)\n    const textContent2 = text.substr(end)\n\n    const newElements = [\n        {\n            ...resourceDraft.structure[elementIndex],\n        },\n    ]\n\n    const newValues = {\n        [elementId]: {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent0,\n        },\n    }\n\n    if (textContent1.length > 0) {\n        newId = `element_${draft.currentId}`\n        draft.currentId = draft.currentId + 1\n        newElements.push({\n            ...resourceDraft.structure[elementIndex],\n            id: newId,\n        })\n        newValues[newId] = {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent1,\n        }\n    }\n\n    if (textContent2.length > 0 || textContent1.length === 0) {\n        newId = `element_${draft.currentId}`\n        draft.currentId = draft.currentId + 1\n        newElements.push({\n            ...resourceDraft.structure[elementIndex],\n            id: newId,\n        })\n        newValues[newId] = {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent2,\n        }\n    }\n\n    draft = {\n        ...resourceDraft,\n        ...draft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            ...newElements,\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            ...newValues,\n        },\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n\nexport const textToSpan = (type, start: number, end: number) => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0) return\n\n    const itemInStructure = resourceDraft.structure[elementIndex]\n    if (!itemInStructure) return\n    const elementId = itemInStructure.id\n\n    const text = resourceDraft.values[elementId].textContent\n    if (!text) return\n\n    let newId\n    let draft = { currentId: resourceDraft.currentId }\n\n    const textContent0 = text.substr(0, start)\n    const textContent1 = text.substr(start, end - start)\n    const textContent2 = text.substr(end)\n\n    const newElements = [\n        {\n            ...resourceDraft.structure[elementIndex],\n        },\n    ]\n\n    const newValues = {\n        [elementId]: {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent0,\n        },\n    }\n\n    const spanId = `element_${draft.currentId}`\n    draft.currentId = draft.currentId + 1\n    newElements.push({\n        id: spanId,\n        path: [...resourceDraft.structure[elementIndex].path],\n        tag: 'span',\n        text: false,\n    })\n\n    newValues[spanId] = {\n        textContent: '',\n        style: '',\n        properties: {},\n    }\n\n    newId = `element_${draft.currentId}`\n    draft.currentId = draft.currentId + 1\n    newElements.push({\n        ...resourceDraft.structure[elementIndex],\n        path: [...resourceDraft.structure[elementIndex].path, spanId],\n        textContent: textContent1,\n        id: newId,\n    })\n\n    newValues[newId] = {\n        ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n        textContent: textContent1,\n    }\n\n    if (textContent2.length > 0) {\n        newId = `element_${draft.currentId}`\n        draft.currentId = draft.currentId + 1\n        newElements.push({\n            ...resourceDraft.structure[elementIndex],\n            textContent: textContent2,\n            id: newId,\n        })\n        newValues[newId] = {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent2,\n        }\n    }\n\n    draft = {\n        ...resourceDraft,\n        ...draft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            ...newElements,\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            ...newValues,\n        },\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n//Menu\n\nexport const changeMenuItemProperty = (\n    type,\n    key: string,\n    value: string,\n    itemId?: string\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resource = mD[resourceDraftIndex[type]]\n\n    if (!resource) return\n\n    const elementIndex = findElementIndex(resource)\n    if (elementIndex < 0) return\n    const elementId = resource.structure[elementIndex].id\n\n    if (!resource.values[elementId].menuItems) return\n    const newMenuItems = resource.values[elementId].menuItems.map(item => {\n        if (\n            item.id ===\n            (itemId ? itemId : resource.values[elementId].currentMenuItem)\n        ) {\n            return { ...item, [key]: value }\n        } else {\n            return item\n        }\n    })\n    if (!isEqual(newMenuItems, resource.values[elementId].menuItems)) {\n        dispatch(changeBoxPropertyInValues(type, 'menuItems', newMenuItems))\n    }\n}\nexport const markRefreshing = (refreshing: boolean) => ({\n    type: 'MARK_REFRESHING',\n    refreshing,\n})\n\nexport const markShouldRefreshing = (value?: boolean) => ({\n    type: 'MARK_SHOULD_REFRESHING',\n    value,\n})\n\nexport const mergeBoxToPlugin = (\n    type: 'page' | 'plugin' | 'template',\n    onlyChildren?: boolean\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n\n    if (!resourceDraft) return\n    const routeElements = findRouteElements(resourceDraft, type)\n    let elementIndex = findElementIndex(resourceDraft)\n    if (\n        elementIndex <= 0 ||\n        (!onlyChildren && routeElements.includes(elementIndex))\n    )\n        return\n\n    const elementId = resourceDraft.structure[elementIndex].id\n    let currentId = 1\n    const newResourcesIds = ['element_0']\n    const oldResourcesIds = ['element_0']\n    const resourceDataValues = {}\n\n    const resourceDataStructure = resourceDraft.structure\n        .filter(\n            item =>\n                (!onlyChildren && item.id === elementId) ||\n                item.path.includes(elementId)\n        )\n        .map(item => {\n            oldResourcesIds.push(item.id)\n            const newItem = { ...item, id: `element_${currentId}` }\n            resourceDataValues[newItem.id] = {\n                ...resourceDraft.values[item.id],\n            }\n            if (item.id === elementId) {\n                newItem.path = ['element_0']\n            } else {\n                newItem.path = [\n                    'element_0',\n                    ...newItem.path.slice(\n                        newItem.path.indexOf(elementId) + (onlyChildren ? 1 : 0)\n                    ),\n                ]\n            }\n            newResourcesIds.push(newItem.id)\n            currentId++\n            return newItem\n        })\n        .map(item => ({\n            ...item,\n            path: item.path.map(\n                id => newResourcesIds[oldResourcesIds.indexOf(id)]\n            ),\n        }))\n    if (resourceDataStructure.length === 0) return\n    const resourceData = {\n        structure: [\n            {\n                id: 'element_0',\n                path: [],\n                tag: 'Main element',\n                textMode: '',\n            },\n            ...resourceDataStructure,\n        ],\n        values: {\n            ...resourceDataValues,\n            element_0: {\n                properties: {},\n                propertiesString: '',\n                textContent: '',\n            },\n        },\n        currentId,\n    }\n\n    const newPluginName =\n        prompt('Name the new plugin', 'New plugin') || 'New plugin'\n\n    const callbackId = addWSCallback(() => {\n        const draft = {\n            ...resourceDraft,\n            structure: [\n                ...resourceDraft.structure.slice(\n                    0,\n                    elementIndex + (onlyChildren ? 1 : 0)\n                ),\n                {\n                    ...resourceDraft.structure[elementIndex],\n                    path: [\n                        ...resourceDraft.structure[elementIndex].path,\n                        ...(onlyChildren\n                            ? [resourceDraft.structure[elementIndex].id]\n                            : []),\n                    ],\n                    tag: newPluginName,\n                    text: false,\n                    id: oldResourcesIds[1],\n                },\n                ...resourceDraft.structure.slice(\n                    elementIndex +\n                        (onlyChildren ? 1 : 0) +\n                        resourceDataStructure.length\n                ),\n            ],\n            values: {\n                ...resourceDraft.values,\n                [oldResourcesIds[1]]: {\n                    textContent: '',\n                    propertiesString: '',\n                    properties: {},\n                },\n            },\n        }\n        for (let i = 2; i < oldResourcesIds.length; i++) {\n            delete draft.values[oldResourcesIds[i]]\n        }\n        dispatch(\n            actions.addResourceVersion(mD, type, draft, { throttle: 1000 })\n        )\n    })\n    dispatch(\n        wsActions.addResource(\n            'plugin',\n            false,\n            newPluginName,\n            resourceData,\n            callbackId\n        )\n    )\n}\n\nexport const dissolvePluginToBox = type => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    let elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0) return\n\n    // const elementId = resourceDraft.structure[elementIndex].id\n\n    const plugin = mD.pluginsStructure.find(\n        item => item.name === resourceDraft.structure[elementIndex].tag\n    )\n    if (!plugin) return\n    if (!mD.resourcesObjects[plugin.id]) return\n\n    const pluginResource = !mD.resourcesObjects[plugin.id].present.structure\n        ? mD.resourcesObjects[plugin.id].draft\n        : mD.resourcesObjects[plugin.id].present\n\n    let currentId = resourceDraft.currentId\n    const newResourcesIds = []\n    const oldResourcesIds = []\n    const pluginDataValues = {}\n\n    const pluginDataStructure = pluginResource.structure\n        .filter(item => {\n            if (item.path.length === 0) return false\n            if (item.path[0] === 'element_02' || item.path[0] === 'trash')\n                return false\n            return true\n        })\n        .map(item => {\n            oldResourcesIds.push(item.id)\n            const newItem = {\n                ...item,\n                id: `element_${currentId}`,\n                path: [...item.path.slice(1)],\n            }\n            pluginDataValues[newItem.id] = pluginResource.values[item.id]\n\n            newResourcesIds.push(newItem.id)\n            currentId++\n            return newItem\n        })\n        .map(item => ({\n            ...item,\n            path: [\n                ...resourceDraft.structure[elementIndex].path,\n                ...item.path.map(\n                    id => newResourcesIds[oldResourcesIds.indexOf(id)]\n                ),\n            ],\n        }))\n\n    const draft = {\n        ...resourceDraft,\n        currentId,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            ...pluginDataStructure,\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            ...pluginDataValues,\n        },\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n\nexport const setCurrentSiteBuilderMode = (mode: string) => ({\n    type: 'SET_CURRENT_SITEBUILDER_MODE',\n    mode,\n})\n\nexport const parseHTML = (type, value: string) => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0) return\n    let draft = { currentId: resourceDraft.currentId }\n\n    const htmlArray = htmlparser.parseDOM(value)\n    const newElements = []\n    const newElementsValues = {}\n    const parseToWebsiter = (curArray, path) => {\n        curArray.forEach(item => {\n            if (!(item.type === 'text' && item.data.trim() === '')) {\n                if (item.type === 'text' || item.type === 'tag') {\n                    const newId = `element_${draft.currentId}`\n                    draft.currentId = draft.currentId + 1\n                    const properties = item.attribs\n                        ? omit(item.attribs, 'style')\n                        : {}\n                    const newElement = {\n                        id: newId,\n                        path,\n                        tag: item.name || 'div',\n                        text: false,\n                    }\n                    const newElementValues = {\n                        textContent: '',\n                        style: item.attribs ? item.attribs.style || '' : '',\n                        properties,\n                        propertiesString: JSON.stringify(properties),\n                    }\n                    if (item.type === 'text') {\n                        newElement.tag = 'text'\n                        newElement.text = true\n                        newElementValues.textMode = 'text'\n                        newElementValues.textContent = item.data\n                    }\n                    newElements.push(newElement)\n                    newElementsValues[newId] = newElementValues\n                    if (item.children)\n                        parseToWebsiter(item.children, [...path, newId])\n                }\n            }\n        })\n    }\n    parseToWebsiter(htmlArray, resourceDraft.structure[elementIndex].path)\n    draft = {\n        ...resourceDraft,\n        ...draft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            ...newElements,\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            ...newElementsValues,\n        },\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n\nexport const copyBox = (\n    type: 'page' | 'plugin' | 'template',\n    cut: boolean,\n    withChildren?: boolean\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const routeElements = findRouteElements(resourceDraft, type)\n    let elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0 || routeElements.includes(elementIndex)) return\n\n    const elementId = resourceDraft.structure[elementIndex].id\n\n    const itemInStructure = resourceDraft.structure.find(\n        item => item.id === elementId\n    )\n    if (!itemInStructure) return\n    if (type === 'page') {\n        if (!itemInStructure.isPropagatingItem) return\n        withChildren = true\n    }\n    let draft = {}\n    const removedElementsIds = [elementId]\n\n    let trashItem = resourceDraft.structure.find(item => item.id === 'trash')\n    let structureElementsToLeave = []\n\n    const cutPath = oldStructure => {\n        return oldStructure.map((item, index) =>\n            index === 0\n                ? { ...item, path: [] }\n                : {\n                      ...item,\n                      path: item.path.slice(\n                          item.path.indexOf(oldStructure[0].id)\n                      ),\n                  }\n        )\n    }\n    if (withChildren) {\n        const structureElementsToRemain = resourceDraft.structure.filter(\n            item => {\n                const notRemove =\n                    elementId !== item.id && !item.path.includes(elementId)\n                if (!notRemove) {\n                    removedElementsIds.push(item.id)\n                    structureElementsToLeave.push(item)\n                }\n                return notRemove\n            }\n        )\n        let valuesToLeave = {}\n        structureElementsToLeave = cutPath(structureElementsToLeave)\n        structureElementsToLeave.forEach(\n            item => (valuesToLeave[item.id] = resourceDraft.values[item.id])\n        )\n        if (cut && itemInStructure.path[0] !== 'trash') {\n            draft = {\n                ...resourceDraft,\n                structure: [\n                    ...structureElementsToRemain,\n                    ...(!trashItem\n                        ? [\n                              {\n                                  id: 'trash',\n                                  path: [],\n                                  tag: 'Trash',\n                              },\n                          ]\n                        : []),\n                    ...resourceDraft.structure\n                        .filter(item => removedElementsIds.includes(item.id))\n                        .map(item => ({\n                            ...item,\n                            path: [\n                                'trash',\n                                ...(item.id !== elementId\n                                    ? item.path.slice(\n                                          item.path.indexOf(elementId)\n                                      )\n                                    : []),\n                            ],\n                        })),\n                ],\n                values: {\n                    ...resourceDraft.values,\n                    trash: {\n                        properties: {},\n                        style: '',\n                    },\n                },\n            }\n        }\n    } else {\n        structureElementsToLeave = cutPath([itemInStructure])\n\n        if (cut && itemInStructure.path[0] !== 'trash') {\n            const newPageStructure = resourceDraft.structure.map(item => ({\n                ...item,\n                path: item.path.filter(pathItem => pathItem !== elementId),\n            }))\n            draft = {\n                ...resourceDraft,\n                structure: [\n                    ...newPageStructure.slice(0, elementIndex),\n                    ...newPageStructure.slice(elementIndex + 1),\n                    ...(!trashItem\n                        ? [\n                              {\n                                  id: 'trash',\n                                  path: [],\n                                  tag: 'Trash',\n                              },\n                          ]\n                        : []),\n                    { ...itemInStructure, path: ['trash'] },\n                ],\n                values: {\n                    ...resourceDraft.values,\n                    trash: {\n                        properties: {},\n                        style: '',\n                    },\n                },\n            }\n        }\n    }\n    if (cut && itemInStructure.path[0] !== 'trash') {\n        dispatch(actions.addResourceVersion(mD, type, draft))\n        dispatch(deleteFromHoveredSizes(mD[current[type]], removedElementsIds))\n    }\n    let valuesToLeave = {}\n    structureElementsToLeave.forEach(\n        item => (valuesToLeave[item.id] = resourceDraft.values[item.id])\n    )\n\n    dispatch(\n        saveToClipboard({\n            structure: structureElementsToLeave,\n            values: valuesToLeave,\n            type: 'websiterElements',\n        })\n    )\n}\n\nconst saveToClipboard = data => ({\n    type: 'SAVE_TO_CLIPBOARD',\n    data,\n})\n\nconst checkPossibilityToPaste = (\n    fromElement,\n    fromElementValues,\n    toElement,\n    toElementValues,\n    mode\n) => {\n    if (mode === 'page') {\n        if (toElement) {\n            if (toElement.isPropagatingItem) return 'notInside'\n            if (\n                toElement.CMSVariableType &&\n                toElement.CMSVariableType.indexOf('propagating_') >= 0\n            )\n                return 'inside'\n        }\n        return false\n    }\n    const fromType = getBoxType(\n        false,\n        fromElement,\n        fromElementValues,\n        mode,\n        true\n    )\n    const toType = getBoxType(false, toElement, toElementValues, mode)\n\n    if (\n        [\n            'html',\n            'headBody',\n            'trash',\n            'CMSRoute',\n            'children',\n            'childrenTo',\n        ].includes(fromType)\n    )\n        return false\n    if (fromType === 'isCMSVariable') {\n        if (toType === 'CMSRoute') return 'inside'\n        if (toElement.path.length > 0 && toElement.path[0] === 'element_02')\n            return true\n        return false\n    }\n    if (\n        ['element', 'plugin', 'text', 'isElementFromCMSVariable'].includes(\n            fromType\n        )\n    ) {\n        if (['html', 'headbody', 'childrenTo'].includes(toType)) {\n            return 'inside'\n        }\n        if (toType === 'element') return true\n        if (['plugin', 'text', 'isElementFromCMSVariable'].includes(toType))\n            return 'notInside'\n    }\n\n    return false\n}\n\nexport const pasteBox = (type, inside) => (dispatch: Object, getState) => {\n    const state = getState()\n    const { mD } = state\n    if (state.clipboard.type !== 'websiterElements') return\n    if (state.clipboard.structure.length < 1) return\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    let elementIndex = findElementIndex(resourceDraft)\n\n    const pastToElementItem = resourceDraft.structure[elementIndex]\n\n    // const elementId = state.clipboard.structure[0].id\n\n    const sourceChildren = state.clipboard.structure\n    const onlyInside = checkPossibilityToPaste(\n        sourceChildren[0],\n        state.clipboard.values[sourceChildren[0].id],\n        pastToElementItem,\n        resourceDraft.values[pastToElementItem.id],\n        type\n    )\n    if (!onlyInside) return\n\n    let putInside\n    if (type === 'plugin') {\n        if (elementIndex <= 0) {\n            elementIndex = 0\n            putInside = true\n        }\n    } else if (type === 'template') {\n        if (elementIndex < 0)\n            elementIndex = resourceDraft.structure.findIndex(\n                item => item.id === 'element_1'\n            )\n        if (resourceDraft.structure[elementIndex].id === 'element_01')\n            elementIndex = resourceDraft.structure.findIndex(\n                item => item.id === 'element_1'\n            )\n\n        if (\n            resourceDraft.structure[elementIndex].path.length < 2 &&\n            !isEqual(resourceDraft.structure[elementIndex].path, ['element_02'])\n        )\n            putInside = true\n    } else if (type === 'page') {\n        putInside = onlyInside\n    }\n    const element = resourceDraft.structure[elementIndex]\n    if (element.isChildren) {\n        putInside = false\n    } else if (element.childrenTo) {\n        putInside = true\n    } else {\n        if (inside) putInside = true\n    }\n    if (inside || type === 'text' || onlyInside === 'inside') putInside = true\n    if (onlyInside === 'notInside') putInside = false\n\n    let draft = { currentId: resourceDraft.currentId }\n\n    const idMatch = {}\n    const newValuesElements = {}\n    const newChildren = sourceChildren\n        .map(item => {\n            let newItemId = `element${type === 'page' ? 'CMS' : ''}_${\n                draft.currentId\n            }`\n            draft.currentId += 1\n            idMatch[item.id] = newItemId\n            newValuesElements[newItemId] = state.clipboard.values[item.id]\n            return {\n                ...item,\n                id: newItemId,\n            }\n        })\n        .map(item => {\n            return {\n                ...item,\n\n                path: [\n                    ...element.path,\n                    ...(putInside ? [element.id] : []),\n                    ...item.path.map(pathItem => {\n                        if (idMatch[pathItem]) {\n                            return idMatch[pathItem]\n                        } else {\n                            return pathItem\n                        }\n                    }),\n                ],\n            }\n        })\n\n    draft = {\n        ...resourceDraft,\n        ...draft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex + 1),\n\n            ...newChildren,\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            ...newValuesElements,\n        },\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n\n/////////////////////OLDOLDOLDOLDOLD\n// export const changeElementStyleValue = (\n//     index: number,\n//     key: string,\n//     value: any,\n//     elementId: string\n// ) => ({\n//     type: actionTypes.CHANGE_ELEMENT_STYLE_VALUE,\n//     index,\n//     key,\n//     value,\n//     elementId,\n// })\n\n// export const addElementStyleValue = (index: number, elementId: string) => ({\n//     type: actionTypes.ADD_ELEMENT_STYLE_VALUE,\n//     index,\n//     elementId,\n// })\n\n// export const deleteElementStyleValue = (index: number, elementId: string) => ({\n//     type: actionTypes.DELETE_ELEMENT_STYLE_VALUE,\n//     index,\n//     elementId,\n// })\n\n// export const changeElementPropertyValue = (\n//     value: any,\n//     key: string,\n//     isSection?: boolean,\n//     isNotForHistory?: boolean\n// ) => ({\n//     type: actionTypes.CHANGE_ELEMENT_PROPERTY_VALUE,\n//     value,\n//     key,\n//     isSection,\n//     isNotForHistory,\n// })\n\n// export const builderZoomOut = () => ({ type: actionTypes.BUILDER_ZOOM_OUT })\n// export const builderZoomIn = () => ({ type: actionTypes.BUILDER_ZOOM_IN })\n// export const builderZoomReset = () => ({ type: actionTypes.BUILDER_ZOOM_RESET })\n\n// export const saveToHistory = () => ({ type: actionTypes.SAVE_TO_HISTORY })\n\n// export const loadCurrentPageToBuilder = (\n//     _id: ?string,\n//     resourcesObjects?: Object,\n//     pageObject?: Object\n// ) => ({\n//     type: actionTypes.LOAD_CURRENT_PAGE_TO_BUILDER,\n//     _id,\n//     resourcesObjects,\n//     pageObject,\n// })\n","import axios from 'axios'\nimport Cookies from 'universal-cookie'\nimport jwt from 'jsonwebtoken'\n\nimport * as actions from './index'\n\nimport { webSocket } from '../../components/ReserveWebsite/ReserveWebsite'\n\nconst cookies = new Cookies()\n\nexport const authStart = () => ({\n    type: 'AUTH_START',\n})\n\nexport const authSuccess = (data: Object) => ({\n    type: 'AUTH_SUCCESS',\n    data,\n})\n\nexport const authFail = (error: string) => ({\n    type: 'AUTH_FAIL',\n    error,\n})\n\nexport const deleteStart = () => ({\n    type: 'ACTION_START',\n})\n\nexport const deleteSuccess = () => ({\n    type: 'ACTION_SUCCESS',\n})\n\nexport const deleteFail = (error: string) => ({\n    type: 'ACTION_FAIL',\n    error,\n})\n\nexport const deleteUser = () => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (window.confirm('Are you sure you would like to delete your account?'))\n        if (\n            window.confirm(\n                'This action cannot be reverted. All your websites will be deleted.'\n            )\n        )\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'deleteUser',\n                })\n            )\n}\n\nexport const logout = (all?: boolean) => (dispatch: Object) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (!all) {\n        cookies.remove('auth_token')\n        axios.defaults.headers.common['x-auth-token'] = null\n        dispatch(logoutDo())\n    } else {\n        if (webSocket) {\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'logoutAll',\n                })\n            )\n        }\n    }\n}\n\nconst logoutDo = () => ({\n    type: 'AUTH_LOGOUT',\n})\n\nexport const authCheckState = () => (dispatch: Object) => {\n    sessionStorage.setItem('systemRefresh', '0')\n    const tryWebsiter = cookies.get('try_websiter')\n    sessionStorage.removeItem('tryWebsiter')\n    if (tryWebsiter) {\n        cookies.remove('try_websiter', {\n            path: '/',\n        })\n        sessionStorage.setItem('tryWebsiter', '1')\n        dispatch(\n            authSuccess({\n                _id: 'try',\n            })\n        )\n        return\n    }\n    const token = cookies.get('auth_token')\n    const rememberMe = cookies.get('rememberme')\n    if (rememberMe) {\n        cookies.remove('rememberme', {\n            path: '/',\n        })\n        if (rememberMe === 'false') {\n            cookies.remove('auth_token', {\n                path: '/',\n            })\n        }\n    }\n    const userId = jwt.decode(token)\n    axios.defaults.headers.post['Content-Type'] = 'application/json'\n    axios.defaults.headers.put['Content-Type'] = 'application/json'\n    axios.defaults.headers.delete['Content-Type'] = 'application/json'\n    axios.defaults.headers.common.Accept = 'application/json'\n\n    if (!token || !userId) {\n        dispatch(logout())\n    } else {\n        axios.defaults.headers.common['x-auth-token'] = token\n        axios.defaults.headers.post['x-auth-token'] = token\n        axios.defaults.headers.get['x-auth-token'] = token\n        axios.defaults.headers.delete['x-auth-token'] = token\n        axios.defaults.headers.put['x-auth-token'] = token\n        dispatch(authStart())\n        return axios\n            .get('/api/users')\n            .then(() => {\n                sessionStorage.removeItem('tryWebsiter')\n                dispatch(\n                    authSuccess({\n                        _id: userId._id,\n                    })\n                )\n            })\n            .catch(err => {\n                cookies.remove('auth_token', {\n                    path: '/',\n                })\n                dispatch(authFail(err.message))\n            })\n    }\n}\n\nexport const changeBarSizeDo = (key: string, value: number) => ({\n    type: 'CHANGE_BAR_SIZE',\n    key,\n    value,\n})\n\nexport const savePropertiesOnLeave = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter')) return\n    const { mD, barSizes } = getState()\n    webSocket.send(\n        JSON.stringify({\n            messageCode: 'saveSettings',\n            settings: {\n                ...mD.userObject.settings,\n                barSizes,\n            },\n        })\n    )\n}\n\nexport const changeBarSize = (initiator?: { key: string; value: number }) => (\n    dispatch: Object,\n    getState\n) => {\n    const { barSizes } = getState()\n    const width = Math.max(window.innerWidth, 700),\n        height = window.innerHeight\n    let value, dif, dif2, value2, value3\n\n    if (!initiator) {\n        if (barSizes.height > height - 50) {\n            dispatch(actions.changeBarSizeDo('height', height - 50))\n        }\n        if (barSizes.width > width - 100) {\n            dispatch(actions.changeBarSizeDo('width', width - 100))\n        }\n        if (barSizes.width + barSizes.width2 > width - 50) {\n            dispatch(\n                actions.changeBarSizeDo('width2', width - barSizes.width - 50)\n            )\n        }\n    } else {\n        switch (initiator.key) {\n            case 'height':\n                value = initiator.value\n                if (value < 50) value = 50\n                if (value > height - 50) value = height - 50\n                dispatch(actions.changeBarSizeDo('height', value))\n                break\n            case 'width':\n                value = initiator.value\n                if (value < 50) value = 50\n                dif = value - barSizes.width\n                value2 = barSizes.width2 - dif\n                value3 = barSizes.width3\n                if (value2 < 50) {\n                    dif2 = value2 - 50\n                    value2 = 50\n                    value3 = barSizes.width3 + dif2\n                    if (value3 < 50) value3 = 50\n                }\n                if (value + value2 + value3 + 50 > width) {\n                    value = width - 150\n                    value2 = 50\n                    value3 = 50\n                }\n                dispatch(actions.changeBarSizeDo('width', value))\n                dispatch(actions.changeBarSizeDo('width2', value2))\n                dispatch(actions.changeBarSizeDo('width3', value3))\n                break\n            case 'width2':\n                value2 = initiator.value\n                value = barSizes.width\n                dif = value2 - 50\n                if (dif < 0) {\n                    value = value + dif\n                    if (value < 50) value = 50\n                    dif2 = value - barSizes.width\n                    value3 = barSizes.width3 - dif2\n                    value2 = 50\n                }\n                dif = value + value2 - barSizes.width - barSizes.width2\n                value3 = barSizes.width3 - dif\n                if (value3 < 50) value3 = 50\n                if (value + value2 + value3 + 50 > width) {\n                    value2 = width - value - 100\n                }\n                dispatch(actions.changeBarSizeDo('width', value))\n                dispatch(actions.changeBarSizeDo('width2', value2))\n                dispatch(actions.changeBarSizeDo('width3', value3))\n                break\n            case 'width3':\n                value3 = initiator.value\n                value = barSizes.width\n                value2 = barSizes.width2\n                dif = value3 - 50\n                if (dif < 0) {\n                    value2 = value2 + dif\n                    dif2 = value2 - 50\n                    if (dif2 < 0) {\n                        value = value + dif2\n                        if (value < 50) value = 50\n                        value2 = 50\n                    }\n                    value3 = 50\n                }\n                if (value + value2 + value3 + 50 > width) {\n                    value3 = width - value - value2 - 50\n                }\n                dispatch(actions.changeBarSizeDo('width', value))\n                dispatch(actions.changeBarSizeDo('width2', value2))\n                dispatch(actions.changeBarSizeDo('width3', value3))\n                break\n            default:\n                break\n        }\n    }\n}\n\nexport const setActiveTab = activeKey => ({\n    type: 'SET_ACTIVE_TAB',\n    activeKey,\n})\n","import cloneDeep from 'lodash/cloneDeep'\n\nexport const chooseWebsite = id => (dispatch, getState) => {\n    const { mD } = getState()\n    const userObject = cloneDeep(mD.userObject)\n    userObject.settings.currentWebsite = id\n    dispatch(saveObject(userObject))\n}\n\nexport const saveObject = data => ({\n    type: 'SAVE_OBJECT',\n    data,\n})\n\nexport const chooseUserInWebsiteSharing = (id: string) => ({\n    type: 'CHOOSE_USER_IN_WEBSITE_SHARING',\n    id,\n})\n\nexport const setSizeIsChanging = (isChanging: boolean) => ({\n    type: 'SIZE_IS_CHANGING',\n    isChanging,\n})\n\n// export const setCurrentTopTab = (currentTopTab: string) => ({\n//     type: 'SET_CURRENT_TOP_TAB',\n//     currentTopTab,\n// })\n\nexport const saveMainData = mD => ({\n    type: 'SAVE_MAIN_DATA',\n    mD,\n})\n","import * as actions from '.'\nimport * as wsActions from '../../websocketActions'\nimport { current } from '../../utils/resourceTypeIndex'\nimport cloneDeep from 'lodash/cloneDeep'\n\nexport const chooseResource = (\n    id: string,\n    resourceType: 'plugin' | 'page' | 'template'\n) => (dispatch, getState) => {\n    const { mD } = getState()\n    const userObject = cloneDeep(mD.userObject)\n    if (!userObject.settings.websites[userObject.settings.currentWebsite])\n        userObject.settings.websites[userObject.settings.currentWebsite] = {}\n\n    if (mD.globalSettingsPageId !== id && resourceType === 'page') {\n        userObject.settings.websites[\n            userObject.settings.currentWebsite\n        ].currentPageFSBId = id\n    }\n\n    userObject.settings.websites[userObject.settings.currentWebsite][\n        current[resourceType]\n    ] = id\n\n    dispatch(actions.saveObject(userObject))\n}\n\nexport const addResourceVersion = (\n    mD,\n    resourceType,\n    draft,\n    meta,\n    isNotForHistory?: boolean,\n    globalSettings\n) => ({\n    type: 'ADD_RESOURCE_VERSION',\n    mD,\n    resourceType,\n    draft,\n    meta,\n    isNotForHistory,\n    globalSettings,\n})\n\n// export const undoResourceVersion = () => ({\n//     type: 'UNDO_RESOURCE_VERSION',\n// })\n\n// export const redoResourceVersion = () => ({\n//     type: 'REDO_RESOURCE_VERSION',\n// })\n\nexport const setActiveContainer = container => ({\n    type: 'SET_ACTIVE_CONTAINER',\n    container,\n})\n\nexport const unsetActiveContainer = container => ({\n    type: 'UNSET_ACTIVE_CONTAINER',\n    container,\n})\n\nexport const removeResourceFromUnsaved = data => ({\n    type: 'REMOVE_RESOURCE_FROM_UNSAVED',\n    _id: data._id,\n})\n\nexport const removeResourceFromNewVersions = data => ({\n    type: 'REMOVE_RESOURCE_FROM_NEW_VERSIONS',\n    _id: data._id,\n})\n\nexport const setActivePinnedElement = pinnedElement => ({\n    type: 'SET_ACTIVE_PINNED_ELEMENT',\n    pinnedElement,\n})\n\nexport const removePinnedElement = pinnedElement => ({\n    type: 'REMOVE_PINNED_ELEMENT',\n    pinnedElement,\n})\n\nexport const addPinnedElement = (resourceType, resource, element) => ({\n    type: 'ADD_PINNED_ELEMENT',\n    resourceType,\n    resource,\n    element,\n})\n\nexport const pinPinnedElement = pinnedElement => ({\n    type: 'PIN_PINNED_ELEMENT',\n    pinnedElement,\n})\n","import cloneDeep from 'lodash/cloneDeep'\nimport omit from 'lodash/omit'\nimport isEmpty from 'lodash/isEmpty'\n\nconst diffpatcher = require('jsondiffpatch/dist/jsondiffpatch.umd.js').create({\n    objectHash: obj => obj.id,\n    propertyFilter: (name, context) => name !== '__patch__',\n})\n\nexport const addResource = (data: Object) => (dispatch, getState) => {\n    dispatch(addResourceDo(data))\n}\n\nexport const addResourceDo = (data: Object) => ({\n    type: 'ADD_RESOURCE',\n    data,\n})\n\nexport const deleteResource = (data: Object) => ({\n    type: 'DELETE_RESOURCE',\n    data,\n})\n\nexport const revertResource = (data: Object) => ({\n    type: 'REVERT_RESOURCE',\n    data,\n})\n\nexport const updateUser = (data: Object, webSocket) => (dispatch, getState) => {\n    if (data) {\n        const { mD } = getState()\n        const currentUser = omit(\n            cloneDeep(mD.resourcesObjects[data.resourceId]),\n            ['settings']\n        )\n        if (currentUser) {\n            if (currentUser.__v === data.resource.__v - 1) {\n                currentUser.websites = diffpatcher.patch(\n                    currentUser.websites,\n                    data.resource.__patch__\n                )\n                currentUser.__v = data.resource.__v\n                dispatch(addResource(currentUser, mD))\n                return\n            }\n        }\n        requestResource(data.resource._id, data.type, webSocket)\n    }\n}\n\nexport const updateWebsite = (data: Object, webSocket) => (\n    dispatch,\n    getState\n) => {\n    if (data) {\n        const { mD } = getState()\n        const currentWebsite = cloneDeep(mD.resourcesObjects[data.resourceId])\n        if (currentWebsite) {\n            if (currentWebsite.__v === data.resource.__v - 1) {\n                const newWebsite = diffpatcher.patch(\n                    currentWebsite,\n                    data.resource.__patch__\n                )\n                newWebsite.__v = data.resource.__v\n                dispatch(addResource(newWebsite, mD))\n                return\n            }\n        }\n        requestResource(data.resource._id, data.type, webSocket)\n    }\n}\n\nexport const updateResource = (data: Object, webSocket) => (\n    dispatch,\n    getState\n) => {\n    if (data) {\n        const { mD } = getState()\n        const currentResource = cloneDeep(mD.resourcesObjects[data.resourceId])\n        if (currentResource) {\n            if (currentResource.__v === data.resource.__v - 1) {\n                if (!isEmpty(data.resource.__patch__)) {\n                    currentResource.draft = diffpatcher.patch(\n                        currentResource.draft,\n                        data.resource.__patch__\n                    )\n                }\n                currentResource.__v = data.resource.__v\n                dispatch(addResource(currentResource, mD))\n                return\n            }\n        }\n        requestResource(data.resource._id, data.type, webSocket)\n    }\n}\n\nconst requestResource = (id, type, webSocket) => {\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'requestResource',\n                id,\n                type,\n            })\n        )\n    }\n}\n","export {\n    chooseBox,\n    addBox,\n    deleteBox,\n    duplicateBox,\n    saveElementsStructure,\n    saveElementsStructureFromBuilder,\n    changeBoxPropertyInStructure,\n    changeBoxPropertyInValues,\n    hoverBox,\n    unhoverBox,\n    saveHoveredElementRect,\n    splitText,\n    textToSpan,\n    changeMenuItemProperty,\n    markRefreshing,\n    mergeBoxToPlugin,\n    dissolvePluginToBox,\n    toggleFindMode,\n    markShouldRefreshing,\n    setCurrentSiteBuilderMode,\n    parseHTML,\n    copyBox,\n    pasteBox,\n} from './builder'\n\nexport {\n    logout,\n    authCheckState,\n    deleteUser,\n    changeBarSize,\n    changeBarSizeDo,\n    savePropertiesOnLeave,\n    setActiveTab,\n} from './auth'\n\nexport {\n    setSizeIsChanging,\n    chooseWebsite,\n    // setCurrentTopTab,\n    chooseUserInWebsiteSharing,\n    saveObject,\n    saveMainData,\n} from './website'\n\nexport { uploadFile, deleteFile } from './files'\n\nexport {\n    chooseResource,\n    addResourceVersion,\n    // undoResourceVersion,\n    // redoResourceVersion,\n    removeResourceFromUnsaved,\n    removeResourceFromNewVersions,\n    setActiveContainer,\n    unsetActiveContainer,\n    setActivePinnedElement,\n    removePinnedElement,\n    addPinnedElement,\n    pinPinnedElement,\n} from './resources'\n\nexport {\n    addResource,\n    updateUser,\n    updateWebsite,\n    updateResource,\n    deleteResource,\n    revertResource,\n} from './webSocket'\n\nexport { getCourses } from './courses'\n","import { mDType } from '../Types/mD'\nimport { storeType } from '../Types/store'\nimport { userType } from '../Types/user'\nimport { websiteType } from '../Types/website'\nimport { resourceObjectType } from '../Types/resourceObject'\nimport { getCurrentResourceValue } from './basic'\n\nexport default (state: storeType): mDType => {\n    let userObject: userType | null = null,\n        websites,\n        currentWebsiteItem,\n        currentWebsiteId,\n        currentWebsiteObject,\n        pagesStructure,\n        templatesStructure,\n        pluginsStructure,\n        filesStructure,\n        currentPageId = '',\n        currentPageFSBId = '',\n        currentTemplateId = '',\n        currentPluginId = '',\n        currentFileId = '',\n        currentPageItem,\n        currentPageFSBItem,\n        currentTemplateItem,\n        currentPluginItem,\n        currentFileItem,\n        currentPageObject,\n        currentPageFSBObject,\n        currentTemplateObject,\n        currentPluginObject,\n        currentPageDraft,\n        currentPageFSBDraft,\n        currentTemplateDraft,\n        currentPluginDraft,\n        globalSettingsPageId,\n        globalSettingsPageObject,\n        globalSettingsPageDraft,\n        globalSettingsTemplateId,\n        globalSettingsTemplateDraft,\n        pageTemplateName = '',\n        pageTemplateId = '',\n        pageTemplateItem,\n        pageTemplateObject,\n        pageTemplateDraft,\n        pageTemplateFSBName = '',\n        pageTemplateFSBId = '',\n        pageTemplateFSBItem,\n        pageTemplateFSBObject,\n        pageTemplateFSBDraft,\n        nextFileId = 0,\n        prod,\n        pinnedElementsWithTitles,\n        courses,\n        userCourses\n    const { resourcesObjects, userId, tryWebsiter, pinnedElements } = state\n    courses = state.courses\n\n    if (userId) {\n        userObject = state.resourcesObjects[userId] as userType\n\n        if (userObject) {\n            userCourses = userObject.courses\n            websites = userObject.websites\n            if (websites) {\n                if (websites.length > 0 && userObject.settings) {\n                    if (userObject.settings.currentWebsite) {\n                        currentWebsiteItem = websites.find(item => {\n                            if (userObject)\n                                return (\n                                    item.id ===\n                                    userObject.settings.currentWebsite\n                                )\n                        })\n                    }\n                    if (currentWebsiteItem) {\n                        currentWebsiteId = currentWebsiteItem.id\n                        currentWebsiteObject = resourcesObjects[\n                            currentWebsiteId\n                        ] as websiteType\n                        if (currentWebsiteObject) {\n                            pagesStructure = currentWebsiteObject.pagesStructure\n                            templatesStructure =\n                                currentWebsiteObject.templatesStructure\n                            pluginsStructure =\n                                currentWebsiteObject.pluginsStructure\n                            filesStructure = currentWebsiteObject.filesStructure\n                            nextFileId = currentWebsiteObject.nextFileId || 0\n\n                            const currentWebsiteItemSettings =\n                                userObject.settings.websites[currentWebsiteId]\n                            if (currentWebsiteItemSettings) {\n                                currentPageId =\n                                    currentWebsiteItemSettings.currentPageId\n                                currentPageFSBId =\n                                    currentWebsiteItemSettings.currentPageFSBId\n                                currentTemplateId =\n                                    currentWebsiteItemSettings.currentTemplateId\n                                currentPluginId =\n                                    currentWebsiteItemSettings.currentPluginId\n                                currentFileId =\n                                    currentWebsiteItemSettings.currentFileId\n\n                                currentPageItem = pagesStructure.find(\n                                    item => item.id === currentPageId\n                                )\n                                currentPageFSBItem = pagesStructure.find(\n                                    item => item.id === currentPageFSBId\n                                )\n                                currentTemplateItem = templatesStructure.find(\n                                    item => item.id === currentTemplateId\n                                )\n                                currentPluginItem = pluginsStructure.find(\n                                    item => item.id === currentPluginId\n                                )\n                                currentFileItem = filesStructure.find(\n                                    item => item.id === currentFileId\n                                )\n\n                                if (currentPageItem) {\n                                    currentPageObject = resourcesObjects[\n                                        currentPageId\n                                    ] as resourceObjectType\n                                    if (currentPageObject) {\n                                        currentPageDraft = !currentPageObject\n                                            .present.structure\n                                            ? currentPageObject.draft\n                                            : currentPageObject.present\n                                    }\n                                    pageTemplateName =\n                                        currentPageItem.template || ''\n                                    if (pageTemplateName) {\n                                        pageTemplateItem = templatesStructure.find(\n                                            item =>\n                                                item.name === pageTemplateName\n                                        )\n                                        if (pageTemplateItem) {\n                                            pageTemplateId = pageTemplateItem.id\n                                            pageTemplateObject = resourcesObjects[\n                                                pageTemplateId\n                                            ] as resourceObjectType\n                                            if (pageTemplateObject) {\n                                                pageTemplateDraft = !pageTemplateObject\n                                                    .present.structure\n                                                    ? pageTemplateObject.draft\n                                                    : pageTemplateObject.present\n                                            }\n                                        }\n                                    }\n                                }\n                                if (currentPageFSBItem) {\n                                    currentPageFSBObject = resourcesObjects[\n                                        currentPageFSBId\n                                    ] as resourceObjectType\n                                    if (currentPageFSBObject) {\n                                        currentPageFSBDraft = !currentPageFSBObject\n                                            .present.structure\n                                            ? currentPageFSBObject.draft\n                                            : currentPageFSBObject.present\n                                    }\n                                    pageTemplateFSBName =\n                                        currentPageFSBItem.template || ''\n                                    if (pageTemplateFSBName) {\n                                        pageTemplateFSBItem = templatesStructure.find(\n                                            item =>\n                                                item.name ===\n                                                    pageTemplateFSBName &&\n                                                !item.hidden\n                                        )\n                                        if (pageTemplateFSBItem) {\n                                            pageTemplateFSBId =\n                                                pageTemplateFSBItem.id\n                                            pageTemplateFSBObject = resourcesObjects[\n                                                pageTemplateFSBId\n                                            ] as resourceObjectType\n                                            if (pageTemplateFSBObject) {\n                                                pageTemplateFSBDraft = !pageTemplateFSBObject\n                                                    .present.structure\n                                                    ? pageTemplateFSBObject.draft\n                                                    : pageTemplateFSBObject.present\n                                            }\n                                        }\n                                    }\n                                }\n\n                                if (currentTemplateItem) {\n                                    currentTemplateObject = resourcesObjects[\n                                        currentTemplateId\n                                    ] as resourceObjectType\n                                    if (currentTemplateObject) {\n                                        currentTemplateDraft = !currentTemplateObject\n                                            .present.structure\n                                            ? currentTemplateObject.draft\n                                            : currentTemplateObject.present\n                                    }\n                                }\n                                if (currentPluginItem) {\n                                    currentPluginObject = resourcesObjects[\n                                        currentPluginId\n                                    ] as resourceObjectType\n                                    if (currentPluginObject) {\n                                        currentPluginDraft = !currentPluginObject\n                                            .present.structure\n                                            ? currentPluginObject.draft\n                                            : currentPluginObject.present\n                                    }\n                                }\n\n                                const globalSettingsPageItem = pagesStructure.find(\n                                    item => item.generalSettings\n                                )\n                                if (globalSettingsPageItem) {\n                                    globalSettingsPageId =\n                                        globalSettingsPageItem.id\n                                    globalSettingsPageObject = resourcesObjects[\n                                        globalSettingsPageId\n                                    ] as resourceObjectType\n                                    if (globalSettingsPageObject) {\n                                        globalSettingsPageDraft = !globalSettingsPageObject\n                                            .present.structure\n                                            ? globalSettingsPageObject.draft\n                                            : globalSettingsPageObject.present\n                                    }\n                                }\n\n                                const globalSettingsTemplateItem = templatesStructure.find(\n                                    item => item.generalSettings\n                                )\n                                if (globalSettingsTemplateItem) {\n                                    globalSettingsTemplateId =\n                                        globalSettingsTemplateItem.id\n                                    const globalSettingsTemplateObject = resourcesObjects[\n                                        globalSettingsTemplateId\n                                    ] as resourceObjectType\n                                    if (globalSettingsTemplateObject) {\n                                        globalSettingsTemplateDraft = !globalSettingsTemplateObject\n                                            .present.structure\n                                            ? globalSettingsTemplateObject.draft\n                                            : globalSettingsTemplateObject.present\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n    prod = process.env.NODE_ENV !== 'development'\n\n    pinnedElementsWithTitles = pinnedElements\n        .map(item => {\n            const resourceDraft =\n                item.resource &&\n                getCurrentResourceValue(item.resource, resourcesObjects)\n            if (resourceDraft) {\n                const elementItem = resourceDraft.structure.find(\n                    element => element.id === item.element\n                )\n                if (elementItem) {\n                    return { ...item, title: elementItem.tag }\n                }\n            }\n            return null\n        })\n        .filter(item => item !== null)\n\n    return {\n        userObject: userObject || null,\n        websites,\n        currentWebsiteItem,\n        currentWebsiteId,\n        currentWebsiteObject,\n        pagesStructure: pagesStructure || [],\n        templatesStructure: templatesStructure || [],\n        pluginsStructure: pluginsStructure || [],\n        filesStructure: filesStructure || [],\n        currentPageId,\n        currentPageFSBId,\n        currentTemplateId,\n        currentPluginId,\n        currentFileId,\n        currentPageItem,\n        currentPageFSBItem,\n        currentTemplateItem,\n        currentPluginItem,\n        currentFileItem,\n        currentPageObject,\n        currentPageFSBObject,\n        currentTemplateObject,\n        currentPluginObject,\n        currentPageDraft,\n        currentPageFSBDraft,\n        currentTemplateDraft,\n        currentPluginDraft,\n        globalSettingsPageId,\n        globalSettingsPageObject,\n        globalSettingsPageDraft,\n        globalSettingsTemplateId,\n        globalSettingsTemplateDraft,\n        pageTemplateName,\n        pageTemplateId,\n        pageTemplateItem,\n        pageTemplateObject,\n        pageTemplateDraft,\n        pageTemplateFSBName,\n        pageTemplateFSBId,\n        pageTemplateFSBItem,\n        pageTemplateFSBObject,\n        pageTemplateFSBDraft,\n        resourcesObjects,\n        userId,\n        tryWebsiter,\n        nextFileId,\n        prod,\n        pinnedElementsWithTitles,\n        courses,\n        userCourses,\n    }\n}\n","import axios from 'axios'\nimport { webSocket } from '../../components/ReserveWebsite/ReserveWebsite'\nimport * as wsActions from '../../websocketActions'\nimport buildRelUrls from '../../utils/buildRelUrls'\nimport FileType from 'file-type'\n\nconst actionStartImageUpload = () => ({\n    type: 'ACTION_START_IMAGE_UPLOAD',\n})\n\nconst actionSuccessImageUpload = () => ({\n    type: 'ACTION_SUCCESS_IMAGE_UPLOAD',\n})\n\nconst actionFailImageUpload = (error: string) => ({\n    type: 'ACTION_FAIL_IMAGE_UPLOAD',\n    error,\n})\n\nconst getSignedRequest = (files, replace, editorMode) => (\n    dispatch: Object,\n    getState\n) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    // const { file, thumbnail } = files\n    const file = files.file\n    const thumbnail = files.thumbnail\n    const resolution = files.resolution || {\n        width: 'unknown',\n        height: 'unknown',\n    }\n\n    const { mD } = getState()\n    if (!mD.currentWebsiteId) return\n    const cleanName = file.name.replace(/([^a-zA-Z0-9\\\\.\\\\-])/g, '_')\n    let name = mD.currentWebsiteId + '/' + cleanName\n\n    let namePrefix = ''\n    let k = 0\n\n    const checkName = () =>\n        mD.filesStructure.findIndex(\n            file => name + namePrefix === file.serverName\n        )\n    if (!replace) {\n        while (checkName() >= 0) {\n            k++\n            namePrefix = '_' + k\n        }\n    }\n\n    const fileDetails = {\n        size: file.size,\n        name: replace ? replace.name : cleanName,\n        serverName: replace ? replace.serverName : name + namePrefix,\n        type: replace ? replace.type : files.type,\n        editorMode,\n        file,\n        v: replace ? replace.v + 1 : 1,\n        resolution,\n    }\n\n    const thumbnailDetails = thumbnail\n        ? {\n              size: thumbnail.size,\n              name: fileDetails.name + thumbnail.name,\n              serverName: fileDetails.serverName + thumbnail.name,\n              type: thumbnail.type,\n              editorMode,\n              file: thumbnail,\n          }\n        : {}\n    return axios\n        .post('/api/sign-s3', {\n            ...{\n                fileName: fileDetails.serverName,\n                fileType: fileDetails.type,\n                fileSize: fileDetails.size,\n                websiteId: mD.currentWebsiteId,\n            },\n            ...(thumbnail\n                ? {\n                      thumbnailName: thumbnailDetails.serverName,\n                      thumbnailType: thumbnailDetails.type,\n                      thumbnailSize: thumbnailDetails.size,\n                  }\n                : {}),\n        })\n        .then(response => {\n            dispatch(\n                doUploadFile(\n                    fileDetails,\n                    thumbnailDetails,\n                    response.data,\n                    mD.currentWebsiteId,\n                    replace\n                )\n            )\n        })\n        .catch(err => {\n            dispatch(actionFailImageUpload(err.message))\n            if (err.response.status === 400) alert(err.response.data)\n        })\n}\n\nconst doUploadFile = (\n    fileDetails,\n    thumbnailDetails,\n    data,\n    websiteId,\n    replace\n) => (dispatch: Object, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (data.signedRequestThumbnail && thumbnailDetails.file)\n        axios\n            .put(data.signedRequestThumbnail, thumbnailDetails.file, {\n                headers: {\n                    'Content-Type': 'multipart/form-data',\n                },\n            })\n            .then(response => {})\n            .catch(err => {\n                dispatch(actionFailImageUpload(err.message))\n                return\n            })\n    return axios\n        .put(data.signedRequest, fileDetails.file, {\n            headers: {\n                'Content-Type': 'multipart/form-data',\n            },\n        })\n        .then(response => {\n            if (webSocket) {\n                const { mD } = getState()\n                let result\n                const newFileItem = {\n                    id: replace ? replace.id : 'file_' + mD.nextFileId,\n                    path: replace ? replace.path : [],\n                    size: fileDetails.size + (thumbnailDetails.size || 0),\n                    name: fileDetails.name,\n                    serverName: fileDetails.serverName,\n                    type: fileDetails.type,\n                    editorMode: fileDetails.editorMode,\n                    url: data.url,\n                    v: fileDetails.v,\n                    resolution: fileDetails.resolution,\n                    modifiedDate: Date.now(),\n                }\n\n                if (mD.currentFileItem && mD.currentFileId) {\n                    if (!replace)\n                        result = [\n                            ...mD.filesStructure.slice(\n                                0,\n                                mD.filesStructure.findIndex(\n                                    item => item.id === mD.currentFileId\n                                ) + 1\n                            ),\n                            {\n                                ...newFileItem,\n                                path: mD.currentFileItem.path,\n                                createdDate: Date.now(),\n                            },\n                            ...mD.filesStructure.slice(\n                                mD.filesStructure.findIndex(\n                                    item => item.id === mD.currentFileId\n                                ) + 1\n                            ),\n                        ]\n                    else\n                        result = [\n                            ...mD.filesStructure.slice(\n                                0,\n                                mD.filesStructure.findIndex(\n                                    item => item.id === replace.id\n                                )\n                            ),\n                            {\n                                ...newFileItem,\n                                createdDate: replace.createdDate,\n                            },\n                            ...mD.filesStructure.slice(\n                                mD.filesStructure.findIndex(\n                                    item => item.id === replace.id\n                                ) + 1\n                            ),\n                        ]\n                } else {\n                    result = [\n                        ...mD.filesStructure,\n                        {\n                            ...newFileItem,\n                            createdDate: replace\n                                ? replace.createdDate\n                                : Date.now(),\n                        },\n                    ]\n                }\n\n                result = buildRelUrls(result)\n                dispatch(\n                    wsActions.sendUpdate(\n                        'website',\n                        {\n                            nextFileId: replace\n                                ? mD.nextFileId\n                                : mD.nextFileId + 1,\n                            filesStructure: result,\n                            storage: data.newStorage,\n                        },\n                        websiteId\n                    )\n                )\n            }\n            dispatch(actionSuccessImageUpload())\n        })\n        .catch(err => {\n            dispatch(actionFailImageUpload(err.message))\n        })\n}\n\nexport const uploadFile = (\n    files: Array<{ type: string; size: number; name: string }>,\n    replace: boolean,\n    editorMode: string,\n    isCreated?: boolean,\n    fileType?: string\n) => (dispatch: Object) => {\n    const file = files[0]\n\n    if (file == null) {\n        return alert('No file selected.')\n    }\n    dispatch(actionStartImageUpload())\n    const reader = new FileReader()\n    reader.onload = async event => {\n        let type = await FileType.fromBuffer(event.target.result)\n        type = type ? type.mime : isCreated ? 'text/css' : fileType || ''\n\n        if (type && type.indexOf('image') >= 0) {\n            resizeImageToSpecificSize(\n                file,\n                { width: 220, height: 220 },\n                data => {\n                    urltoFile(data, '/120').then(function(thumbnail) {\n                        getResolution(file, resolution => {\n                            dispatch(\n                                getSignedRequest(\n                                    { file, type, thumbnail, resolution },\n                                    replace,\n                                    editorMode\n                                )\n                            )\n                        })\n                    })\n                }\n            )\n        } else {\n            dispatch(getSignedRequest({ file, type }, replace, editorMode))\n        }\n    }\n\n    reader.readAsArrayBuffer(file)\n}\n\nexport const urltoFile = (url, filename, mimeType) => {\n    mimeType = mimeType || (url.match(/^data:([^;]+);/) || '')[1]\n    return fetch(url)\n        .then(function(res) {\n            return res.arrayBuffer()\n        })\n        .then(function(buf) {\n            return new File([buf], filename, { type: mimeType })\n        })\n}\n\nexport const resizeImageToSpecificSize = (file, size, cb) => {\n    if (file) {\n        var reader = new FileReader()\n        reader.onload = function(event) {\n            resizeImageFromSrcToSpecificSize(event.target.result, size, cb)\n        }\n        reader.readAsDataURL(file)\n    }\n}\n\nexport const resizeImageFromSrcToSpecificSize = (src, size, cb) => {\n    var data\n    var img = new Image()\n    img.onload = function() {\n        const widthCoef = img.width / size.width\n        const heightCoef = img.height / size.height\n        var oc = document.createElement('canvas'),\n            octx = oc.getContext('2d')\n        oc.width = img.width\n        oc.height = img.height\n        octx.drawImage(img, 0, 0)\n        if (widthCoef > 1 || heightCoef > 1) {\n            if (img.width > img.height) {\n                oc.height = (img.height / img.width) * size.width\n                oc.width = size.width\n            } else {\n                oc.width = (img.width / img.height) * size.width\n                oc.height = size.width\n            }\n        }\n        octx.drawImage(oc, 0, 0, oc.width, oc.height)\n        octx.drawImage(img, 0, 0, oc.width, oc.height)\n        data = oc.toDataURL()\n        cb(data)\n    }\n    img.src = src\n}\n\nconst getResolution = (file, cb) => {\n    var _URL = window.URL || window.webkitURL\n    var img\n    if (file) {\n        img = new Image()\n        var objectUrl = _URL.createObjectURL(file)\n        img.onload = function() {\n            cb({ width: this.width, height: this.height })\n            _URL.revokeObjectURL(objectUrl)\n        }\n        img.src = objectUrl\n    }\n}\n\nexport const deleteFile = fileId => (dispatch: Object, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (\n        window.confirm(\n            'Are you sure you want to delete this file? The file will be unavailable after the deletion and will not be visible in all elements and on all pages of your websites.'\n        )\n    ) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'deleteImage',\n                fileId,\n                _id: mD.currentWebsiteId,\n            })\n        )\n    }\n}\n","import { checkIfCapital } from './basic'\n\nexport default (props, item, values, mode, isFromBuffer) => {\n    if (props) {\n        item = props.resourceDraftStructure.find(\n            item => item.id === props.currentBox\n        )\n        if (item) values = props.resourceDraftValues[item.id]\n        mode = props.mode\n    }\n    let currentBoxType\n    if (item) {\n        if (mode === 'page') {\n            if (item.CMSVariableType) {\n                currentBoxType =\n                    item.CMSVariableType.indexOf('propagating_') >= 0\n                        ? 'isFromPropagatingPlugin'\n                        : 'isElementFromCMSVariable'\n            } else {\n                currentBoxType = 'isElementFromCMSVariable'\n            }\n        } else {\n            if (item.path.length === 0 && !isFromBuffer) {\n                if (item.id === 'trash') currentBoxType = 'trash'\n                else if (item.id === 'element_02') currentBoxType = 'CMSRoute'\n                else currentBoxType = 'html'\n            } else if (\n                item.path.length === 1 &&\n                !isFromBuffer &&\n                mode !== 'plugin'\n            ) {\n                currentBoxType = 'headBody'\n            } else if (checkIfCapital(item.tag.charAt(0))) {\n                currentBoxType = 'plugin'\n            } else if (item.text) {\n                currentBoxType = 'text'\n            } else {\n                currentBoxType = 'element'\n            }\n            if (item.isChildren) {\n                currentBoxType = 'children'\n            }\n            if (item.childrenTo) {\n                currentBoxType = 'childrenTo'\n            }\n            if (item.isCMSVariable) {\n                currentBoxType = 'isCMSVariable'\n            }\n            if (item.isElementFromCMSVariable) {\n                currentBoxType =\n                    values.CMSVariableType.indexOf('propagating_') >= 0\n                        ? 'isFromPropagatingPlugin'\n                        : 'isElementFromCMSVariable'\n            }\n        }\n    } else {\n        currentBoxType = 'none'\n    }\n    return currentBoxType\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Container\":\"Auth_Container__KMvOh\",\"socialButtons\":\"Auth_socialButtons__37I7_\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Lesson\":\"Courses_Lesson__1v1A4\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Cover\":\"Spinner_Cover__3iRbu\"};","import throttle from 'lodash.throttle'\n\nexport const CANCEL = 'redux-throttle/CANCEL'\nexport const FLUSH = 'redux-throttle/FLUSH'\n\nfunction map(throttled, action, method) {\n    if (action.payload && action.payload.type) {\n        let types = action.payload.type\n        if (!Array.isArray(types)) {\n            types = [types]\n        }\n        Object.keys(throttled)\n            .filter(t => types.includes(t))\n            .forEach(t => throttled[t][method]())\n        return\n    }\n    Object.keys(throttled).forEach(t => throttled[t][method]())\n    return\n}\n\nexport default function middleware(\n    defaultWait = 300,\n    defaultThrottleOption = {}\n) {\n    const throttled = {}\n    return store => next => action => {\n        if (action.type === CANCEL) {\n            map(throttled, action, 'cancel')\n            return next(action)\n        }\n\n        if (action.type === FLUSH) {\n            map(throttled, action, 'flush')\n            return next(action)\n        }\n\n        const shouldThrottle = (action.meta || {}).throttle\n\n        if (!shouldThrottle) {\n            return next(action)\n        }\n\n        if (throttled[action.type]) {\n            return throttled[action.type](action)\n        }\n\n        let wait = defaultWait\n        let options = defaultThrottleOption\n\n        if (!isNaN(shouldThrottle) && shouldThrottle !== true) {\n            wait = shouldThrottle\n        } else if (typeof shouldThrottle === 'object') {\n            wait = shouldThrottle.wait || defaultWait\n            options = { ...defaultThrottleOption, ...shouldThrottle }\n        }\n\n        throttled[action.type] = throttle(next, wait, options)\n\n        return throttled[action.type](action)\n    }\n}\n","import React, { Component } from 'react'\nimport { Redirect } from 'react-router-dom'\nimport { connect } from 'react-redux'\n\nimport * as actions from '../../../store/actions/index'\n\n// type Props = {\n//     onLogout: () => {},\n// }\n\nclass Logout extends Component {\n    componentDidMount() {\n        this.props.onLogout()\n    }\n\n    render() {\n        return <Redirect to=\"/login\" />\n    }\n}\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        onLogout: () => dispatch(actions.logout()),\n    }\n}\n\nexport default connect(\n    null,\n    mapDispatchToProps\n)(Logout)\n","import React, { Component } from 'react'\n\n// type Props = {}\n\n// type State = {\n//     component: Object | null,\n// }\n\nconst asyncComponent = importComponent => {\n    return class extends Component {\n        state = {\n            component: null,\n        }\n\n        componentDidMount() {\n            importComponent().then(cmp => {\n                this.setState({ component: cmp.default })\n            })\n        }\n\n        render() {\n            const C = this.state.component\n            return C ? <C {...this.props} /> : <div>Loading...</div>\n        }\n    }\n}\n\nexport default asyncComponent\n","import React, { useState, useEffect } from 'react'\n\nimport Checkbox from 'antd/es/checkbox'\nimport Cookies from 'universal-cookie'\nimport Button from 'antd/es/button'\nimport classes from './Auth.module.css'\nimport Svg from '../../components/Svg/Svg'\n\nconst cookies = new Cookies()\n\nconst Auth = () => {\n    const [state, setState] = useState(false)\n    const [cookieConsent, setCookieConsent] = useState(false)\n\n    useEffect(() => {\n        checkCookieConsent()\n    })\n\n    let remeberMeParam = '?rememberme=false'\n    if (state) {\n        remeberMeParam = '?rememberme=true'\n    }\n\n    const checkCookieConsent = () => {\n        const cookiesConsent = cookies.get('cookies_consent')\n        if (cookiesConsent) {\n            setCookieConsent(true)\n        }\n    }\n\n    const agreeWithCookies = () => {\n        cookies.set('cookies_consent', 'true', {\n            path: '/',\n            maxAge: 31530000,\n        })\n        checkCookieConsent()\n    }\n    const basicURL =\n        process.env.NODE_ENV !== 'development'\n            ? 'http://my.websiter.dev/api/auth/'\n            : 'http://my.websiter.test:5000/api/auth/'\n    return (\n        <div className={classes.Container}>\n            {!cookieConsent ? (\n                <>\n                    <div>\n                        We use cookies only for login purposes. In order to\n                        proceed you need to agree with the use of cookies.\n                    </div>\n                    <Button onClick={agreeWithCookies}>Agree</Button>\n                    <Button\n                        onClick={() => {\n                            window.open('http://websiter.dev', '_self')\n                        }}\n                    >\n                        Return to the homepage\n                    </Button>\n                </>\n            ) : (\n                <>\n                    <h1>Continue with:</h1>\n                    <div className={classes.socialButtons}>\n                        <a href={basicURL + `google/start${remeberMeParam}`}>\n                            <Svg icon='<svg width=\"50\" height=\"50\" viewBox=\"0 0 24 24\"><path fill=\"#4285F4\" d=\"M12.24 10.285V14.4h6.806c-.275 1.765-2.056 5.174-6.806 5.174-4.095 0-7.439-3.389-7.439-7.574s3.345-7.574 7.439-7.574c2.33 0 3.891.989 4.785 1.849l3.254-3.138C18.189 1.186 15.479 0 12.24 0c-6.635 0-12 5.365-12 12s5.365 12 12 12c6.926 0 11.52-4.869 11.52-11.726 0-.788-.085-1.39-.189-1.989H12.24z\"></path></svg>' />\n                            <div>GOOGLE</div>\n                        </a>\n                        <a href={basicURL + `facebook/start${remeberMeParam}`}>\n                            <Svg icon='<svg width=\"50\" height=\"50\" viewBox=\"0 0 24 24\"><path fill=\"#1877F2\" d=\"M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z\"></path></svg>' />\n                            <div>FACEBOOK</div>\n                        </a>\n                        {/* <a href={basicURL + `twitter/start${remeberMeParam}`}>\n                            <Svg icon='<svg width=\"50\" height=\"50\" viewBox=\"0 0 24 24\"><path fill=\"#1DA1F2\" d=\"M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z\"></path></svg>' />\n                            <div>TWITTER</div>\n                        </a> */}\n                        <a href={basicURL + `github/start${remeberMeParam}`}>\n                            <Svg icon='<svg width=\"50\" height=\"50\" viewBox=\"0 0 16 16\"><path fill=\"#333\" d=\"M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z\"></path></svg>' />\n                            <div>GITHUB</div>\n                        </a>\n                    </div>\n                    <Checkbox checked={state} onChange={() => setState(!state)}>\n                        Remember me\n                    </Checkbox>\n                </>\n            )}\n        </div>\n    )\n}\nexport default Auth\n","import React from 'react'\nimport classes from './Spinner.module.css'\nimport Spin from 'antd/es/spin'\nimport LoadingOutlined from '@ant-design/icons/LoadingOutlined'\n// type Props = {\n//     cover?: boolean,\n//     datatestid?: string,\n// }\n\nconst spinner = props => {\n    const spiningIcon = (\n        <Spin\n            indicator={<LoadingOutlined style={{ fontSize: 74 }} spin />}\n            tip=\"Loading...\"\n        />\n    )\n\n    return props.cover ? (\n        <div\n            className={classes.Cover}\n            data-testid={props.datatestid || 'cover'}\n        >\n            {spiningIcon}\n        </div>\n    ) : (\n        spiningIcon\n    )\n}\n\nexport default spinner\n","import React, { useEffect } from 'react'\nimport { connect } from 'react-redux'\nimport Card from 'antd/es/card'\n\nimport * as classes from './Courses.module.css'\n\nconst Courses = props => {\n    useEffect(() => {\n        if (!props.courses || !props.userCourses) {\n            props.getCourses()\n        }\n    })\n    return (\n        <Card title=\"Internet basics\">\n            <a href=\"https://websiter.dev\">\n                <Card\n                    className={classes.Lesson}\n                    type=\"inner\"\n                    hoverable\n                    cover={\n                        <div\n                            style={{\n                                backgroundImage:\n                                    'url(\"https://os.alipayobjects.com/rmsportal/QBnOOoLaAfKPirc.png\")',\n                                height: '200px',\n                                backgroundSize: 'cover',\n                                backgroundPosition: 'center',\n                            }}\n                        />\n                    }\n                    actions={['Seen', 'Tasks: 1/2']}\n                >\n                    <Card.Meta\n                        title=\"How internet works\"\n                        description=\"Get a basic understanding of how computers are connected in the world wide web.\"\n                    />\n                </Card>\n            </a>\n            <a href=\"https://websiter.dev\">\n                <Card\n                    className={classes.Lesson}\n                    type=\"inner\"\n                    hoverable\n                    cover={\n                        <div\n                            style={{\n                                backgroundImage:\n                                    'url(\"https://os.alipayobjects.com/rmsportal/QBnOOoLaAfKPirc.png\")',\n                                height: '200px',\n                                backgroundSize: 'cover',\n                                backgroundPosition: 'center',\n                            }}\n                        />\n                    }\n                    actions={['Seen', 'Tasks: 1/2']}\n                >\n                    <Card.Meta\n                        title=\"How internet works\"\n                        description=\"Get a basic understanding of how computers are connected in the world wide web.\"\n                    />\n                </Card>\n            </a>\n        </Card>\n    )\n}\n\nconst mapStateToProps = state => {\n    return {\n        courses: state.courses,\n        userCourses: state.userCourses,\n    }\n}\n\nconst mapDispatchToProps = (dispatch: any) => {\n    return {\n        getCourses: () => dispatch(actions.getCourses()),\n    }\n}\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(Courses)\n","import React, { useState } from 'react'\nimport { withRouter } from 'react-router-dom'\n\nimport { Layout, Menu } from 'antd'\nimport * as classes from './Layout.module.css'\nimport MenuUnfoldOutlined from '@ant-design/icons/MenuUnfoldOutlined'\nimport MenuFoldOutlined from '@ant-design/icons/MenuFoldOutlined'\nimport UserOutlined from '@ant-design/icons/UserOutlined'\nimport CoffeeOutlined from '@ant-design/icons/CoffeeOutlined'\nimport LogoutOutlined from '@ant-design/icons/LogoutOutlined'\nimport RocketOutlined from '@ant-design/icons/RocketOutlined'\n\nconst { Header, Sider, Content } = Layout\n\nconst AccountLayout = props => {\n    const [state, setState] = useState()\n\n    const toggle = () => {\n        setState(!state)\n    }\n\n    return (\n        <Layout style={{ height: '100%' }}>\n            <Sider collapsible collapsed={state} onCollapse={toggle}>\n                <div\n                    className={classes.componentsLayoutDemoCustomTriggerLogo}\n                />\n                <Menu\n                    theme=\"dark\"\n                    mode=\"inline\"\n                    defaultSelectedKeys={['dashboard']}\n                    onSelect={({ key }) => props.history.push('/' + key)}\n                >\n                    <Menu.Item key=\"dashboard\" icon={<CoffeeOutlined />}>\n                        Courses\n                    </Menu.Item>\n                    <Menu.Item key=\"websites\" icon={<RocketOutlined />}>\n                        Websites\n                    </Menu.Item>\n                    <Menu.Item key=\"account\" icon={<UserOutlined />}>\n                        Account\n                    </Menu.Item>\n                    <Menu.Item key=\"logout\" icon={<LogoutOutlined />}>\n                        Logout\n                    </Menu.Item>\n                </Menu>\n            </Sider>\n            <Layout className=\"site-layout\">\n                <Header\n                    className={classes.siteLayoutSiteLayoutBackground}\n                    style={{ padding: 0 }}\n                >\n                    {React.createElement(\n                        state ? MenuUnfoldOutlined : MenuFoldOutlined,\n                        {\n                            className:\n                                classes.componentsLayoutDemoCustomTriggerTrigger,\n                            onClick: toggle,\n                        }\n                    )}\n                </Header>\n                <Content\n                    className={classes.siteLayoutSiteLayoutBackground}\n                    style={{\n                        margin: '24px 16px',\n                        padding: 24,\n                        minHeight: 280,\n                    }}\n                >\n                    {props.children}\n                </Content>\n            </Layout>\n        </Layout>\n    )\n}\n\nexport default withRouter(AccountLayout)\n","import React, { Component } from 'react'\nimport { Route, Switch, withRouter, Redirect } from 'react-router-dom'\nimport { connect } from 'react-redux'\n\nimport Logout from './containers/Auth/Logout/Logout'\nimport asyncComponent from './hoc/asyncComponent'\nimport * as actions from './store/actions/index'\nimport Auth from './containers/Auth/Auth'\nimport Spinner from './components/UI/Spinner/Spinner'\nimport { initialState } from './store/reducer/reducer'\nimport './components/UI/loadStyles'\nimport Courses from './containers/Courses/Courses'\nimport AccountLayout from './components/Layout/Layout'\n\nconst asyncSiteBuilderLayout = asyncComponent(() => {\n    return import('./containers/SiteBuilderLayout/SiteBuilderLayout')\n})\n\ntype Props = {\n    onTryAutoSignup: Function\n    isAuthenticated: boolean\n    loading: typeof initialState.loading\n}\n\nclass App extends Component<Props> {\n    componentDidMount() {\n        this.props.onTryAutoSignup()\n    }\n\n    render() {\n        const isAuthed = this.props.isAuthenticated\n        const routes = (\n            <Switch>\n                <Route\n                    path=\"/courses\"\n                    exact\n                    render={props => <Courses {...props} isAuthed={isAuthed} />}\n                />\n                {/* <Link to={'cources/html/basic'} /> */}\n                <Route\n                    path=\"cources/:courceId/:lessonId\"\n                    exact\n                    component={asyncSiteBuilderLayout}\n                />\n                {isAuthed && (\n                    <Route\n                        path=\"/websites\"\n                        exact\n                        component={asyncSiteBuilderLayout}\n                    />\n                )}\n                {isAuthed && (\n                    <Route\n                        path=\"/account\"\n                        exact\n                        component={asyncSiteBuilderLayout}\n                    />\n                )}\n                {isAuthed && <Route path=\"/logout\" exact component={Logout} />}\n                {isAuthed && <Redirect to=\"/courses\" />}\n                {!isAuthed && <Route path=\"/login\" exact component={Auth} />}\n                {!isAuthed && <Redirect to=\"/login\" />}\n            </Switch>\n        )\n\n        return (\n            <>\n                <div style={{ height: '100%' }}>\n                    {this.props.location.pathname !== '/login' ? (\n                        <AccountLayout>{routes}</AccountLayout>\n                    ) : (\n                        routes\n                    )}\n                </div>\n                {this.props.loading && <Spinner cover />}\n            </>\n        )\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n        isAuthenticated: state.userId !== null,\n        loading: state.loading,\n    }\n}\n\nconst mapDispatchToProps = (dispatch: any) => {\n    return {\n        onTryAutoSignup: () => dispatch(actions.authCheckState()),\n    }\n}\n\nexport default withRouter(\n    connect(\n        mapStateToProps,\n        mapDispatchToProps\n    )(App)\n)\n","import isEqual from 'lodash/isEqual'\nimport omit from 'lodash/omit'\n\nexport default (draft1, draft2) =>\n    isEqual(\n        {\n            structure: draft1.structure.map(item =>\n                omit(item, ['expanded', 'children', 'itemPath', 'itemIndex'])\n            ),\n            values: draft1.values,\n        },\n        {\n            structure: draft2.structure.map(item =>\n                omit(item, ['expanded', 'children', 'itemPath', 'itemIndex'])\n            ),\n            values: draft2.values,\n        }\n    )\n","import {\n    structure,\n    current,\n    resourceObjectIndex,\n} from '../../utils/resourceTypeIndex'\nimport cloneDeep from 'lodash/cloneDeep'\nimport isEqual from 'lodash/isEqual'\nimport { checkIfCapital } from '../../utils/basic'\nimport resourcesAreEqual from '../../utils/resourcesAreEqual'\n\nconst diffpatcher = require('jsondiffpatch/dist/jsondiffpatch.umd.js').create({\n    objectHash: obj => obj.id,\n    propertyFilter: (name, context) => name !== '__patch__',\n})\n\nconst patchStructure = (state: Object, action: Object) => {\n    return diffpatcher.patch(\n        state[structure[action.resourceType]],\n        action.structurePatch\n    )\n}\n\nexport const addResourceSuccess = (state: Object, action: Object) => {\n    state[structure[action.resourceType]] = patchStructure(state, action)\n    state.resourcesObjects[action._id] = action.resource\n}\n\nexport const deleteResourceSuccess = (state: Object, action: Object) => {\n    action.deletedResources.forEach(id => delete state.resourcesObjects[id])\n    state[structure[action.resourceType]] = patchStructure(state, action)\n    state[current[action.resourceType]] = action.current || ''\n}\n\nexport const setCurrentResource = (state: Object, action: Object) => {\n    state.resourcesObjects[action.mD.currentWebsiteId][\n        current[action.resourceType]\n    ] = action._id\n    if (action.resourceType === 'page') {\n        state.hoveredElementSize = {}\n    }\n}\n\nexport const saveResourcesStructureSuccess = (\n    state: Object,\n    action: Object\n) => {\n    state[structure[action.resourceType]] = action.structure\n}\n\nexport const removeResourceFromUnsaved = (state: Object, action: Object) => {\n    state.notSavedResources = state.notSavedResources.filter(\n        item => item !== action._id\n    )\n}\n\nexport const addResourceToUnsaved = (state: Object, action: Object) => {\n    if (!state.notSavedResources.includes(action._id))\n        state.notSavedResources.push(action._id)\n}\n\nexport const removeResourceFromNewVersions = (\n    state: Object,\n    action: Object\n) => {\n    state.newVersionResources = state.newVersionResources.filter(\n        item => item !== action._id\n    )\n}\n\nexport const addResourceToNewVersions = (state: Object, action: Object) => {\n    if (!state.newVersionResources.includes(action._id))\n        state.newVersionResources.push(action._id)\n}\n\nexport const savePageInState = (state: Object, action: Object) => ({\n    ...state,\n    resourcesObjects: {\n        ...state.resourcesObjects,\n        [state.currentPage]: {\n            ...state.resourcesObjects[state.currentPage],\n            content: action.value,\n        },\n    },\n})\n\nexport const saveResourceDraftInState = (state: Object, action: Object) => {\n    state.resourcesObjects[action.currentResource].draft = action.draft\n}\n\nexport const saveResourceInState = (state: Object, action: Object) => {\n    state.resourcesObjects[action.currentResource].draft = action.draft\n    state.resourcesObjects[action.currentResource].present = action.draft\n    state.notSavedResources = state.notSavedResources.filter(\n        item => item !== action.currentResource\n    )\n}\n\nexport const addResourceVersion = (state: Object, action: Object) => {\n    const resource = cloneDeep(\n        action.globalSettings\n            ? action.mD.globalSettingsPageObject\n            : action.mD[resourceObjectIndex[action.resourceType]]\n    )\n    if (!isEqual(resource.present, action.draft)) {\n        if (action.isNotForHistory) {\n            resource.present = action.draft\n            state.resourcesObjects[resource._id] = resource\n        } else {\n            const newDraft = { ...action.draft }\n            if (\n                action.draft.structure &&\n                ['template', 'plugin'].includes(action.resourceType)\n            ) {\n                const connectedResources = []\n                action.draft.structure.forEach(item => {\n                    if (item.tag.length > 0 && item.path.length > 0) {\n                        if (\n                            checkIfCapital(item.tag.charAt(0)) &&\n                            !item.childrenTo &&\n                            !item.isChildren &&\n                            !item.isElementFromCMSVariable\n                        ) {\n                            connectedResources.push({\n                                name: item.tag,\n                                type: 'plugin',\n                            })\n                        }\n                    }\n                })\n                newDraft.connectedResources = connectedResources\n\n                // let resource =\n                //     state.resourcesObjects[\n                //         state.resourcesObjects[state.userId].loadedWebsite\n                //     ].templatesStructure.find(\n                //         item => item.id === action.currentResource\n                //     ) ||\n                //     state.pluginsStructure.find(\n                //         item => item.id === action.currentResource\n                //     )\n                // if (resource) {\n                //     resource.connectedResources = connectedResources\n                // }\n            }\n            const currentResourceId = action.globalSettings\n                ? action.mD.globalSettingsPageId\n                : action.mD[current[action.resourceType]]\n            if (\n                !resourcesAreEqual(\n                    resource.present.structure\n                        ? resource.present\n                        : resource.draft,\n                    newDraft\n                )\n            ) {\n                if (!state.notSavedResources.includes(currentResourceId))\n                    state.notSavedResources.push(currentResourceId)\n            }\n            // if (resource.past.length > 5) resource.past.shift()\n            // resource.past.push(diffpatcher.diff(resource.present, newDraft))\n            resource.present = newDraft\n            resource.future = []\n            state.resourcesObjects[resource._id] = resource\n        }\n    }\n}\n\n// export const undoResourceVersion = (state: Object, action: Object) => {\n//     const currentResource = state[current[state.currentTopTab]]\n//     const resource = state.resourcesObjects[currentResource]\n//     if (resource) {\n//         if (resource.past.length > 0) {\n//             if (\n//                 !isEqual(\n//                     resource.present,\n//                     resource.past[resource.past.length - 1]\n//                 )\n//             ) {\n//                 if (!state.notSavedResources.includes(action.currentResource))\n//                     state.notSavedResources.push(action.currentResource)\n//             } else {\n//                 state.notSavedResources = state.notSavedResources.filter(\n//                     item => item !== action.currentResource\n//                 )\n//             }\n\n//             const delta = resource.past.pop()\n//             resource.future.unshift(delta)\n//             resource.present = diffpatcher.unpatch(resource.present, delta)\n//         }\n//     }\n// }\n\n// export const redoResourceVersion = (state: Object, action: Object) => {\n//     const currentResource = state[current[state.currentTopTab]]\n//     const resource = state.resourcesObjects[currentResource]\n//     if (resource) {\n//         if (resource.future.length > 0) {\n//             if (!isEqual(resource.present, resource.future[0])) {\n//                 if (!state.notSavedResources.includes(action.currentResource))\n//                     state.notSavedResources.push(action.currentResource)\n//             } else {\n//                 state.notSavedResources = state.notSavedResources.filter(\n//                     item => item !== action.currentResource\n//                 )\n//             }\n\n//             const delta = resource.future.shift()\n//             resource.past.push(delta)\n//             resource.present = diffpatcher.patch(resource.present, delta)\n//         }\n//     }\n// }\n","import * as auth from './auth'\nimport * as images from './images'\nimport * as resources from './resources'\nimport { createReducer } from '@reduxjs/toolkit'\nimport resourcesAreEqual from '../../utils/resourcesAreEqual'\nimport { storeType } from '../../Types/store'\nimport { current } from '../../utils/resourceTypeIndex'\n\nexport const initialState = {\n    resourcesObjects: {},\n    error: null,\n    loading: false,\n    domainNotOk: false,\n    customDomainNotOk: false,\n    maxStorage: 0,\n    uploadingImage: false,\n    currentBoxInPlugin: '',\n    currentImage: '',\n    sizeIsChanging: false,\n    notSavedResources: [],\n    newVersionResources: [],\n    pageZoom: 100,\n    hoveredElementId: null,\n    hoveredElementSize: {},\n    isRefreshing: false,\n    userId: null,\n    barSizes: {\n        height: 200,\n        width: 400,\n        width2: 200,\n        width3: 200,\n    },\n    // currentTopTab: 'page',\n    findMode: null,\n    hoverMode: '',\n    fromFrame: false,\n    search: {},\n    shouldRefresh: false,\n    tryWebsiter: false,\n    currentUserInWebsiteSharing: '',\n    mD: {},\n    activeContainer: '',\n    clipboard: {},\n    pinnedElements: [],\n    activePinnedElement: '',\n    currentPinnedElementId: 0,\n    activeTab: 'page',\n}\n\nconst saveHoveredElementRect = (state, action) => {\n    const checkAndCreatePath = (path, index, parent) => {\n        if (index < path.length - 1) {\n            if (!parent[path[index].id]) {\n                parent[path[index].id] = {\n                    plugin: path[index].plugin,\n                    children: {},\n                }\n            }\n            checkAndCreatePath(\n                action.path,\n                index + 1,\n                parent[path[index].id].children\n            )\n        } else {\n            parent[path[index].id] = {\n                plugin: path[index].plugin,\n                children: {},\n                ...action.size,\n            }\n        }\n    }\n    if (action.path.length > 0)\n        checkAndCreatePath(action.path, 0, state.hoveredElementSize)\n}\n\nconst removeFromHoveredSizes = (state, action) => {\n    // ,\n    // removedElements,\n    const checkAndRemoveElement = parent => {\n        for (const item in parent) {\n            if (parent[item].plugin === action.currentResource) {\n                for (const child in parent[item].children) {\n                    if (action.removedElements.includes(child))\n                        delete parent[item].children[child]\n                }\n            } else {\n                checkAndRemoveElement(parent.children)\n            }\n        }\n    }\n    checkAndRemoveElement(state.hoveredElementSize)\n}\n\nconst toggleFindMode = (state, action) => {\n    if (action.value) {\n        if (state.findMode === action.value) {\n            state.findMode = null\n        } else {\n            state.findMode = action.value\n        }\n    } else {\n        state.findMode = null\n    }\n}\n\nconst reducer = createReducer(initialState, {\n    REMOVE_RESOURCE_FROM_UNSAVED: (state, action) =>\n        resources.removeResourceFromUnsaved(state, action),\n    REMOVE_RESOURCE_FROM_NEW_VERSIONS: (state, action) =>\n        resources.removeResourceFromNewVersions(state, action),\n    ACTION_START_IMAGE_UPLOAD: (state, action) =>\n        images.actionStartImageUpload(state),\n    ACTION_FAIL_IMAGE_UPLOAD: (state, action) =>\n        images.actionFailImageUpload(state, action),\n    ACTION_SUCCESS_IMAGE_UPLOAD: (state, action) =>\n        images.actionSuccessImageUpload(state),\n    CHOOSE_IMAGE: (state, action) => images.chooseImage(state, action),\n\n    SIZE_IS_CHANGING: (state, action) => {\n        state.sizeIsChanging = action.isChanging\n    },\n    ACTION_START: (state, action) => {\n        state.error = null\n        state.pagesLoading = true\n    },\n    ACTION_FAIL: (state, action) => {\n        state.error = action.error\n        state.pagesLoading = false\n    },\n    ACTION_SUCCESS: (state, action) => {\n        state.error = null\n        state.pagesLoading = false\n    },\n\n    ADD_RESOURCE_VERSION: (state, action) =>\n        resources.addResourceVersion(state, action),\n    // UNDO_RESOURCE_VERSION: (state, action) =>\n    //     resources.undoResourceVersion(state, action),\n    // REDO_RESOURCE_VERSION: (state, action) =>\n    //     resources.redoResourceVersion(state, action),\n\n    AUTH_START: (state, action) => auth.authStart(state),\n    AUTH_SUCCESS: (state, action) => auth.authSuccess(state, action),\n    AUTH_FAIL: (state, action) => auth.authFail(state, action),\n    AUTH_LOGOUT: (state, action) => auth.authLogout(state),\n    CHANGE_BAR_SIZE: (state, action) => auth.changeBarSize(state, action),\n    // SET_CURRENT_TOP_TAB: (state, action) => {\n    //     state.currentTopTab = action.currentTopTab\n    // },\n\n    SAVE_HOVERED_ELEMENT_RECT: (state: Object, action: Object) =>\n        saveHoveredElementRect(state, action),\n    REMOVE_FROM_HOVERED_SIZES: (state: Object, action: Object) =>\n        removeFromHoveredSizes(state, action),\n    HOVER_ELEMENT: (state: Object, action: Object) => {\n        state.hoveredElementId = action.id\n        state.hoverMode = action.mode\n        state.fromFrame = action.fromFrame\n    },\n    UNHOVER_ELEMENT: (state: Object, action: Object) => {\n        state.hoveredElementId = null\n        state.fromFrame = false\n    },\n    TOGGLE_FIND_MODE: (state: Object, action: Object) =>\n        toggleFindMode(state, action),\n    MARK_REFRESHING: (state: Object, action: Object) => {\n        state.isRefreshing = action.refreshing\n    },\n    MARK_SHOULD_REFRESHING: (state: Object, action: Object) => {\n        state.shouldRefresh = action.value\n    },\n    CHOOSE_USER_IN_WEBSITE_SHARING: (state: Object, action: Object) => {\n        state.currentUserInWebsiteSharing = action.id\n    },\n    SET_CURRENT_SITEBUILDER_MODE: (state: Object, action: Object) => {\n        state.currentSiteBuilderMode = action.mode\n    },\n    SAVE_MAIN_DATA: (state: Object, action: Object) => {\n        state.mD = action.mD\n    },\n    //ws\n    ADD_RESOURCE: (state: Object, action: Object) => {\n        const { mD } = state\n        if (action.data) {\n            if (action.data._id) {\n                if (mD.resourcesObjects[action.data._id]) {\n                    if (mD.resourcesObjects[action.data._id].draft) {\n                        state.resourcesObjects[action.data._id] = {\n                            ...mD.resourcesObjects[action.data._id],\n                            draft: action.data.draft,\n                            __v: action.data.__v,\n                        }\n                        let saved\n                        if (\n                            !mD.resourcesObjects[action.data._id].present\n                                .structure\n                        )\n                            saved = true\n                        else\n                            saved = resourcesAreEqual(\n                                action.data.draft,\n                                mD.resourcesObjects[action.data._id].present\n                            )\n\n                        if (saved) {\n                            resources.removeResourceFromUnsaved(state, {\n                                _id: action.data._id,\n                            })\n                            resources.removeResourceFromNewVersions(state, {\n                                _id: action.data._id,\n                            })\n                        } else {\n                            resources.addResourceToUnsaved(state, {\n                                _id: action.data._id,\n                            })\n                            resources.addResourceToNewVersions(state, {\n                                _id: action.data._id,\n                            })\n                        }\n                    } else {\n                        state.resourcesObjects[action.data._id] = {\n                            ...state.resourcesObjects[action.data._id],\n                            ...action.data,\n                        }\n                    }\n                } else state.resourcesObjects[action.data._id] = action.data\n                if (action.data._id.toString() === mD.userId.toString()) {\n                    if (action.data.settings)\n                        if (action.data.settings.barSizes)\n                            state.barSizes = action.data.settings.barSizes\n                }\n            }\n        }\n    },\n\n    DELETE_RESOURCE: (state: Object, action: Object) => {\n        if (action.data) {\n            delete state.resourcesObjects[action.data.resourceId]\n        }\n    },\n    REVERT_RESOURCE: (state: Object, action: Object) => {\n        if (action.data) {\n            state.resourcesObjects[action.data._id].present = action.data.draft\n            if (action.data.to === 'draft') {\n                resources.removeResourceFromUnsaved(state, {\n                    _id: action.data._id,\n                })\n                resources.removeResourceFromNewVersions(state, {\n                    _id: action.data._id,\n                })\n            }\n        }\n    },\n    SAVE_OBJECT: (state: Object, action: Object) => {\n        if (action.data) {\n            state.resourcesObjects[action.data._id] = action.data\n        }\n    },\n    SET_ACTIVE_CONTAINER: (state: Object, action: Object) => {\n        if (state.activeContainer !== action.container)\n            state.activeContainer = action.container\n    },\n    UNSET_ACTIVE_CONTAINER: (state: Object, action: Object) => {\n        if (state.activeContainer === action.container)\n            state.activeContainer = ''\n    },\n    SAVE_TO_CLIPBOARD: (state: Object, action: Object) => {\n        state.clipboard = action.data\n    },\n    SET_ACTIVE_PINNED_ELEMENT: (state: storeType, action: Object) => {\n        state.activePinnedElement = action.pinnedElement\n        const activePinnedItem = state.pinnedElements.find(\n            item => item.id.toString() === action.pinnedElement.toString()\n        )\n        if (activePinnedItem) {\n            state.activeTab = activePinnedItem.resourceType\n            if (state.mD.currentWebsiteId) {\n                state.resourcesObjects[state.userId].settings.websites[\n                    state.mD.currentWebsiteId\n                ][current[activePinnedItem.resourceType]] =\n                    activePinnedItem.resource\n            }\n            const resource = state.resourcesObjects[activePinnedItem.resource]\n            if (resource) {\n                if (!resource.present.structure) {\n                    state.resourcesObjects[activePinnedItem.resource].draft = {\n                        ...resource.draft,\n                        currentBox: activePinnedItem.element,\n                    }\n                } else {\n                    state.resourcesObjects[\n                        activePinnedItem.resource\n                    ].present = {\n                        ...resource.present,\n                        currentBox: activePinnedItem.element,\n                    }\n                }\n            }\n        }\n    },\n    REMOVE_PINNED_ELEMENT: (state: storeType, action: Object) => {\n        state.pinnedElements = state.pinnedElements.filter(\n            item => item.id.toString() !== action.pinnedElement.toString()\n        )\n    },\n    SET_ACTIVE_TAB: (state: storeType, action: Object) => {\n        state.activeTab = action.activeKey\n    },\n    ADD_PINNED_ELEMENT: (state: storeType, action: Object) => {\n        let pinnedElement = state.pinnedElements.find(\n            item =>\n                item.resourceType === action.resourceType &&\n                item.resource === action.resource &&\n                item.element === action.element\n        )\n        if (!pinnedElement) {\n            let unpinned = state.pinnedElements.findIndex(item => !item.pinned)\n            if (unpinned > -1) {\n                const pinnedElements = [...state.pinnedElements]\n\n                pinnedElements[unpinned] = {\n                    ...pinnedElements[unpinned],\n                    ...action,\n                }\n                state.pinnedElements = pinnedElements\n                state.activePinnedElement = pinnedElements[unpinned].id\n            } else {\n                state.currentPinnedElementId\n                unpinned = {\n                    ...action,\n                    id: 'pinned_' + state.currentPinnedElementId,\n                }\n                state.currentPinnedElementId++\n                state.pinnedElements = [unpinned, ...state.pinnedElements]\n                state.activePinnedElement = unpinned.id\n            }\n        } else state.activePinnedElement = pinnedElement.id\n    },\n    PIN_PINNED_ELEMENT: (state: storeType, action: Object) => {\n        state.pinnedElements = state.pinnedElements.map(item => {\n            if (item.id === action.pinnedElement)\n                return {\n                    ...item,\n                    pinned: true,\n                }\n            else return item\n        })\n    },\n})\n\nexport default reducer\n","import { initialState } from './reducer'\n\nexport const actionStartImageUpload = (state: Object) => ({\n    ...state,\n    error: null,\n    loading: true,\n})\n\nexport const actionSuccessImageUpload = (state: Object) => ({\n    ...state,\n    error: null,\n    loading: false,\n})\n\nexport const actionFailImageUpload = (state: Object, action: Object) => ({\n    ...state,\n    error: action.error,\n    loading: false,\n})\n\nexport const chooseImage = (state: Object = initialState, action: Object) => {\n    state.currentImage = action.image\n}\n","export const authStart = (state: Object) => {\n    state.loading = true\n    state.error = null\n}\n\nexport const authFail = (state: Object, action: Object) => {\n    state.loading = false\n    state.error = action.error\n    state.userId = null\n}\n\nexport const authLogout = (state: Object) => {\n    state.userId = null\n}\n\nexport const authSuccess = (state: Object, action: { data: {} }) => {\n    state.userId = action.data._id\n    state.accountInfo = action.data.accountInfo\n    state.error = null\n    state.loading = false\n    state.barSizes = { ...state.barSizes, ...action.data.barSizes }\n    state.tryWebsiter = action.data.tryWebsiter\n}\n\nexport const changeBarSize = (state: Object, action: Object) => {\n    state.barSizes[action.key] = action.value\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { composeWithDevTools } from 'redux-devtools-extension/developmentOnly'\nimport { BrowserRouter } from 'react-router-dom'\nimport { Provider } from 'react-redux'\nimport { createStore, applyMiddleware } from 'redux'\nimport thunk from 'redux-thunk'\nimport axios from 'axios'\nimport throttle from './store/middleware/throttle'\n\nimport './index.css'\nimport App from './App'\nimport reducer from './store/reducer/reducer'\n//import * as serviceWorker from './serviceWorker';\n\nimport 'react-sortable-tree/style.css'\n\nif (process.env.NODE_ENV === 'development') {\n    axios.defaults.baseURL = 'http://api.websiter.test:5000'\n} else {\n    axios.defaults.baseURL = 'https://api.websiter.dev'\n}\n\nconst defaultWait = 300\nconst defaultThrottleOption = {\n    leading: true,\n    trailing: true,\n}\n\nconst throttleMiddleware = throttle(defaultWait, defaultThrottleOption)\n\nexport const store = createStore(\n    reducer,\n    composeWithDevTools(applyMiddleware(throttleMiddleware, thunk))\n)\n\nconst app = (\n    <Provider store={store}>\n        <BrowserRouter>\n            <App />\n        </BrowserRouter>\n    </Provider>\n)\nconst inIframe = window.self !== window.top\n\nconst root = document.getElementById('root')\nif (root !== null && !inIframe) {\n    ReactDOM.render(app, root)\n}\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\n//serviceWorker.unregister();\n","import isEmpty from 'lodash/isEmpty'\nimport isEqual from 'lodash/isEqual'\nimport omit from 'lodash/omit'\n\nexport const checkIfCapital = (char: string) => {\n    if (char === char.toUpperCase() && char !== char.toLowerCase()) {\n        return true\n    }\n}\n\nexport const getCurrentResourceValue = (id: string, resourcesObjects: {}) =>\n    id\n        ? resourcesObjects[id]\n            ? isEmpty(resourcesObjects[id].present)\n                ? resourcesObjects[id].draft\n                : resourcesObjects[id].present\n            : null\n        : null\n\nfunction _objectSpread(target) {\n    for (var i = 1; i < arguments.length; i++) {\n        var source = arguments[i] != null ? arguments[i] : {}\n        var ownKeys = Object.keys(source)\n        if (typeof Object.getOwnPropertySymbols === 'function') {\n            ownKeys = ownKeys.concat(\n                //eslint-disable-next-line\n                Object.getOwnPropertySymbols(source).filter(function(sym) {\n                    return Object.getOwnPropertyDescriptor(\n                        source,\n                        sym\n                    ).enumerable\n                })\n            )\n        }\n        //eslint-disable-next-line\n        ownKeys.forEach(function(key) {\n            _defineProperty(target, key, source[key])\n        })\n    }\n    return target\n}\n\nfunction _defineProperty(obj, key, value) {\n    if (key in obj) {\n        Object.defineProperty(obj, key, {\n            value: value,\n            enumerable: true,\n            configurable: true,\n            writable: true,\n        })\n    } else {\n        obj[key] = value\n    }\n    return obj\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n    if (source == null) return {}\n    var target = _objectWithoutPropertiesLoose(source, excluded)\n    var key, i\n    if (Object.getOwnPropertySymbols) {\n        var sourceSymbolKeys = Object.getOwnPropertySymbols(source)\n        for (i = 0; i < sourceSymbolKeys.length; i++) {\n            key = sourceSymbolKeys[i]\n            if (excluded.indexOf(key) >= 0) continue\n            if (!Object.prototype.propertyIsEnumerable.call(source, key))\n                continue\n\n            target[key] = source[key]\n        }\n    }\n    return target\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {}\n    var target = {}\n    var sourceKeys = Object.keys(source)\n    var key, i\n    for (i = 0; i < sourceKeys.length; i++) {\n        key = sourceKeys[i]\n        if (excluded.indexOf(key) >= 0) continue\n        target[key] = source[key]\n    }\n    return target\n}\n\nexport function buildTree(items) {\n    var buildItem = function buildItem(item) {\n        // var path = item.path,\n        var data = _objectWithoutProperties(item, ['path'])\n\n        return _objectSpread({}, data, {\n            children: items\n                .filter(function(child) {\n                    return child.path[child.path.length - 1] === item.id\n                })\n                .map(function(child) {\n                    return buildItem(child)\n                }),\n        })\n    }\n\n    var tree = items\n        .filter(function(item) {\n            return item.path.length === 0\n        })\n        .map(function(item) {\n            return buildItem(item)\n        })\n    return tree\n}\n\nexport const getInheritedPropertyName = (value: string) => {\n    //this can be an object. check every value in object\n    if (typeof value === 'string') {\n        const length = value.length\n        if (length > 2) {\n            if (value.charAt(0) === '$' && value.charAt(length - 1) === '$') {\n                return value.substr(1, length - 2)\n            }\n        }\n    }\n    return false\n}\n\nexport const isEqualStructuresWithOmit = (structure1, structure2) =>\n    isEqual(\n        structure1.map(item =>\n            omit(item, ['expanded', 'children', 'itemPath'])\n        ),\n        structure2.map(item => omit(item, ['expanded', 'children', 'itemPath']))\n    )\n","export const structure = {\n    page: 'pagesStructure',\n    plugin: 'pluginsStructure',\n    template: 'templatesStructure',\n    file: 'filesStructure',\n}\n\nexport const current = {\n    page: 'currentPageId',\n    plugin: 'currentPluginId',\n    template: 'currentTemplateId',\n    file: 'currentFileId',\n}\n\nexport const resourceDraftIndex = {\n    page: 'currentPageDraft',\n    plugin: 'currentPluginDraft',\n    template: 'currentTemplateDraft',\n    file: 'currentFileDraft',\n}\n\nexport const resourceItemIndex = {\n    page: 'currentPageItem',\n    plugin: 'currentPluginItem',\n    template: 'currentTemplateItem',\n    file: 'currentFileItem',\n}\n\nexport const resourceObjectIndex = {\n    page: 'currentPageObject',\n    plugin: 'currentPluginObject',\n    template: 'currentTemplateObject',\n    file: 'currentFileObject',\n}\n","const addConnectedResources = (\n    draft,\n    id,\n    newRequestedResourcesList,\n    currentWebsiteObject,\n    resourcesObjects\n) => {\n    if (!resourcesObjects[id])\n        newRequestedResourcesList.push({\n            id,\n            type: 'resource',\n        })\n    if (draft)\n        if (draft.connectedResources)\n            draft.connectedResources.forEach(connectedResource => {\n                let nextResourceItem\n                if (connectedResource.type === 'plugin') {\n                    nextResourceItem = currentWebsiteObject.pluginsStructure.find(\n                        item => item.name === connectedResource.name\n                    )\n                }\n                if (nextResourceItem) {\n                    const nextResourceObject =\n                        resourcesObjects[nextResourceItem.id]\n                    let nextResourceDraft = {}\n                    if (nextResourceObject) {\n                        nextResourceDraft = nextResourceObject.present.structure\n                            ? nextResourceObject.present\n                            : nextResourceObject.draft\n                    }\n                    addConnectedResources(\n                        nextResourceDraft,\n                        nextResourceItem.id,\n                        newRequestedResourcesList,\n                        currentWebsiteObject,\n                        resourcesObjects\n                    )\n                }\n            })\n}\n\nexport default props => {\n    const { mD } = props\n    let newRequestedResourcesList = []\n    if (mD.userId && mD.resourcesObjects) {\n        if (!mD.userObject) {\n            newRequestedResourcesList.push({\n                id: mD.userId,\n                type: 'user',\n            })\n        } else {\n            let currentWebsiteId = mD.currentWebsiteId\n            for (let item of mD.websites) {\n                newRequestedResourcesList.push({\n                    id: item.id,\n                    type: 'website',\n                })\n            }\n            if (!currentWebsiteId) {\n                if (mD.websites.length > 0) currentWebsiteId = mD.websites[0].id\n                if (currentWebsiteId) {\n                    props.chooseWebsite(currentWebsiteId)\n                }\n            } else {\n                if (mD.currentPageId) {\n                    // if (!mD.currentPageObject) {\n                    //     newRequestedResourcesList.push({\n                    //         id: mD.currentPageId,\n                    //         type: 'resource',\n                    //     })\n                    // }\n\n                    addConnectedResources(\n                        mD.currentPageDraft,\n                        mD.currentPageId,\n                        newRequestedResourcesList,\n                        mD.currentWebsiteObject,\n                        mD.resourcesObjects\n                    )\n                    if (mD.pageTemplateId) {\n                        addConnectedResources(\n                            mD.pageTemplateDraft,\n                            mD.pageTemplateId,\n                            newRequestedResourcesList,\n                            mD.currentWebsiteObject,\n                            mD.resourcesObjects\n                        )\n                    }\n                }\n                if (mD.currentTemplateId) {\n                    addConnectedResources(\n                        mD.currentTemplateDraft,\n                        mD.currentTemplateId,\n                        newRequestedResourcesList,\n                        mD.currentWebsiteObject,\n                        mD.resourcesObjects\n                    )\n                }\n                if (mD.currentPluginId) {\n                    addConnectedResources(\n                        mD.currentPluginDraft,\n                        mD.currentPluginId,\n                        newRequestedResourcesList,\n                        mD.currentWebsiteObject,\n                        mD.resourcesObjects\n                    )\n                }\n                if (mD.globalSettingsPageId) {\n                    addConnectedResources(\n                        mD.globalSettingsPageDraft,\n                        mD.globalSettingsPageId,\n                        newRequestedResourcesList,\n                        mD.currentWebsiteObject,\n                        mD.resourcesObjects\n                    )\n                }\n                if (mD.globalSettingsTemplateId) {\n                    addConnectedResources(\n                        mD.globalSettingsTemplateDraft,\n                        mD.globalSettingsTemplateId,\n                        newRequestedResourcesList,\n                        mD.currentWebsiteObject,\n                        mD.resourcesObjects\n                    )\n                }\n            }\n        }\n    }\n    newRequestedResourcesList = Array.from(new Set(newRequestedResourcesList))\n    return newRequestedResourcesList\n}\n","import React from 'react'\n\nimport { connect } from 'react-redux'\nimport axios from 'axios'\n\nimport * as actions from '../../store/actions/index'\nimport { Component } from 'react'\nimport getListOfNeededResources from './methods/getListOfNeededResources'\nimport getEssentialData from '../../utils/getEssentialData'\n\n// type Props = {\n//     loadedWebsite: string,\n// }\n\n// type State = {\n//     requestedResources: Array<{}>,\n//     taskId: number,\n// }\n\nexport let webSocket = false\n\nlet currentCallbackId = 0\nconst callbacks = {}\n\nexport const addWSCallback = callback => {\n    currentCallbackId++\n    const callbackId = 'cb_' + currentCallbackId\n    callbacks[callbackId] = callback\n    return callbackId\n}\n\nconst fireCallback = id => {\n    if (callbacks[id]) {\n        callbacks[id]()\n        delete callbacks[id]\n    }\n}\n\nclass ReserveWebsiteInn extends Component {\n    state = {\n        requestedResources: [],\n        taskId: 0,\n    }\n\n    start = () => {\n        let url\n        if (process.env.NODE_ENV === 'development') {\n            url = 'ws://api.websiter.test:5000'\n        } else {\n            url = 'wss://api.websiter.dev'\n        }\n        let pingTimeout, authInterval\n        webSocket = new WebSocket(url)\n\n        const heartbeat = () => {\n            clearTimeout(pingTimeout)\n            pingTimeout = setTimeout(() => {\n                webSocket.close()\n            }, 30000 + 1000)\n            const versions = {}\n            for (let id in this.props.mD.resourcesObjects) {\n                versions[id] = {\n                    __v: this.props.mD.resourcesObjects[id].__v,\n                    type: this.props.mD.resourcesObjects[id].draft\n                        ? 'resource'\n                        : this.props.mD.resourcesObjects[id].pagesStructure\n                        ? 'website'\n                        : 'user',\n                }\n            }\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'heartbeat',\n                    versions,\n                })\n            )\n        }\n\n        webSocket.onopen = event => {\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'auth',\n                    user: axios.defaults.headers.common['x-auth-token'],\n                    tryWebsiter: sessionStorage.getItem('tryWebsiter'),\n                })\n            )\n            authInterval = setInterval(\n                () =>\n                    webSocket.send(\n                        JSON.stringify({\n                            messageCode: 'auth',\n                            noRequest: true,\n                            user: axios.defaults.headers.common['x-auth-token'],\n                            tryWebsiter: sessionStorage.getItem('tryWebsiter'),\n                        })\n                    ),\n                600000\n            )\n            heartbeat()\n        }\n        webSocket.onmessage = event => {\n            const data = JSON.parse(event.data)\n\n            switch (data.messageCode) {\n                case 'heartbeat':\n                    heartbeat()\n                    break\n                case 'logout':\n                    this.props.logout()\n                    break\n                case 'addResource':\n                    let resource = data.resource\n                    this.props.addResource(resource)\n                    break\n                case 'updateuser':\n                    this.props.updateUser(data, webSocket)\n                    break\n                case 'updatewebsite':\n                    this.props.updateWebsite(data, webSocket)\n                    break\n                case 'updateresource':\n                    this.props.updateResource(data, webSocket)\n                    break\n                case 'revertResource':\n                    this.props.revertResource(data)\n                    break\n                case 'deleteuser':\n                case 'deletewebsite':\n                case 'deleteresource':\n                    this.props.deleteResource(data)\n                    break\n                case 'confirmSaved':\n                    this.props.confirmSaved(data)\n                    break\n                case 'notFoundResource':\n                    this.markNotFoundResource(data)\n                    break\n                case 'error':\n                    alert(data.text)\n                    break\n                case 'fireCallback':\n                    fireCallback(data.callbackId)\n                    break\n                default:\n                    break\n            }\n        }\n        webSocket.onclose = event => {\n            clearTimeout(pingTimeout)\n            clearInterval(authInterval)\n        }\n    }\n\n    markNotFoundResource = data => {\n        const requestedResources = this.state.requestedResources.filter(\n            item => item.id.toString() === data._id.toString()\n        )\n        this.setState({ requestedResources })\n    }\n\n    checkInterval = null\n\n    check = () => {\n        if (!webSocket || webSocket.readyState === 3) {\n            this.start()\n        }\n    }\n    componentWillMount() {\n        this.checkInterval = setInterval(this.check, 5000)\n    }\n\n    reRequestResourcesInterval = null\n    reRequestResources = () => {\n        for (let requestedResource of this.state.requestedResources) {\n            if (requestedResource)\n                if (!this.props.mD.resourcesObjects[requestedResource.id]) {\n                    if (webSocket && webSocket.readyState !== 3) {\n                        webSocket.send(\n                            JSON.stringify({\n                                messageCode: 'requestResource',\n                                id: requestedResource.id,\n                                type: requestedResource.type,\n                            })\n                        )\n                    }\n                }\n        }\n    }\n    componentWillUnmount() {\n        clearInterval(this.reRequestResourcesInterval)\n        clearInterval(this.checkInterval)\n        if (webSocket) {\n            webSocket.close()\n        }\n    }\n\n    componentWillReceiveProps(nextProps) {\n        const newRequestedResourcesList = getListOfNeededResources(nextProps)\n        const requestedResources = []\n        for (const requestItem of newRequestedResourcesList) {\n            if (requestItem) {\n                let requestedResourceItem = this.state.requestedResources.find(\n                    item => item.id === requestItem.id\n                )\n                if (!requestedResourceItem) {\n                    if (webSocket && webSocket.readyState !== 3) {\n                        webSocket.send(\n                            JSON.stringify({\n                                messageCode: 'requestResource',\n                                id: requestItem.id,\n                                type: requestItem.type,\n                            })\n                        )\n                        requestedResourceItem = {\n                            id: requestItem.id,\n                            type: requestItem.type,\n                            state: 'sent',\n                        }\n                    }\n                }\n                if (requestedResourceItem)\n                    requestedResources.push(requestedResourceItem)\n            }\n        }\n        this.setState({ requestedResources })\n        clearInterval(this.reRequestResourcesInterval)\n        this.reRequestResourcesInterval = setInterval(\n            this.reRequestResources,\n            3000\n        )\n    }\n\n    render() {\n        return null\n    }\n}\n\nconst mapStateToPropsDo = state => {\n    return {\n        mD: state.mD,\n    }\n}\n\nconst mapDispatchToPropsDo = dispatch => {\n    return {\n        logout: () => dispatch(actions.logout()),\n        addResource: data => dispatch(actions.addResource(data)),\n        updateUser: (data, webSocket) =>\n            dispatch(actions.updateUser(data, webSocket)),\n        updateWebsite: (data, webSocket) =>\n            dispatch(actions.updateWebsite(data, webSocket)),\n        updateResource: (data, webSocket) =>\n            dispatch(actions.updateResource(data, webSocket)),\n        deleteResource: data => dispatch(actions.deleteResource(data)),\n        revertResource: data => dispatch(actions.revertResource(data)),\n        chooseWebsite: currentWebsiteId =>\n            dispatch(actions.chooseWebsite(currentWebsiteId)),\n        confirmSaved: data => dispatch(actions.removeResourceFromUnsaved(data)),\n    }\n}\n\nconst ReserveWebsiteDo = connect(\n    mapStateToPropsDo,\n    mapDispatchToPropsDo\n)(ReserveWebsiteInn)\n\nconst ReserveWebsite = props => {\n    props.saveMainData(props.mainData)\n    return <ReserveWebsiteDo />\n}\n\nconst mapStateToProps = state => {\n    const mainData = getEssentialData(state)\n    return {\n        mainData,\n    }\n}\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        saveMainData: mD => dispatch(actions.saveMainData(mD)),\n    }\n}\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(ReserveWebsite)\n","export default (structure, page) =>\n    structure.map(item => ({\n        ...item,\n        relUrl:\n            item.path.reduce((totalPath, itemId) => {\n                const el = structure.find(itemInn => itemInn.id === itemId)\n                if (el && (!el.hidden || el.folderPage))\n                    return totalPath + el[page ? 'url' : 'name'] + '/'\n                else {\n                    return totalPath\n                }\n            }, '/') + item[page ? 'url' : 'name'],\n    }))\n"],"sourceRoot":""}