{"version":3,"sources":["store/actions/builder.tsx","store/actions/auth.tsx","store/actions/website.tsx","store/actions/resources.tsx","store/actions/webSocket.tsx","store/actions/index.tsx","store/actions/files.tsx","utils/getBoxType.tsx","containers/Auth/Auth.module.css","components/UI/Spinner/Spinner.module.css","store/middleware/throttle.js","containers/Auth/Logout/Logout.tsx","hoc/asyncComponent.js","containers/Auth/Auth.tsx","components/UI/Spinner/Spinner.js","App.tsx","utils/resourcesAreEqual.tsx","store/reducer/resources.tsx","store/reducer/reducer.tsx","store/reducer/images.tsx","store/reducer/auth.tsx","index.tsx","utils/resourceTypeIndex.tsx","components/ReserveWebsite/methods/getListOfNeededResources.js","components/ReserveWebsite/ReserveWebsite.js","utils/getEssentialData.tsx","utils/buildRelUrls.tsx","utils/basic.tsx","websocketActions/sendUpdate.tsx","websocketActions/resources.tsx","websocketActions/websites.tsx","websocketActions/index.tsx","components/Svg/Svg.tsx"],"names":["htmlparser","require","findElementIndex","draft","currentBox","length","structure","findIndex","item","id","findRouteElements","mode","result","push","forEach","index","path","isEqual","trashIndex","saveElementsStructure","type","dispatch","getState","mD","resourceDraft","resourceDraftIndex","newStructure","map","oldItem","find","itemInn","Object","objectSpread","expanded","isNotForHistory","omit","actions","saveElementsStructureFromBuilder","globalSettings","chooseBox","unhoverBox","changeBoxPropertyInStructure","key","value","boxId","elementIndex","deleteFromHoveredSizes","current","changes","isObject","String","toString","concat","toConsumableArray","slice","throttle","changeBoxPropertyInValues","values","defineProperty","includes","saveHoveredElementRect","size","currentResource","removedElements","hoverBox","fromFrame","toggleFindMode","addBox","putInside","element","elementValues","isChildren","childrenTo","text","CMSVariableType","indexOf","isPropagatingItem","newId","currentId","newCurrentId","isCMSVariable","tag","textMode","isElementFromCMSVariable","textContent","properties","propertiesString","CMSVariableSystemName","CMSVariableDescription","CMSVariableDefaultValue","deleteBox","withChildren","routeElements","itemInStructure","elementId","filter","notRemove","newPageStructure","pathItem","_i","_removedElements","trashItem","structureElementsToLeave","trash","style","duplicateBox","idPrefix","sourceChildren","idMatch","newValuesElements","newChildren","newItemId","splitText","start","end","console","log","textContent0","substr","textContent1","textContent2","newElements","newValues","textToSpan","spanId","changeMenuItemProperty","itemId","resource","menuItems","newMenuItems","currentMenuItem","markRefreshing","refreshing","markShouldRefreshing","mergeBoxToPlugin","onlyChildren","newResourcesIds","oldResourcesIds","resourceDataValues","resourceDataStructure","newItem","resourceData","element_0","newPluginName","prompt","wsActions","i","dissolvePluginToBox","plugin","pluginsStructure","name","resourcesObjects","pluginResource","present","pluginDataValues","pluginDataStructure","parseHTML","htmlArray","parseDOM","newElementsValues","parseToWebsiter","curArray","data","trim","attribs","newElement","newElementValues","JSON","stringify","children","copyBox","cut","removedElementsIds","cutPath","oldStructure","structureElementsToRemain","valuesToLeave","saveToClipboard","pasteBox","inside","state","clipboard","pastToElementItem","onlyInside","fromElement","fromElementValues","toElement","toElementValues","fromType","getBoxType","toType","checkPossibilityToPaste","cookies","Cookies","authSuccess","deleteUser","sessionStorage","getItem","alert","window","confirm","webSocket","send","messageCode","logout","all","remove","axios","defaults","headers","common","logoutDo","authCheckState","setItem","get","_id","token","rememberMe","userId","jwt","decode","post","put","delete","Accept","then","response","removeItem","catch","err","error","message","changeBarSizeDo","savePropertiesOnLeave","_getState","barSizes","settings","userObject","changeBarSize","initiator","dif","dif2","value2","value3","width","Math","max","innerWidth","height","innerHeight","width2","width3","chooseWebsite","cloneDeep","currentWebsite","saveObject","chooseUserInWebsiteSharing","setSizeIsChanging","isChanging","saveMainData","chooseResource","resourceType","websites","globalSettingsPageId","currentPageFSBId","addResourceVersion","meta","setActiveContainer","container","unsetActiveContainer","removeResourceFromUnsaved","removeResourceFromNewVersions","diffpatcher","create","objectHash","obj","propertyFilter","context","addResource","addResourceDo","deleteResource","revertResource","updateUser","currentUser","resourceId","__v","patch","__patch__","requestResource","updateWebsite","newWebsite","updateResource","isEmpty","readyState","__webpack_require__","d","__webpack_exports__","builder_chooseBox","builder_addBox","builder_deleteBox","builder_duplicateBox","builder_saveElementsStructure","builder_saveElementsStructureFromBuilder","builder_changeBoxPropertyInStructure","builder_changeBoxPropertyInValues","builder_splitText","builder_textToSpan","builder_changeMenuItemProperty","builder_mergeBoxToPlugin","builder_dissolvePluginToBox","builder_parseHTML","builder_copyBox","builder_pasteBox","auth_logout","auth_authCheckState","auth_deleteUser","auth_changeBarSize","auth_savePropertiesOnLeave","website_chooseWebsite","files","resources_chooseResource","webSocket_updateUser","webSocket_updateWebsite","webSocket_updateResource","actionFailImageUpload","getSignedRequest","replace","editorMode","file","thumbnail","resolution","currentWebsiteId","namePrefix","k","filesStructure","serverName","fileDetails","v","thumbnailDetails","_home_ndjs_websiter_websiter_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__","fileName","fileType","fileSize","websiteId","thumbnailName","thumbnailType","thumbnailSize","doUploadFile","status","signedRequestThumbnail","Content-Type","signedRequest","newFileItem","nextFileId","url","modifiedDate","Date","now","currentFileItem","currentFileId","_home_ndjs_websiter_websiter_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__","createdDate","buildRelUrls","storage","newStorage","uploadFile","isCreated","reader","FileReader","onload","_ref","_home_ndjs_websiter_websiter_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__","_home_ndjs_websiter_websiter_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","a","mark","_callee","event","wrap","_context","prev","next","FileType","fromBuffer","target","sent","mime","resizeImageToSpecificSize","urltoFile","getResolution","stop","_x","apply","this","arguments","readAsArrayBuffer","filename","mimeType","match","fetch","res","arrayBuffer","buf","File","cb","resizeImageFromSrcToSpecificSize","readAsDataURL","src","img","Image","widthCoef","heightCoef","oc","document","createElement","octx","getContext","drawImage","toDataURL","_URL","URL","webkitURL","objectUrl","createObjectURL","revokeObjectURL","deleteFile","fileId","_basic__WEBPACK_IMPORTED_MODULE_0__","props","isFromBuffer","currentBoxType","resourceDraftStructure","resourceDraftValues","checkIfCapital","charAt","module","exports","Container","socialButtons","Cover","CANCEL","FLUSH","throttled","action","method","payload","types","Array","isArray","keys","t","Logout","onLogout","react_default","Redirect","to","Component","connect","asyncComponent","importComponent","_Component","_temp","_getPrototypeOf2","_this","classCallCheck","_len","args","_key","possibleConstructorReturn","getPrototypeOf","call","component","inherits","createClass","_this2","cmp","setState","default","C","Auth","_useState","useState","_useState2","slicedToArray","_useState3","_useState4","cookieConsent","setCookieConsent","useEffect","checkCookieConsent","remeberMeParam","basicURL","className","classes","Fragment","href","Svg","icon","es_checkbox","checked","onChange","es_button","onClick","set","maxAge","open","spinner","spiningIcon","spin","indicator","LoadingOutlined_default","fontSize","tip","cover","data-testid","datatestid","asyncSiteBuilderLayout","Promise","e","bind","App","onTryAutoSignup","routes","Switch","Route","isAuthenticated","loading","Spinner","withRouter","resourcesAreEqual","draft1","draft2","notSavedResources","newVersionResources","initialState","domainNotOk","customDomainNotOk","maxStorage","uploadingImage","currentBoxInPlugin","currentImage","sizeIsChanging","pageZoom","hoveredElementId","hoveredElementSize","isRefreshing","findMode","hoverMode","search","shouldRefresh","tryWebsiter","currentUserInWebsiteSharing","activeContainer","reducer","createReducer","REMOVE_RESOURCE_FROM_UNSAVED","resources","REMOVE_RESOURCE_FROM_NEW_VERSIONS","ACTION_START_IMAGE_UPLOAD","images","ACTION_FAIL_IMAGE_UPLOAD","ACTION_SUCCESS_IMAGE_UPLOAD","CHOOSE_IMAGE","undefined","image","SIZE_IS_CHANGING","ACTION_START","pagesLoading","ACTION_FAIL","ACTION_SUCCESS","ADD_RESOURCE_VERSION","globalSettingsPageObject","resourceObjectIndex","newDraft","connectedResources","currentResourceId","future","AUTH_START","auth","AUTH_SUCCESS","accountInfo","AUTH_FAIL","AUTH_LOGOUT","CHANGE_BAR_SIZE","SAVE_HOVERED_ELEMENT_RECT","checkAndCreatePath","parent","REMOVE_FROM_HOVERED_SIZES","checkAndRemoveElement","child","removeFromHoveredSizes","HOVER_ELEMENT","UNHOVER_ELEMENT","TOGGLE_FIND_MODE","MARK_REFRESHING","MARK_SHOULD_REFRESHING","CHOOSE_USER_IN_WEBSITE_SHARING","SET_CURRENT_SITEBUILDER_MODE","currentSiteBuilderMode","SAVE_MAIN_DATA","ADD_RESOURCE","DELETE_RESOURCE","REVERT_RESOURCE","SAVE_OBJECT","SET_ACTIVE_CONTAINER","UNSET_ACTIVE_CONTAINER","SAVE_TO_CLIPBOARD","src_store","baseURL","throttleMiddleware","defaultWait","defaultThrottleOption","store","shouldThrottle","wait","options","isNaN","leading","trailing","createStore","composeWithDevTools","applyMiddleware","thunk","app","es","BrowserRouter","src_App","inIframe","self","top","root","getElementById","ReactDOM","render","resourceItemIndex","page","template","addConnectedResources","newRequestedResourcesList","currentWebsiteObject","connectedResource","nextResourceItem","nextResourceObject","nextResourceDraft","ReserveWebsiteInn","requestedResources","taskId","pingTimeout","authInterval","WebSocket","heartbeat","clearTimeout","setTimeout","close","versions","pagesStructure","onopen","user","setInterval","noRequest","onmessage","parse","confirmSaved","markNotFoundResource","onclose","clearInterval","checkInterval","check","reRequestResourcesInterval","reRequestResources","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","requestedResource","return","nextProps","currentPageId","currentPageDraft","pageTemplateId","pageTemplateDraft","currentTemplateId","currentTemplateDraft","currentPluginId","currentPluginDraft","globalSettingsPageDraft","globalSettingsTemplateId","globalSettingsTemplateDraft","from","Set","getListOfNeededResources","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_loop","requestItem","requestedResourceItem","_iterator2","ReserveWebsiteDo","mainData","currentWebsiteItem","currentPageItem","currentPageFSBItem","currentTemplateItem","currentPluginItem","currentPageObject","currentPageFSBObject","currentTemplateObject","currentPluginObject","currentFileObject","currentPageFSBDraft","pageTemplateItem","pageTemplateObject","pageTemplateFSBItem","pageTemplateFSBObject","pageTemplateFSBDraft","templatesStructure","pageTemplateName","pageTemplateFSBName","pageTemplateFSBId","currentWebsiteItemSettings","hidden","globalSettingsPageItem","generalSettings","globalSettingsTemplateItem","globalSettingsTemplateObject","getEssentialData","_home_ndjs_websiter_websiter_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","relUrl","reduce","totalPath","el","folderPage","getCurrentResourceValue","buildTree","getInheritedPropertyName","isEqualStructuresWithOmit","lodash_isEmpty__WEBPACK_IMPORTED_MODULE_0__","lodash_isEmpty__WEBPACK_IMPORTED_MODULE_0___default","n","lodash_isEqual__WEBPACK_IMPORTED_MODULE_1__","lodash_isEqual__WEBPACK_IMPORTED_MODULE_1___default","lodash_omit__WEBPACK_IMPORTED_MODULE_2__","lodash_omit__WEBPACK_IMPORTED_MODULE_2___default","char","toUpperCase","toLowerCase","_defineProperty","enumerable","configurable","writable","_objectWithoutProperties","source","excluded","sourceKeys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","prototype","propertyIsEnumerable","items","buildItem","ownKeys","sym","getOwnPropertyDescriptor","_objectSpread","structure1","structure2","sendUpdate","currentDraft","oldResource","newResource","diff","markPublish","notPublished","duplicate","newResourceName","publishResource","changeWebsiteProperty","addWebsite","deleteWebsite","verifyCustomDomain","sharingRightsChange","right","newSharing","sharing","account","newRights","rights","addUserInWebsiteSharing","deleteUserInWebsiteSharing","transferWebsite","userTo","saveDomainName","sendUpdate_sendUpdate","resources_addResource","resources_deleteResource","resources_publishResource","resources_revertResource","websites_addWebsite","websites_deleteWebsite","websites_changeWebsiteProperty","websites_verifyCustomDomain","websites_sharingRightsChange","websites_addUserInWebsiteSharing","websites_deleteUserInWebsiteSharing","websites_transferWebsite","websites_saveDomainName","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","objectSvg","svg","stack","substring","pop","curObj","attr","selfclosing","svgStringToObj","viewBox","svgChildrenToElements","fill"],"mappings":"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","file":"static/js/main.0d29c3f5.chunk.js","sourcesContent":["import * as actions from './index'\nimport * as wsActions from '../../websocketActions'\nimport isEqual from 'lodash/isEqual'\nimport omit from 'lodash/omit'\nimport isObject from 'lodash/isObject'\nimport { current, resourceDraftIndex } from '../../utils/resourceTypeIndex'\n\nimport getBoxType from '../../utils/getBoxType'\n// import type { resourceType } from '../../store/reducer/reducer'\nvar htmlparser = require('htmlparser2')\n\nconst findElementIndex = draft => {\n    if (!draft.currentBox) return -1\n    if (draft.currentBox.length < 1) return -1\n    return draft.structure.findIndex(item => item.id === draft.currentBox)\n}\n\nconst findRouteElements = (draft, mode: 'plugin' | 'template' | 'page') => {\n    const result = []\n    if (mode === 'plugin') {\n        result.push(0)\n    } else if (mode === 'template') {\n        draft.structure.forEach((item, index) => {\n            if (item.path.length === 0 || isEqual(item.path, ['element_01']))\n                result.push(index)\n        })\n    }\n    const trashIndex = draft.structure.findIndex(item => item.id === 'trash')\n    if (trashIndex >= 0) result.push(trashIndex)\n    return result\n}\n\nexport const saveElementsStructure = (type, structure) => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!mD || !type || !resourceDraft || !structure) return\n\n    const newStructure = structure.map(item => {\n        const oldItem = resourceDraft.structure.find(\n            itemInn => itemInn.id === item.id\n        )\n        if (oldItem)\n            return {\n                ...item,\n                ...oldItem,\n                expanded: item.expanded,\n                path: item.path,\n            }\n        else return item\n    })\n    const draft = { ...resourceDraft, structure: newStructure }\n\n    const isNotForHistory = isEqual(\n        resourceDraft.structure.map(item =>\n            omit(item, ['expanded', 'children', 'itemPath'])\n        ),\n        newStructure.map(item =>\n            omit(item, ['expanded', 'children', 'itemPath'])\n        )\n    )\n    dispatch(actions.addResourceVersion(mD, type, draft, {}, isNotForHistory))\n}\n\nexport const saveElementsStructureFromBuilder = (\n    type,\n    draft,\n    globalSettings?: boolean\n) => (dispatch, getState) => {\n    const { mD } = getState()\n    dispatch(\n        actions.addResourceVersion(mD, type, draft, {}, false, globalSettings)\n    )\n}\n\nexport const chooseBox = (type, item: string) => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!mD || !type || !item || !resourceDraft) return\n    const draft = { ...resourceDraft, currentBox: item }\n    dispatch(actions.addResourceVersion(mD, type, draft, {}, true))\n    dispatch(unhoverBox())\n}\n\nexport const changeBoxPropertyInStructure = (\n    type,\n    key: string | {},\n    value: any,\n    isNotForHistory?: boolean,\n    boxId?: string\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!mD || !type || !key || !resourceDraft) return\n    let elementIndex\n    if (boxId) {\n        elementIndex = resourceDraft.structure.findIndex(\n            item => item.id === boxId\n        )\n    } else {\n        elementIndex = findElementIndex(resourceDraft)\n    }\n    if (elementIndex < 0) return\n    if (key === 'tag') {\n        dispatch(\n            deleteFromHoveredSizes(mD[current[type]], [\n                resourceDraft.structure[elementIndex].id,\n            ])\n        )\n    }\n\n    let changes = {}\n    if (isObject(key) && !(typeof key === 'string' || key instanceof String))\n        changes = key\n    else changes[key.toString()] = value\n    const draft = {\n        ...resourceDraft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            {\n                ...resourceDraft.structure[elementIndex],\n                ...changes,\n            },\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n    }\n\n    dispatch(\n        actions.addResourceVersion(\n            mD,\n            type,\n            draft,\n            {\n                throttle: 100,\n            },\n            isNotForHistory\n        )\n    )\n}\n\nexport const changeBoxPropertyInValues = (\n    type,\n    key: string | {},\n    value: any,\n    isNotForHistory?: boolean,\n    boxId?: string\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!mD || !type || !key || !resourceDraft) return\n    let elementIndex\n    if (boxId) {\n        elementIndex = resourceDraft.structure.findIndex(\n            item => item.id === boxId\n        )\n    } else {\n        elementIndex = findElementIndex(resourceDraft)\n    }\n    if (elementIndex < 0) return\n    if (key === 'tag') {\n        dispatch(\n            deleteFromHoveredSizes(mD[current[type]], [\n                resourceDraft.structure[elementIndex].id,\n            ])\n        )\n    }\n\n    let changes = {}\n    if (isObject(key) && !(typeof key === 'string' || key instanceof String))\n        changes = key\n    else changes[key.toString()] = value\n\n    const draft = {\n        ...resourceDraft,\n        values: {\n            ...resourceDraft.values,\n            [resourceDraft.structure[elementIndex].id]: {\n                ...resourceDraft.values[\n                    resourceDraft.structure[elementIndex].id\n                ],\n                ...changes,\n            },\n        },\n    }\n\n    dispatch(\n        actions.addResourceVersion(\n            mD,\n            type,\n            draft,\n            {\n                throttle:\n                    typeof key === 'string' &&\n                    ['currentFileId', 'defaultFileUrl', 'fileUrl'].includes(key)\n                        ? 100\n                        : 1000,\n            },\n            isNotForHistory\n        )\n    )\n}\n\nexport const saveHoveredElementRect = (path: Array<string>, size: Object) => ({\n    type: 'SAVE_HOVERED_ELEMENT_RECT',\n    path,\n    size,\n})\n\nconst deleteFromHoveredSizes = (currentResource, removedElements) => ({\n    type: 'REMOVE_FROM_HOVERED_SIZES',\n    currentResource,\n    removedElements,\n})\n\nexport const hoverBox = (id: string, mode: string, fromFrame?: boolean) => ({\n    type: 'HOVER_ELEMENT',\n    id,\n    mode,\n    fromFrame,\n})\n\nexport const unhoverBox = () => ({\n    type: 'UNHOVER_ELEMENT',\n})\n\nexport const toggleFindMode = (value?: string) => ({\n    type: 'TOGGLE_FIND_MODE',\n    value,\n})\n\nexport const addBox = (\n    mode: 'plugin' | 'template' | 'page',\n    type?: 'children' | 'inside' | 'text' | 'cmsVariable' | 'page'\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[mode]]\n    if (!resourceDraft) return\n    const routeElements = findRouteElements(resourceDraft, mode)\n    let elementIndex = findElementIndex(resourceDraft)\n\n    let putInside\n    if (mode === 'plugin') {\n        if (elementIndex <= 0) {\n            elementIndex = 0\n            putInside = true\n        }\n    } else if (mode === 'template') {\n        if (elementIndex < 0)\n            elementIndex = resourceDraft.structure.findIndex(\n                item => item.id === 'element_1'\n            )\n\n        if (resourceDraft.structure[elementIndex].id === 'element_01')\n            elementIndex = resourceDraft.structure.findIndex(\n                item => item.id === 'element_1'\n            )\n\n        if (\n            resourceDraft.structure[elementIndex].path.length < 2 &&\n            !isEqual(resourceDraft.structure[elementIndex].path, ['element_02'])\n        )\n            putInside = true\n    }\n    const element = resourceDraft.structure[elementIndex]\n    const elementValues = resourceDraft.values[element.id]\n    if (element.isChildren) {\n        putInside = false\n    } else if (element.childrenTo) {\n        putInside = true\n    } else {\n        if (type === 'inside') putInside = true\n    }\n\n    if (type === 'inside' || (type === 'text' && !element.text))\n        putInside = true\n\n    if (type === 'page') {\n        if (\n            elementValues.CMSVariableType &&\n            elementValues.CMSVariableType.indexOf('propagating_') >= 0\n        ) {\n            putInside = true\n        } else if (element.isPropagatingItem) {\n            putInside = false\n        } else {\n            return\n        }\n    }\n    const newId =\n        mode === 'page'\n            ? `elementCMS_${resourceDraft.currentId}`\n            : `element_${resourceDraft.currentId}`\n    const newCurrentId = resourceDraft.currentId + 1\n\n    const isCMSVariable =\n        resourceDraft.structure[elementIndex].id === 'element_02' ||\n        (resourceDraft.structure[elementIndex].path.length > 0 &&\n            resourceDraft.structure[elementIndex].path[0] === 'element_02')\n\n    const draft = {\n        ...resourceDraft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex + 1),\n            {\n                id: newId,\n                path: putInside\n                    ? [\n                          ...resourceDraft.structure[elementIndex].path,\n                          resourceDraft.structure[elementIndex].id,\n                      ]\n                    : [...resourceDraft.structure[elementIndex].path],\n                tag:\n                    mode === 'page'\n                        ? 'Item'\n                        : type === 'text'\n                        ? 'text'\n                        : type === 'children'\n                        ? 'New children'\n                        : isCMSVariable\n                        ? 'New CMS variable'\n                        : 'div',\n                isPropagatingItem: mode === 'page',\n                textMode: 'text',\n                text: type === 'text',\n                isChildren: type === 'children',\n                isCMSVariable: isCMSVariable,\n                isElementFromCMSVariable: type === 'cmsVariable',\n            },\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            [newId]: {\n                textContent: '',\n                properties: {},\n                propertiesString: '',\n                CMSVariableType: 'text',\n                CMSVariableSystemName: 'newCmsVariable',\n                CMSVariableDescription: 'New CMS variable description',\n                CMSVariableDefaultValue: 'New CMS variable default value',\n            },\n        },\n        currentId: newCurrentId,\n        currentBox: newId,\n    }\n\n    dispatch(actions.addResourceVersion(mD, mode, draft))\n}\n\nexport const deleteBox = (\n    type: 'page' | 'plugin' | 'template',\n    withChildren?: boolean\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const routeElements = findRouteElements(resourceDraft, type)\n    let elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0 || routeElements.includes(elementIndex)) return\n\n    const itemInStructure = resourceDraft.structure[elementIndex]\n    if (!itemInStructure) return\n    const elementId = itemInStructure.id\n\n    if (withChildren === 'page') {\n        if (!itemInStructure.isPropagatingItem) {\n            return\n        }\n    }\n    let draft = {}\n    const removedElements = [elementId]\n    if (itemInStructure.path[0] === 'trash') {\n        if (withChildren) {\n            draft = {\n                ...resourceDraft,\n                structure: resourceDraft.structure.filter(item => {\n                    const notRemove =\n                        elementId !== item.id && !item.path.includes(elementId)\n                    if (!notRemove) removedElements.push(item.id)\n                    return notRemove\n                }),\n            }\n        } else {\n            const newPageStructure = resourceDraft.structure.map(item => ({\n                ...item,\n                path: item.path.filter(pathItem => pathItem !== elementId),\n            }))\n\n            draft = {\n                ...resourceDraft,\n                structure: [\n                    ...newPageStructure.slice(0, elementIndex),\n                    ...newPageStructure.slice(elementIndex + 1),\n                ],\n            }\n        }\n        for (let item of removedElements) {\n            delete draft.values[item.id]\n        }\n    } else {\n        let trashItem = resourceDraft.structure.find(\n            item => item.id === 'trash'\n        )\n\n        if (withChildren) {\n            let structureElementsToLeave = resourceDraft.structure.filter(\n                item => {\n                    const notRemove =\n                        elementId !== item.id && !item.path.includes(elementId)\n                    if (!notRemove) removedElements.push(item.id)\n                    return notRemove\n                }\n            )\n            draft = {\n                ...resourceDraft,\n                structure: [\n                    ...structureElementsToLeave,\n                    ...(!trashItem\n                        ? [\n                              {\n                                  id: 'trash',\n                                  path: [],\n                                  tag: 'Trash',\n                              },\n                          ]\n                        : []),\n                    ...resourceDraft.structure\n                        .filter(item => removedElements.includes(item.id))\n                        .map(item => ({\n                            ...item,\n                            path: [\n                                'trash',\n                                ...(item.id !== elementId\n                                    ? item.path.slice(\n                                          item.path.indexOf(elementId)\n                                      )\n                                    : []),\n                            ],\n                        })),\n                ],\n                values: {\n                    ...resourceDraft.values,\n                    trash: {\n                        properties: {},\n                        style: '',\n                    },\n                },\n            }\n        } else {\n            const newPageStructure = resourceDraft.structure.map(item => ({\n                ...item,\n                path: item.path.filter(pathItem => pathItem !== elementId),\n            }))\n\n            draft = {\n                ...resourceDraft,\n                structure: [\n                    ...newPageStructure.slice(0, elementIndex),\n                    ...newPageStructure.slice(elementIndex + 1),\n                    ...(!trashItem\n                        ? [\n                              {\n                                  id: 'trash',\n                                  path: [],\n                                  tag: 'Trash',\n                              },\n                          ]\n                        : []),\n                    { ...itemInStructure, path: ['trash'] },\n                ],\n                values: {\n                    ...resourceDraft.values,\n                    trash: {\n                        properties: {},\n                        style: '',\n                    },\n                },\n            }\n        }\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n    dispatch(deleteFromHoveredSizes(mD[current[type]], removedElements))\n}\n\nexport const duplicateBox = (\n    type: 'page' | 'plugin' | 'template',\n    withChildren?: boolean\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const routeElements = findRouteElements(resourceDraft, type)\n    let elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0 || routeElements.includes(elementIndex)) return\n\n    const elementId = resourceDraft.structure[elementIndex].id\n    const idPrefix = withChildren === 'page' ? 'elementCMS_' : 'element_'\n    if (withChildren === 'page') {\n        if (!resourceDraft.structure[elementIndex].isPropagatingItem) {\n            return\n        }\n    }\n    const sourceChildren = resourceDraft.structure.filter(item =>\n        item.path.includes(elementId)\n    )\n\n    const newId = idPrefix + resourceDraft.currentId\n    let draft = { currentId: resourceDraft.currentId + 1 }\n\n    if (withChildren) {\n        const idMatch = { [elementId]: newId }\n        const newValuesElements = { [newId]: resourceDraft.values[elementId] }\n        const newChildren = sourceChildren\n            .map(item => {\n                let newItemId = idPrefix + draft.currentId\n                draft.currentId += 1\n                idMatch[item.id] = newItemId\n                newValuesElements[newItemId] = resourceDraft.values[item.id]\n                return {\n                    ...item,\n                    id: newItemId,\n                }\n            })\n            .map(item => {\n                return {\n                    ...item,\n\n                    path: item.path.map(pathItem => {\n                        if (idMatch[pathItem]) {\n                            return idMatch[pathItem]\n                        } else {\n                            return pathItem\n                        }\n                    }),\n                }\n            })\n\n        draft = {\n            ...resourceDraft,\n            ...draft,\n            structure: [\n                ...resourceDraft.structure.slice(\n                    0,\n                    elementIndex + sourceChildren.length\n                ),\n                {\n                    ...resourceDraft.structure[elementIndex],\n                    id: newId,\n                },\n                ...newChildren,\n                ...resourceDraft.structure.slice(\n                    elementIndex + sourceChildren.length\n                ),\n            ],\n            values: {\n                ...resourceDraft.values,\n                ...newValuesElements,\n            },\n        }\n    } else {\n        draft = {\n            ...resourceDraft,\n            ...draft,\n            structure: [\n                ...resourceDraft.structure.slice(\n                    0,\n                    elementIndex + sourceChildren.length\n                ),\n                {\n                    ...resourceDraft.structure[elementIndex],\n                    id: newId,\n                },\n                ...resourceDraft.structure.slice(\n                    elementIndex + sourceChildren.length\n                ),\n            ],\n            values: {\n                ...resourceDraft.values,\n                [newId]: resourceDraft.values[elementId],\n            },\n        }\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n\nexport const splitText = (type, start: number, end: number) => (\n    dispatch: Object,\n    getState\n) => {\n    console.log(type)\n    console.log(start)\n    console.log(end)\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0) return\n\n    const itemInStructure = resourceDraft.structure[elementIndex]\n    if (!itemInStructure) return\n    const elementId = itemInStructure.id\n\n    const text = resourceDraft.values[elementId].textContent\n    if (!text) return\n\n    let draft = { currentId: resourceDraft.currentId }\n    let newId\n\n    const textContent0 = text.substr(0, start)\n    const textContent1 = text.substr(start, end - start)\n    const textContent2 = text.substr(end)\n\n    const newElements = [\n        {\n            ...resourceDraft.structure[elementIndex],\n        },\n    ]\n\n    const newValues = {\n        [elementId]: {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent0,\n        },\n    }\n\n    if (textContent1.length > 0) {\n        newId = `element_${draft.currentId}`\n        draft.currentId = draft.currentId + 1\n        newElements.push({\n            ...resourceDraft.structure[elementIndex],\n            id: newId,\n        })\n        newValues[newId] = {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent1,\n        }\n    }\n\n    if (textContent2.length > 0 || textContent1.length === 0) {\n        newId = `element_${draft.currentId}`\n        draft.currentId = draft.currentId + 1\n        newElements.push({\n            ...resourceDraft.structure[elementIndex],\n            id: newId,\n        })\n        newValues[newId] = {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent2,\n        }\n    }\n\n    draft = {\n        ...resourceDraft,\n        ...draft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            ...newElements,\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            ...newValues,\n        },\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n\nexport const textToSpan = (type, start: number, end: number) => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0) return\n\n    const itemInStructure = resourceDraft.structure[elementIndex]\n    if (!itemInStructure) return\n    const elementId = itemInStructure.id\n\n    const text = resourceDraft.values[elementId].textContent\n    if (!text) return\n\n    let newId\n    let draft = { currentId: resourceDraft.currentId }\n\n    const textContent0 = text.substr(0, start)\n    const textContent1 = text.substr(start, end - start)\n    const textContent2 = text.substr(end)\n\n    const newElements = [\n        {\n            ...resourceDraft.structure[elementIndex],\n        },\n    ]\n\n    const newValues = {\n        [elementId]: {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent0,\n        },\n    }\n\n    const spanId = `element_${draft.currentId}`\n    draft.currentId = draft.currentId + 1\n    newElements.push({\n        id: spanId,\n        path: [...resourceDraft.structure[elementIndex].path],\n        tag: 'span',\n        text: false,\n    })\n\n    newValues[spanId] = {\n        textContent: '',\n        style: '',\n        properties: {},\n    }\n\n    newId = `element_${draft.currentId}`\n    draft.currentId = draft.currentId + 1\n    newElements.push({\n        ...resourceDraft.structure[elementIndex],\n        path: [...resourceDraft.structure[elementIndex].path, spanId],\n        textContent: textContent1,\n        id: newId,\n    })\n\n    newValues[newId] = {\n        ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n        textContent: textContent1,\n    }\n\n    if (textContent2.length > 0) {\n        newId = `element_${draft.currentId}`\n        draft.currentId = draft.currentId + 1\n        newElements.push({\n            ...resourceDraft.structure[elementIndex],\n            textContent: textContent2,\n            id: newId,\n        })\n        newValues[newId] = {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent2,\n        }\n    }\n\n    draft = {\n        ...resourceDraft,\n        ...draft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            ...newElements,\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            ...newValues,\n        },\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n//Menu\n\nexport const changeMenuItemProperty = (\n    type,\n    key: string,\n    value: string,\n    itemId?: string\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resource = mD[resourceDraftIndex[type]]\n\n    if (!resource) return\n\n    const elementIndex = findElementIndex(resource)\n    if (elementIndex < 0) return\n    const elementId = resource.structure[elementIndex].id\n\n    if (!resource.values[elementId].menuItems) return\n    const newMenuItems = resource.values[elementId].menuItems.map(item => {\n        if (\n            item.id ===\n            (itemId ? itemId : resource.values[elementId].currentMenuItem)\n        ) {\n            return { ...item, [key]: value }\n        } else {\n            return item\n        }\n    })\n    if (!isEqual(newMenuItems, resource.values[elementId].menuItems)) {\n        dispatch(changeBoxPropertyInValues(type, 'menuItems', newMenuItems))\n    }\n}\nexport const markRefreshing = (refreshing: boolean) => ({\n    type: 'MARK_REFRESHING',\n    refreshing,\n})\n\nexport const markShouldRefreshing = (value?: boolean) => ({\n    type: 'MARK_SHOULD_REFRESHING',\n    value,\n})\n\nexport const mergeBoxToPlugin = (\n    type: 'page' | 'plugin' | 'template',\n    onlyChildren?: boolean\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n\n    if (!resourceDraft) return\n    const routeElements = findRouteElements(resourceDraft, type)\n    let elementIndex = findElementIndex(resourceDraft)\n    if (\n        elementIndex <= 0 ||\n        (!onlyChildren && routeElements.includes(elementIndex))\n    )\n        return\n\n    const elementId = resourceDraft.structure[elementIndex].id\n    let currentId = 1\n    const newResourcesIds = ['element_0']\n    const oldResourcesIds = ['element_0']\n    const resourceDataValues = {}\n\n    const resourceDataStructure = resourceDraft.structure\n        .filter(\n            item =>\n                (!onlyChildren && item.id === elementId) ||\n                item.path.includes(elementId)\n        )\n        .map(item => {\n            oldResourcesIds.push(item.id)\n            const newItem = { ...item, id: `element_${currentId}` }\n            resourceDataValues[newItem.id] = {\n                ...resourceDraft.values[item.id],\n            }\n            if (item.id === elementId) {\n                newItem.path = ['element_0']\n            } else {\n                newItem.path = [\n                    'element_0',\n                    ...newItem.path.slice(\n                        newItem.path.indexOf(elementId) + (onlyChildren ? 1 : 0)\n                    ),\n                ]\n            }\n            newResourcesIds.push(newItem.id)\n            currentId++\n            return newItem\n        })\n        .map(item => ({\n            ...item,\n            path: item.path.map(\n                id => newResourcesIds[oldResourcesIds.indexOf(id)]\n            ),\n        }))\n    if (resourceDataStructure.length === 0) return\n    const resourceData = {\n        structure: [\n            {\n                id: 'element_0',\n                path: [],\n                tag: 'Main element',\n                textMode: '',\n            },\n            ...resourceDataStructure,\n        ],\n        values: {\n            ...resourceDataValues,\n            element_0: {\n                properties: {},\n                propertiesString: '',\n                textContent: '',\n            },\n        },\n        currentId,\n    }\n\n    const newPluginName =\n        prompt('Name the new plugin', 'New plugin') || 'New plugin'\n\n    dispatch(\n        wsActions.addResource('plugin', false, newPluginName, resourceData)\n    )\n\n    const draft = {\n        ...resourceDraft,\n        structure: [\n            ...resourceDraft.structure.slice(\n                0,\n                elementIndex + (onlyChildren ? 1 : 0)\n            ),\n            {\n                ...resourceDraft.structure[elementIndex],\n                path: [\n                    ...resourceDraft.structure[elementIndex].path,\n                    ...(onlyChildren\n                        ? [resourceDraft.structure[elementIndex].id]\n                        : []),\n                ],\n                tag: newPluginName,\n                text: false,\n                id: oldResourcesIds[1],\n            },\n            ...resourceDraft.structure.slice(\n                elementIndex +\n                    (onlyChildren ? 1 : 0) +\n                    resourceDataStructure.length\n            ),\n        ],\n        values: {\n            ...resourceDraft.values,\n            [oldResourcesIds[1]]: {\n                textContent: '',\n                propertiesString: '',\n                properties: {},\n            },\n        },\n    }\n    for (let i = 2; i < oldResourcesIds.length; i++) {\n        delete draft.values[oldResourcesIds[i]]\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft, { throttle: 1000 }))\n}\n\nexport const dissolvePluginToBox = type => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    let elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0) return\n\n    // const elementId = resourceDraft.structure[elementIndex].id\n\n    const plugin = mD.pluginsStructure.find(\n        item => item.name === resourceDraft.structure[elementIndex].tag\n    )\n    if (!plugin) return\n    if (!mD.resourcesObjects[plugin.id]) return\n\n    const pluginResource = !mD.resourcesObjects[plugin.id].present.structure\n        ? mD.resourcesObjects[plugin.id].draft\n        : mD.resourcesObjects[plugin.id].present\n\n    let currentId = resourceDraft.currentId\n    const newResourcesIds = []\n    const oldResourcesIds = []\n    const pluginDataValues = {}\n\n    const pluginDataStructure = pluginResource.structure\n        .filter(item => item.path.length > 0)\n        .map(item => {\n            oldResourcesIds.push(item.id)\n            const newItem = {\n                ...item,\n                id: `element_${currentId}`,\n                path: [...item.path.slice(1)],\n            }\n            pluginDataValues[newItem.id] = resourceDraft.values[item.id]\n\n            newResourcesIds.push(newItem.id)\n            currentId++\n            return newItem\n        })\n        .map(item => ({\n            ...item,\n            path: [\n                ...resourceDraft.structure[elementIndex].path,\n                ...item.path.map(\n                    id => newResourcesIds[oldResourcesIds.indexOf(id)]\n                ),\n            ],\n        }))\n\n    const draft = {\n        ...resourceDraft,\n        currentId,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            ...pluginDataStructure,\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            ...pluginDataValues,\n        },\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n\nexport const setCurrentSiteBuilderMode = (mode: string) => ({\n    type: 'SET_CURRENT_SITEBUILDER_MODE',\n    mode,\n})\n\nexport const parseHTML = (type, value: string) => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0) return\n    let draft = { currentId: resourceDraft.currentId }\n\n    const htmlArray = htmlparser.parseDOM(value)\n    const newElements = []\n    const newElementsValues = {}\n    const parseToWebsiter = (curArray, path) => {\n        curArray.forEach(item => {\n            if (!(item.type === 'text' && item.data.trim() === '')) {\n                if (item.type === 'text' || item.type === 'tag') {\n                    const newId = `element_${draft.currentId}`\n                    draft.currentId = draft.currentId + 1\n                    const properties = item.attribs\n                        ? omit(item.attribs, 'style')\n                        : {}\n                    const newElement = {\n                        id: newId,\n                        path,\n                        tag: item.name || 'div',\n                        text: false,\n                    }\n                    const newElementValues = {\n                        textContent: '',\n                        style: item.attribs ? item.attribs.style || '' : '',\n                        properties,\n                        propertiesString: JSON.stringify(properties),\n                    }\n                    if (item.type === 'text') {\n                        newElement.tag = 'text'\n                        newElement.text = true\n                        newElementValues.textMode = 'text'\n                        newElementValues.textContent = item.data\n                    }\n                    newElements.push(newElement)\n                    newElementsValues[newId] = newElementValues\n                    if (item.children)\n                        parseToWebsiter(item.children, [...path, newId])\n                }\n            }\n        })\n    }\n    parseToWebsiter(htmlArray, resourceDraft.structure[elementIndex].path)\n    draft = {\n        ...resourceDraft,\n        ...draft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            ...newElements,\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            ...newElementsValues,\n        },\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n\nexport const copyBox = (\n    type: 'page' | 'plugin' | 'template',\n    cut: boolean,\n    withChildren?: boolean\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const routeElements = findRouteElements(resourceDraft, type)\n    let elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0 || routeElements.includes(elementIndex)) return\n\n    const elementId = resourceDraft.structure[elementIndex].id\n\n    const itemInStructure = resourceDraft.structure.find(\n        item => item.id === elementId\n    )\n    if (!itemInStructure) return\n    if (type === 'page') {\n        if (!itemInStructure.isPropagatingItem) return\n        withChildren = true\n    }\n    let draft = {}\n    const removedElementsIds = [elementId]\n\n    let trashItem = resourceDraft.structure.find(item => item.id === 'trash')\n    let structureElementsToLeave = []\n\n    const cutPath = oldStructure => {\n        return oldStructure.map((item, index) =>\n            index === 0\n                ? { ...item, path: [] }\n                : {\n                      ...item,\n                      path: item.path.slice(\n                          item.path.indexOf(oldStructure[0].id)\n                      ),\n                  }\n        )\n    }\n    if (withChildren) {\n        const structureElementsToRemain = resourceDraft.structure.filter(\n            item => {\n                const notRemove =\n                    elementId !== item.id && !item.path.includes(elementId)\n                if (!notRemove) {\n                    removedElementsIds.push(item.id)\n                    structureElementsToLeave.push(item)\n                }\n                return notRemove\n            }\n        )\n        let valuesToLeave = {}\n        structureElementsToLeave = cutPath(structureElementsToLeave)\n        structureElementsToLeave.forEach(\n            item => (valuesToLeave[item.id] = resourceDraft.values[item.id])\n        )\n        if (cut && itemInStructure.path[0] !== 'trash') {\n            draft = {\n                ...resourceDraft,\n                structure: [\n                    ...structureElementsToRemain,\n                    ...(!trashItem\n                        ? [\n                              {\n                                  id: 'trash',\n                                  path: [],\n                                  tag: 'Trash',\n                              },\n                          ]\n                        : []),\n                    ...resourceDraft.structure\n                        .filter(item => removedElementsIds.includes(item.id))\n                        .map(item => ({\n                            ...item,\n                            path: [\n                                'trash',\n                                ...(item.id !== elementId\n                                    ? item.path.slice(\n                                          item.path.indexOf(elementId)\n                                      )\n                                    : []),\n                            ],\n                        })),\n                ],\n                values: {\n                    ...resourceDraft.values,\n                    trash: {\n                        properties: {},\n                        style: '',\n                    },\n                },\n            }\n        }\n    } else {\n        structureElementsToLeave = cutPath([itemInStructure])\n\n        if (cut && itemInStructure.path[0] !== 'trash') {\n            const newPageStructure = resourceDraft.structure.map(item => ({\n                ...item,\n                path: item.path.filter(pathItem => pathItem !== elementId),\n            }))\n            draft = {\n                ...resourceDraft,\n                structure: [\n                    ...newPageStructure.slice(0, elementIndex),\n                    ...newPageStructure.slice(elementIndex + 1),\n                    ...(!trashItem\n                        ? [\n                              {\n                                  id: 'trash',\n                                  path: [],\n                                  tag: 'Trash',\n                              },\n                          ]\n                        : []),\n                    { ...itemInStructure, path: ['trash'] },\n                ],\n                values: {\n                    ...resourceDraft.values,\n                    trash: {\n                        properties: {},\n                        style: '',\n                    },\n                },\n            }\n        }\n    }\n    if (cut && itemInStructure.path[0] !== 'trash') {\n        dispatch(actions.addResourceVersion(mD, type, draft))\n        dispatch(deleteFromHoveredSizes(mD[current[type]], removedElementsIds))\n    }\n    let valuesToLeave = {}\n    structureElementsToLeave.forEach(\n        item => (valuesToLeave[item.id] = resourceDraft.values[item.id])\n    )\n\n    dispatch(\n        saveToClipboard({\n            structure: structureElementsToLeave,\n            values: valuesToLeave,\n            type: 'websiterElements',\n        })\n    )\n}\n\nconst saveToClipboard = data => ({\n    type: 'SAVE_TO_CLIPBOARD',\n    data,\n})\n\nconst checkPossibilityToPaste = (\n    fromElement,\n    fromElementValues,\n    toElement,\n    toElementValues,\n    mode\n) => {\n    if (mode === 'page') {\n        if (toElement) {\n            if (toElement.isPropagatingItem) return 'notInside'\n            if (\n                toElement.CMSVariableType &&\n                toElement.CMSVariableType.indexOf('propagating_') >= 0\n            )\n                return 'inside'\n        }\n        return false\n    }\n    const fromType = getBoxType(\n        false,\n        fromElement,\n        fromElementValues,\n        mode,\n        true\n    )\n    const toType = getBoxType(false, toElement, toElementValues, mode)\n\n    if (\n        [\n            'html',\n            'headBody',\n            'trash',\n            'CMSRoute',\n            'children',\n            'childrenTo',\n        ].includes(fromType)\n    )\n        return false\n    if (fromType === 'isCMSVariable') {\n        if (toType === 'CMSRoute') return 'inside'\n        if (toElement.path.length > 0 && toElement.path[0] === 'element_02')\n            return true\n        return false\n    }\n    if (\n        ['element', 'plugin', 'text', 'isElementFromCMSVariable'].includes(\n            fromType\n        )\n    ) {\n        if (['html', 'headbody', 'childrenTo'].includes(toType)) {\n            return 'inside'\n        }\n        if (toType === 'element') return true\n        if (['plugin', 'text', 'isElementFromCMSVariable'].includes(toType))\n            return 'notInside'\n    }\n\n    return false\n}\n\nexport const pasteBox = (type, inside) => (dispatch: Object, getState) => {\n    const state = getState()\n    const { mD } = state\n    if (state.clipboard.type !== 'websiterElements') return\n    if (state.clipboard.structure.length < 1) return\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    let elementIndex = findElementIndex(resourceDraft)\n\n    const pastToElementItem = resourceDraft.structure[elementIndex]\n\n    // const elementId = state.clipboard.structure[0].id\n\n    const sourceChildren = state.clipboard.structure\n    const onlyInside = checkPossibilityToPaste(\n        sourceChildren[0],\n        state.clipboard.values[sourceChildren[0].id],\n        pastToElementItem,\n        resourceDraft.values[pastToElementItem.id],\n        type\n    )\n    if (!onlyInside) return\n\n    let putInside\n    if (type === 'plugin') {\n        if (elementIndex <= 0) {\n            elementIndex = 0\n            putInside = true\n        }\n    } else if (type === 'template') {\n        if (elementIndex < 0)\n            elementIndex = resourceDraft.structure.findIndex(\n                item => item.id === 'element_1'\n            )\n        if (resourceDraft.structure[elementIndex].id === 'element_01')\n            elementIndex = resourceDraft.structure.findIndex(\n                item => item.id === 'element_1'\n            )\n\n        if (\n            resourceDraft.structure[elementIndex].path.length < 2 &&\n            !isEqual(resourceDraft.structure[elementIndex].path, ['element_02'])\n        )\n            putInside = true\n    } else if (type === 'page') {\n        putInside = onlyInside\n    }\n    const element = resourceDraft.structure[elementIndex]\n    if (element.isChildren) {\n        putInside = false\n    } else if (element.childrenTo) {\n        putInside = true\n    } else {\n        if (inside) putInside = true\n    }\n    if (inside || type === 'text' || onlyInside === 'inside') putInside = true\n    if (onlyInside === 'notInside') putInside = false\n\n    let draft = { currentId: resourceDraft.currentId }\n\n    const idMatch = {}\n    const newValuesElements = {}\n    const newChildren = sourceChildren\n        .map(item => {\n            let newItemId = `element${type === 'page' ? 'CMS' : ''}_${\n                draft.currentId\n            }`\n            draft.currentId += 1\n            idMatch[item.id] = newItemId\n            newValuesElements[newItemId] = state.clipboard.values[item.id]\n            return {\n                ...item,\n                id: newItemId,\n            }\n        })\n        .map(item => {\n            return {\n                ...item,\n\n                path: [\n                    ...element.path,\n                    ...(putInside ? [element.id] : []),\n                    ...item.path.map(pathItem => {\n                        if (idMatch[pathItem]) {\n                            return idMatch[pathItem]\n                        } else {\n                            return pathItem\n                        }\n                    }),\n                ],\n            }\n        })\n\n    draft = {\n        ...resourceDraft,\n        ...draft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex + 1),\n\n            ...newChildren,\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            ...newValuesElements,\n        },\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n\n/////////////////////OLDOLDOLDOLDOLD\n// export const changeElementStyleValue = (\n//     index: number,\n//     key: string,\n//     value: any,\n//     elementId: string\n// ) => ({\n//     type: actionTypes.CHANGE_ELEMENT_STYLE_VALUE,\n//     index,\n//     key,\n//     value,\n//     elementId,\n// })\n\n// export const addElementStyleValue = (index: number, elementId: string) => ({\n//     type: actionTypes.ADD_ELEMENT_STYLE_VALUE,\n//     index,\n//     elementId,\n// })\n\n// export const deleteElementStyleValue = (index: number, elementId: string) => ({\n//     type: actionTypes.DELETE_ELEMENT_STYLE_VALUE,\n//     index,\n//     elementId,\n// })\n\n// export const changeElementPropertyValue = (\n//     value: any,\n//     key: string,\n//     isSection?: boolean,\n//     isNotForHistory?: boolean\n// ) => ({\n//     type: actionTypes.CHANGE_ELEMENT_PROPERTY_VALUE,\n//     value,\n//     key,\n//     isSection,\n//     isNotForHistory,\n// })\n\n// export const builderZoomOut = () => ({ type: actionTypes.BUILDER_ZOOM_OUT })\n// export const builderZoomIn = () => ({ type: actionTypes.BUILDER_ZOOM_IN })\n// export const builderZoomReset = () => ({ type: actionTypes.BUILDER_ZOOM_RESET })\n\n// export const saveToHistory = () => ({ type: actionTypes.SAVE_TO_HISTORY })\n\n// export const loadCurrentPageToBuilder = (\n//     _id: ?string,\n//     resourcesObjects?: Object,\n//     pageObject?: Object\n// ) => ({\n//     type: actionTypes.LOAD_CURRENT_PAGE_TO_BUILDER,\n//     _id,\n//     resourcesObjects,\n//     pageObject,\n// })\n","import axios from 'axios'\nimport Cookies from 'universal-cookie'\nimport jwt from 'jsonwebtoken'\n\nimport * as actions from './index'\n\nimport cloneDeep from 'lodash/cloneDeep'\nimport { webSocket } from '../../components/ReserveWebsite/ReserveWebsite'\n\nconst cookies = new Cookies()\n\nexport const authStart = () => ({\n    type: 'AUTH_START',\n})\n\nexport const authSuccess = (data: Object) => ({\n    type: 'AUTH_SUCCESS',\n    data,\n})\n\nexport const authFail = (error: string) => ({\n    type: 'AUTH_FAIL',\n    error,\n})\n\nexport const deleteStart = () => ({\n    type: 'ACTION_START',\n})\n\nexport const deleteSuccess = () => ({\n    type: 'ACTION_SUCCESS',\n})\n\nexport const deleteFail = (error: string) => ({\n    type: 'ACTION_FAIL',\n    error,\n})\n\nexport const deleteUser = () => (dispatch: Object) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (window.confirm('Are you sure you would like to delete your account?'))\n        if (\n            window.confirm(\n                'This action cannot be reverted. All your websites will be deleted.'\n            )\n        )\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'deleteUser',\n                })\n            )\n}\n\nexport const logout = (all?: boolean) => (dispatch: Object) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (!all) {\n        cookies.remove('auth_token')\n        axios.defaults.headers.common['x-auth-token'] = null\n        dispatch(logoutDo())\n    } else {\n        if (webSocket) {\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'logoutAll',\n                })\n            )\n        }\n    }\n}\n\nconst logoutDo = () => ({\n    type: 'AUTH_LOGOUT',\n})\n\nexport const authCheckState = () => (dispatch: Object) => {\n    sessionStorage.setItem('systemRefresh', '0')\n    const tryWebsiter = cookies.get('try_websiter')\n    if (tryWebsiter) {\n        cookies.remove('try_websiter', {\n            path: '/',\n        })\n        sessionStorage.setItem('tryWebsiter', '1')\n        dispatch(\n            authSuccess({\n                _id: 'try',\n            })\n        )\n        return\n    }\n    const token = cookies.get('auth_token')\n    const rememberMe = cookies.get('rememberme')\n    if (rememberMe) {\n        cookies.remove('rememberme', {\n            path: '/',\n        })\n        if (rememberMe === 'false') {\n            cookies.remove('auth_token', {\n                path: '/',\n            })\n        }\n    }\n    const userId = jwt.decode(token)\n    axios.defaults.headers.post['Content-Type'] = 'application/json'\n    axios.defaults.headers.put['Content-Type'] = 'application/json'\n    axios.defaults.headers.delete['Content-Type'] = 'application/json'\n    axios.defaults.headers.common.Accept = 'application/json'\n\n    if (!token || !userId) {\n        dispatch(logout())\n    } else {\n        axios.defaults.headers.common['x-auth-token'] = token\n        axios.defaults.headers.post['x-auth-token'] = token\n        axios.defaults.headers.get['x-auth-token'] = token\n        axios.defaults.headers.delete['x-auth-token'] = token\n        axios.defaults.headers.put['x-auth-token'] = token\n        dispatch(authStart())\n        return axios\n            .get('/api/users')\n            .then(response => {\n                sessionStorage.removeItem('tryWebsiter')\n                dispatch(\n                    authSuccess({\n                        _id: userId._id,\n                    })\n                )\n            })\n            .catch(err => {\n                cookies.remove('auth_token', {\n                    path: '/',\n                })\n                dispatch(authFail(err.message))\n            })\n    }\n}\n\nexport const changeBarSizeDo = (key: string, value: number) => ({\n    type: 'CHANGE_BAR_SIZE',\n    key,\n    value,\n})\n\nexport const savePropertiesOnLeave = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter')) return\n    const { mD, barSizes } = getState()\n    webSocket.send(\n        JSON.stringify({\n            messageCode: 'saveSettings',\n            settings: {\n                ...mD.userObject.settings,\n                barSizes,\n            },\n        })\n    )\n}\n\nexport const changeBarSize = (initiator?: { key: string, value: number }) => (\n    dispatch: Object,\n    getState\n) => {\n    const { barSizes } = getState()\n    const width = Math.max(window.innerWidth, 700),\n        height = window.innerHeight\n    let value, dif, dif2, value2, value3\n\n    if (!initiator) {\n        if (barSizes.height > height - 50) {\n            dispatch(actions.changeBarSizeDo('height', height - 50))\n        }\n        if (barSizes.width > width - 100) {\n            dispatch(actions.changeBarSizeDo('width', width - 100))\n        }\n        if (barSizes.width + barSizes.width2 > width - 50) {\n            dispatch(\n                actions.changeBarSizeDo('width2', width - barSizes.width - 50)\n            )\n        }\n    } else {\n        switch (initiator.key) {\n            case 'height':\n                value = initiator.value\n                if (value < 50) value = 50\n                if (value > height - 50) value = height - 50\n                dispatch(actions.changeBarSizeDo('height', value))\n                break\n            case 'width':\n                value = initiator.value\n                if (value < 50) value = 50\n                dif = value - barSizes.width\n                value2 = barSizes.width2 - dif\n                value3 = barSizes.width3\n                if (value2 < 50) {\n                    dif2 = value2 - 50\n                    value2 = 50\n                    value3 = barSizes.width3 + dif2\n                    if (value3 < 50) value3 = 50\n                }\n                if (value + value2 + value3 + 50 > width) {\n                    value = width - 150\n                    value2 = 50\n                    value3 = 50\n                }\n                dispatch(actions.changeBarSizeDo('width', value))\n                dispatch(actions.changeBarSizeDo('width2', value2))\n                dispatch(actions.changeBarSizeDo('width3', value3))\n                break\n            case 'width2':\n                value2 = initiator.value\n                value = barSizes.width\n                dif = value2 - 50\n                if (dif < 0) {\n                    value = value + dif\n                    if (value < 50) value = 50\n                    dif2 = value - barSizes.width\n                    value3 = barSizes.width3 - dif2\n                    value2 = 50\n                }\n                dif = value + value2 - barSizes.width - barSizes.width2\n                value3 = barSizes.width3 - dif\n                if (value3 < 50) value3 = 50\n                if (value + value2 + value3 + 50 > width) {\n                    value2 = width - value - 100\n                }\n                dispatch(actions.changeBarSizeDo('width', value))\n                dispatch(actions.changeBarSizeDo('width2', value2))\n                dispatch(actions.changeBarSizeDo('width3', value3))\n                break\n            case 'width3':\n                value3 = initiator.value\n                value = barSizes.width\n                value2 = barSizes.width2\n                dif = value3 - 50\n                if (dif < 0) {\n                    value2 = value2 + dif\n                    dif2 = value2 - 50\n                    if (dif2 < 0) {\n                        value = value + dif2\n                        if (value < 50) value = 50\n                        value2 = 50\n                    }\n                    value3 = 50\n                }\n                if (value + value2 + value3 + 50 > width) {\n                    value3 = width - value - value2 - 50\n                }\n                dispatch(actions.changeBarSizeDo('width', value))\n                dispatch(actions.changeBarSizeDo('width2', value2))\n                dispatch(actions.changeBarSizeDo('width3', value3))\n                break\n            default:\n                break\n        }\n    }\n}\n","import cloneDeep from 'lodash/cloneDeep'\n\nexport const chooseWebsite = id => (dispatch, getState) => {\n    const { mD } = getState()\n    const userObject = cloneDeep(mD.userObject)\n    userObject.settings.currentWebsite = id\n    dispatch(saveObject(userObject))\n}\n\nexport const saveObject = data => ({\n    type: 'SAVE_OBJECT',\n    data,\n})\n\nexport const chooseUserInWebsiteSharing = (id: string) => ({\n    type: 'CHOOSE_USER_IN_WEBSITE_SHARING',\n    id,\n})\n\nexport const setSizeIsChanging = (isChanging: boolean) => ({\n    type: 'SIZE_IS_CHANGING',\n    isChanging,\n})\n\n// export const setCurrentTopTab = (currentTopTab: string) => ({\n//     type: 'SET_CURRENT_TOP_TAB',\n//     currentTopTab,\n// })\n\nexport const saveMainData = mD => ({\n    type: 'SAVE_MAIN_DATA',\n    mD,\n})\n","import * as actions from '.'\nimport * as wsActions from '../../websocketActions'\nimport { current } from '../../utils/resourceTypeIndex'\nimport cloneDeep from 'lodash/cloneDeep'\n\nexport const chooseResource = (\n    id: string,\n    resourceType: 'plugin' | 'page' | 'template'\n) => (dispatch, getState) => {\n    const { mD } = getState()\n    const userObject = cloneDeep(mD.userObject)\n    if (!userObject.settings.websites[userObject.settings.currentWebsite])\n        userObject.settings.websites[userObject.settings.currentWebsite] = {}\n\n    if (mD.globalSettingsPageId !== id && resourceType === 'page') {\n        userObject.settings.websites[\n            userObject.settings.currentWebsite\n        ].currentPageFSBId = id\n    }\n\n    userObject.settings.websites[userObject.settings.currentWebsite][\n        current[resourceType]\n    ] = id\n\n    dispatch(actions.saveObject(userObject))\n}\n\nexport const addResourceVersion = (\n    mD,\n    resourceType,\n    draft,\n    meta,\n    isNotForHistory?: boolean,\n    globalSettings\n) => ({\n    type: 'ADD_RESOURCE_VERSION',\n    mD,\n    resourceType,\n    draft,\n    meta,\n    isNotForHistory,\n    globalSettings,\n})\n\n// export const undoResourceVersion = () => ({\n//     type: 'UNDO_RESOURCE_VERSION',\n// })\n\n// export const redoResourceVersion = () => ({\n//     type: 'REDO_RESOURCE_VERSION',\n// })\n\nexport const setActiveContainer = container => ({\n    type: 'SET_ACTIVE_CONTAINER',\n    container,\n})\n\nexport const unsetActiveContainer = container => ({\n    type: 'UNSET_ACTIVE_CONTAINER',\n    container,\n})\n\nexport const removeResourceFromUnsaved = data => ({\n    type: 'REMOVE_RESOURCE_FROM_UNSAVED',\n    _id: data._id,\n})\n\nexport const removeResourceFromNewVersions = data => ({\n    type: 'REMOVE_RESOURCE_FROM_NEW_VERSIONS',\n    _id: data._id,\n})\n","import cloneDeep from 'lodash/cloneDeep'\nimport omit from 'lodash/omit'\nimport isEmpty from 'lodash/isEmpty'\n\nconst diffpatcher = require('jsondiffpatch/dist/jsondiffpatch.umd.js').create({\n    objectHash: obj => obj.id,\n    propertyFilter: (name, context) => name !== '__patch__',\n})\n\nexport const addResource = (data: Object) => (dispatch, getState) => {\n    dispatch(addResourceDo(data))\n}\n\nexport const addResourceDo = (data: Object) => ({\n    type: 'ADD_RESOURCE',\n    data,\n})\n\nexport const deleteResource = (data: Object) => ({\n    type: 'DELETE_RESOURCE',\n    data,\n})\n\nexport const revertResource = (data: Object) => ({\n    type: 'REVERT_RESOURCE',\n    data,\n})\n\nexport const updateUser = (data: Object, webSocket) => (dispatch, getState) => {\n    if (data) {\n        const { mD } = getState()\n        const currentUser = omit(\n            cloneDeep(mD.resourcesObjects[data.resourceId]),\n            ['settings']\n        )\n        if (currentUser) {\n            if (currentUser.__v === data.resource.__v - 1) {\n                currentUser.websites = diffpatcher.patch(\n                    currentUser.websites,\n                    data.resource.__patch__\n                )\n                currentUser.__v = data.resource.__v\n                dispatch(addResource(currentUser, mD))\n                return\n            }\n        }\n        requestResource(data.resource._id, data.type, webSocket)\n    }\n}\n\nexport const updateWebsite = (data: Object, webSocket) => (\n    dispatch,\n    getState\n) => {\n    if (data) {\n        const { mD } = getState()\n        const currentWebsite = cloneDeep(mD.resourcesObjects[data.resourceId])\n        if (currentWebsite) {\n            if (currentWebsite.__v === data.resource.__v - 1) {\n                const newWebsite = diffpatcher.patch(\n                    currentWebsite,\n                    data.resource.__patch__\n                )\n                newWebsite.__v = data.resource.__v\n                dispatch(addResource(newWebsite, mD))\n                return\n            }\n        }\n        requestResource(data.resource._id, data.type, webSocket)\n    }\n}\n\nexport const updateResource = (data: Object, webSocket) => (\n    dispatch,\n    getState\n) => {\n    if (data) {\n        const { mD } = getState()\n        const currentResource = cloneDeep(mD.resourcesObjects[data.resourceId])\n        if (currentResource) {\n            if (currentResource.__v === data.resource.__v - 1) {\n                if (!isEmpty(data.resource.__patch__)) {\n                    currentResource.draft = diffpatcher.patch(\n                        currentResource.draft,\n                        data.resource.__patch__\n                    )\n                }\n                currentResource.__v = data.resource.__v\n                dispatch(addResource(currentResource, mD))\n                return\n            }\n        }\n        requestResource(data.resource._id, data.type, webSocket)\n    }\n}\n\nconst requestResource = (id, type, webSocket) => {\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'requestResource',\n                id,\n                type,\n            })\n        )\n    }\n}\n","export {\n    chooseBox,\n    addBox,\n    deleteBox,\n    duplicateBox,\n    saveElementsStructure,\n    saveElementsStructureFromBuilder,\n    changeBoxPropertyInStructure,\n    changeBoxPropertyInValues,\n    hoverBox,\n    unhoverBox,\n    saveHoveredElementRect,\n    splitText,\n    textToSpan,\n    changeMenuItemProperty,\n    markRefreshing,\n    mergeBoxToPlugin,\n    dissolvePluginToBox,\n    toggleFindMode,\n    markShouldRefreshing,\n    setCurrentSiteBuilderMode,\n    parseHTML,\n    copyBox,\n    pasteBox,\n} from './builder'\n\nexport {\n    logout,\n    authCheckState,\n    deleteUser,\n    changeBarSize,\n    changeBarSizeDo,\n    savePropertiesOnLeave,\n} from './auth'\n\nexport {\n    setSizeIsChanging,\n    chooseWebsite,\n    // setCurrentTopTab,\n    chooseUserInWebsiteSharing,\n    saveObject,\n    saveMainData,\n} from './website'\n\nexport { uploadFile, deleteFile } from './files'\n\nexport {\n    chooseResource,\n    addResourceVersion,\n    // undoResourceVersion,\n    // redoResourceVersion,\n    removeResourceFromUnsaved,\n    removeResourceFromNewVersions,\n    setActiveContainer,\n    unsetActiveContainer,\n} from './resources'\n\nexport {\n    addResource,\n    updateUser,\n    updateWebsite,\n    updateResource,\n    deleteResource,\n    revertResource,\n} from './webSocket'\n","import axios from 'axios'\nimport { webSocket } from '../../components/ReserveWebsite/ReserveWebsite'\nimport * as wsActions from '../../websocketActions'\nimport buildRelUrls from '../../utils/buildRelUrls'\nimport FileType from 'file-type'\n\nconst actionStartImageUpload = () => ({\n    type: 'ACTION_START_IMAGE_UPLOAD',\n})\n\nconst actionSuccessImageUpload = () => ({\n    type: 'ACTION_SUCCESS_IMAGE_UPLOAD',\n})\n\nconst actionFailImageUpload = (error: string) => ({\n    type: 'ACTION_FAIL_IMAGE_UPLOAD',\n    error,\n})\n\nconst getSignedRequest = (files, replace, editorMode) => (\n    dispatch: Object,\n    getState\n) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    // const { file, thumbnail } = files\n    const file = files.file\n    const thumbnail = files.thumbnail\n    const resolution = files.resolution || {\n        width: 'unknown',\n        height: 'unknown',\n    }\n\n    const { mD } = getState()\n    if (!mD.currentWebsiteId) return\n    let name =\n        mD.currentWebsiteId +\n        '/' +\n        file.name.replace(/([^a-zA-Z0-9\\\\.\\\\-])/g, '_')\n\n    let namePrefix = ''\n    let k = 0\n\n    const checkName = () =>\n        mD.filesStructure.findIndex(\n            file => name + namePrefix === file.serverName\n        )\n    if (!replace) {\n        while (checkName() >= 0) {\n            k++\n            namePrefix = '_' + k\n        }\n    }\n\n    const fileDetails = {\n        size: file.size,\n        name: replace ? replace.name : file.name,\n        serverName: replace ? replace.serverName : name + namePrefix,\n        type: replace ? replace.type : files.type,\n        editorMode,\n        file,\n        v: replace ? replace.v + 1 : 1,\n        resolution,\n    }\n\n    const thumbnailDetails = thumbnail\n        ? {\n              size: thumbnail.size,\n              name: fileDetails.name + thumbnail.name,\n              serverName: fileDetails.serverName + thumbnail.name,\n              type: thumbnail.type,\n              editorMode,\n              file: thumbnail,\n          }\n        : {}\n    return axios\n        .post('/api/sign-s3', {\n            ...{\n                fileName: fileDetails.serverName,\n                fileType: fileDetails.type,\n                fileSize: fileDetails.size,\n                websiteId: mD.currentWebsiteId,\n            },\n            ...(thumbnail\n                ? {\n                      thumbnailName: thumbnailDetails.serverName,\n                      thumbnailType: thumbnailDetails.type,\n                      thumbnailSize: thumbnailDetails.size,\n                  }\n                : {}),\n        })\n        .then(response => {\n            dispatch(\n                doUploadFile(\n                    fileDetails,\n                    thumbnailDetails,\n                    response.data,\n                    mD.currentWebsiteId,\n                    replace\n                )\n            )\n        })\n        .catch(err => {\n            dispatch(actionFailImageUpload(err.message))\n            if (err.response.status === 400) alert(err.response.data)\n        })\n}\n\nconst doUploadFile = (\n    fileDetails,\n    thumbnailDetails,\n    data,\n    websiteId,\n    replace\n) => (dispatch: Object, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (data.signedRequestThumbnail && thumbnailDetails.file)\n        axios\n            .put(data.signedRequestThumbnail, thumbnailDetails.file, {\n                headers: {\n                    'Content-Type': 'multipart/form-data',\n                },\n            })\n            .then(response => {})\n            .catch(err => {\n                dispatch(actionFailImageUpload(err.message))\n                return\n            })\n    return axios\n        .put(data.signedRequest, fileDetails.file, {\n            headers: {\n                'Content-Type': 'multipart/form-data',\n            },\n        })\n        .then(response => {\n            if (webSocket) {\n                const { mD } = getState()\n                let result\n                const newFileItem = {\n                    id: replace ? replace.id : 'file_' + mD.nextFileId,\n                    path: replace ? replace.path : [],\n                    size: fileDetails.size + (thumbnailDetails.size || 0),\n                    name: fileDetails.name,\n                    serverName: fileDetails.serverName,\n                    type: fileDetails.type,\n                    editorMode: fileDetails.editorMode,\n                    url: data.url,\n                    v: fileDetails.v,\n                    resolution: fileDetails.resolution,\n                    modifiedDate: Date.now(),\n                }\n\n                if (mD.currentFileItem && mD.currentFileId) {\n                    if (!replace)\n                        result = [\n                            ...mD.filesStructure.slice(\n                                0,\n                                mD.filesStructure.findIndex(\n                                    item => item.id === mD.currentFileId\n                                ) + 1\n                            ),\n                            {\n                                ...newFileItem,\n                                path: mD.currentFileItem.path,\n                                createdDate: Date.now(),\n                            },\n                            ...mD.filesStructure.slice(\n                                mD.filesStructure.findIndex(\n                                    item => item.id === mD.currentFileId\n                                ) + 1\n                            ),\n                        ]\n                    else\n                        result = [\n                            ...mD.filesStructure.slice(\n                                0,\n                                mD.filesStructure.findIndex(\n                                    item => item.id === replace.id\n                                )\n                            ),\n                            {\n                                ...newFileItem,\n                                createdDate: replace.createdDate,\n                            },\n                            ...mD.filesStructure.slice(\n                                mD.filesStructure.findIndex(\n                                    item => item.id === replace.id\n                                ) + 1\n                            ),\n                        ]\n                } else {\n                    result = [\n                        ...mD.filesStructure,\n                        {\n                            ...newFileItem,\n                            createdDate: replace\n                                ? replace.createdDate\n                                : Date.now(),\n                        },\n                    ]\n                }\n\n                result = buildRelUrls(result)\n                dispatch(\n                    wsActions.sendUpdate(\n                        'website',\n                        {\n                            nextFileId: replace\n                                ? mD.nextFileId\n                                : mD.nextFileId + 1,\n                            filesStructure: result,\n                            storage: data.newStorage,\n                        },\n                        websiteId\n                    )\n                )\n            }\n            dispatch(actionSuccessImageUpload())\n        })\n        .catch(err => {\n            dispatch(actionFailImageUpload(err.message))\n        })\n}\n\nexport const uploadFile = (\n    files: Array<{ type: string; size: number; name: string }>,\n    replace: boolean,\n    editorMode: string,\n    isCreated?: boolean,\n    fileType?: string\n) => (dispatch: Object) => {\n    const file = files[0]\n\n    if (file == null) {\n        return alert('No file selected.')\n    }\n    dispatch(actionStartImageUpload())\n    const reader = new FileReader()\n    reader.onload = async event => {\n        let type = await FileType.fromBuffer(event.target.result)\n        type = type ? type.mime : isCreated ? 'text/css' : fileType || ''\n\n        if (type && type.indexOf('image') >= 0) {\n            resizeImageToSpecificSize(\n                file,\n                { width: 220, height: 220 },\n                data => {\n                    urltoFile(data, '/120').then(function(thumbnail) {\n                        getResolution(file, resolution => {\n                            dispatch(\n                                getSignedRequest(\n                                    { file, type, thumbnail, resolution },\n                                    replace,\n                                    editorMode\n                                )\n                            )\n                        })\n                    })\n                }\n            )\n        } else {\n            dispatch(getSignedRequest({ file, type }, replace, editorMode))\n        }\n    }\n\n    reader.readAsArrayBuffer(file)\n}\n\nexport const urltoFile = (url, filename, mimeType) => {\n    mimeType = mimeType || (url.match(/^data:([^;]+);/) || '')[1]\n    return fetch(url)\n        .then(function(res) {\n            return res.arrayBuffer()\n        })\n        .then(function(buf) {\n            return new File([buf], filename, { type: mimeType })\n        })\n}\n\nexport const resizeImageToSpecificSize = (file, size, cb) => {\n    if (file) {\n        var reader = new FileReader()\n        reader.onload = function(event) {\n            resizeImageFromSrcToSpecificSize(event.target.result, size, cb)\n        }\n        reader.readAsDataURL(file)\n    }\n}\n\nexport const resizeImageFromSrcToSpecificSize = (src, size, cb) => {\n    var data\n    var img = new Image()\n    img.onload = function() {\n        const widthCoef = img.width / size.width\n        const heightCoef = img.height / size.height\n        var oc = document.createElement('canvas'),\n            octx = oc.getContext('2d')\n        oc.width = img.width\n        oc.height = img.height\n        octx.drawImage(img, 0, 0)\n        if (widthCoef > 1 || heightCoef > 1) {\n            if (img.width > img.height) {\n                oc.height = (img.height / img.width) * size.width\n                oc.width = size.width\n            } else {\n                oc.width = (img.width / img.height) * size.width\n                oc.height = size.width\n            }\n        }\n        octx.drawImage(oc, 0, 0, oc.width, oc.height)\n        octx.drawImage(img, 0, 0, oc.width, oc.height)\n        data = oc.toDataURL()\n        cb(data)\n    }\n    img.src = src\n}\n\nconst getResolution = (file, cb) => {\n    var _URL = window.URL || window.webkitURL\n    var img\n    if (file) {\n        img = new Image()\n        var objectUrl = _URL.createObjectURL(file)\n        img.onload = function() {\n            cb({ width: this.width, height: this.height })\n            _URL.revokeObjectURL(objectUrl)\n        }\n        img.src = objectUrl\n    }\n}\n\nexport const deleteFile = fileId => (dispatch: Object, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (\n        window.confirm(\n            'Are you sure you want to delete this file? The file will be unavailable after the deletion and will not be visible in all elements and on all pages of your websites.'\n        )\n    ) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'deleteImage',\n                fileId,\n                _id: mD.currentWebsiteId,\n            })\n        )\n    }\n}\n","import { checkIfCapital } from './basic'\n\nexport default (props, item, values, mode, isFromBuffer) => {\n    if (props) {\n        item = props.resourceDraftStructure.find(\n            item => item.id === props.currentBox\n        )\n        if (item) values = props.resourceDraftValues[item.id]\n        mode = props.mode\n    }\n    let currentBoxType\n    if (item) {\n        if (mode === 'page') {\n            if (item.CMSVariableType) {\n                currentBoxType =\n                    item.CMSVariableType.indexOf('propagating_') >= 0\n                        ? 'isFromPropagatingPlugin'\n                        : 'isElementFromCMSVariable'\n            } else {\n                currentBoxType = 'isElementFromCMSVariable'\n            }\n        } else {\n            if (item.path.length === 0 && !isFromBuffer) {\n                if (item.id === 'trash') currentBoxType = 'trash'\n                else if (item.id === 'element_02') currentBoxType = 'CMSRoute'\n                else currentBoxType = 'html'\n            } else if (\n                item.path.length === 1 &&\n                !isFromBuffer &&\n                mode !== 'plugin'\n            ) {\n                currentBoxType = 'headBody'\n            } else if (checkIfCapital(item.tag.charAt(0))) {\n                currentBoxType = 'plugin'\n            } else if (item.text) {\n                currentBoxType = 'text'\n            } else {\n                currentBoxType = 'element'\n            }\n            if (item.isChildren) {\n                currentBoxType = 'children'\n            }\n            if (item.childrenTo) {\n                currentBoxType = 'childrenTo'\n            }\n            if (item.isCMSVariable) {\n                currentBoxType = 'isCMSVariable'\n            }\n            if (item.isElementFromCMSVariable) {\n                currentBoxType =\n                    values.CMSVariableType.indexOf('propagating_') >= 0\n                        ? 'isFromPropagatingPlugin'\n                        : 'isElementFromCMSVariable'\n            }\n        }\n    } else {\n        currentBoxType = 'none'\n    }\n    return currentBoxType\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Container\":\"Auth_Container__KMvOh\",\"socialButtons\":\"Auth_socialButtons__37I7_\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Cover\":\"Spinner_Cover__3iRbu\"};","import throttle from 'lodash.throttle'\n\nexport const CANCEL = 'redux-throttle/CANCEL'\nexport const FLUSH = 'redux-throttle/FLUSH'\n\nfunction map(throttled, action, method) {\n    if (action.payload && action.payload.type) {\n        let types = action.payload.type\n        if (!Array.isArray(types)) {\n            types = [types]\n        }\n        Object.keys(throttled)\n            .filter(t => types.includes(t))\n            .forEach(t => throttled[t][method]())\n        return\n    }\n    Object.keys(throttled).forEach(t => throttled[t][method]())\n    return\n}\n\nexport default function middleware(\n    defaultWait = 300,\n    defaultThrottleOption = {}\n) {\n    const throttled = {}\n    return store => next => action => {\n        if (action.type === CANCEL) {\n            map(throttled, action, 'cancel')\n            return next(action)\n        }\n\n        if (action.type === FLUSH) {\n            map(throttled, action, 'flush')\n            return next(action)\n        }\n\n        const shouldThrottle = (action.meta || {}).throttle\n\n        if (!shouldThrottle) {\n            return next(action)\n        }\n\n        if (throttled[action.type]) {\n            return throttled[action.type](action)\n        }\n\n        let wait = defaultWait\n        let options = defaultThrottleOption\n\n        if (!isNaN(shouldThrottle) && shouldThrottle !== true) {\n            wait = shouldThrottle\n        } else if (typeof shouldThrottle === 'object') {\n            wait = shouldThrottle.wait || defaultWait\n            options = { ...defaultThrottleOption, ...shouldThrottle }\n        }\n\n        throttled[action.type] = throttle(next, wait, options)\n\n        return throttled[action.type](action)\n    }\n}\n","import React, { Component } from 'react'\nimport { Redirect } from 'react-router-dom'\nimport { connect } from 'react-redux'\n\nimport * as actions from '../../../store/actions/index'\n\n// type Props = {\n//     onLogout: () => {},\n// }\n\nclass Logout extends Component {\n    componentDidMount() {\n        this.props.onLogout()\n    }\n\n    render() {\n        return <Redirect to=\"/login\" />\n    }\n}\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        onLogout: () => dispatch(actions.logout()),\n    }\n}\n\nexport default connect(\n    null,\n    mapDispatchToProps\n)(Logout)\n","import React, { Component } from 'react'\n\n// type Props = {}\n\n// type State = {\n//     component: Object | null,\n// }\n\nconst asyncComponent = importComponent => {\n    return class extends Component {\n        state = {\n            component: null,\n        }\n\n        componentDidMount() {\n            importComponent().then(cmp => {\n                this.setState({ component: cmp.default })\n            })\n        }\n\n        render() {\n            const C = this.state.component\n            return C ? <C {...this.props} /> : <div>Loading...</div>\n        }\n    }\n}\n\nexport default asyncComponent\n","import React, { useState, useEffect } from 'react'\n\nimport Checkbox from 'antd/es/checkbox'\nimport Cookies from 'universal-cookie'\nimport Button from 'antd/es/button'\nimport classes from './Auth.module.css'\nimport Svg from '../../components/Svg/Svg'\n\nconst cookies = new Cookies()\n\nconst Auth = () => {\n    const [state, setState] = useState(false)\n    const [cookieConsent, setCookieConsent] = useState(false)\n\n    useEffect(() => {\n        checkCookieConsent()\n    })\n\n    let remeberMeParam = '?rememberme=false'\n    if (state) {\n        remeberMeParam = '?rememberme=true'\n    }\n\n    const checkCookieConsent = () => {\n        const cookiesConsent = cookies.get('cookies_consent')\n        if (cookiesConsent) {\n            setCookieConsent(true)\n        }\n    }\n\n    const agreeWithCookies = () => {\n        cookies.set('cookies_consent', 'true', {\n            path: '/',\n            maxAge: 31530000,\n        })\n        checkCookieConsent()\n    }\n    const basicURL =\n        process.env.NODE_ENV !== 'development'\n            ? 'https://my.websiter.dev/api/auth/'\n            : 'http://my.websiter.test:5000/api/auth/'\n    return (\n        <div className={classes.Container}>\n            {!cookieConsent ? (\n                <>\n                    <div>\n                        We use cookies only for login purposes. In order to\n                        proceed you need to agree with the use of cookies.\n                    </div>\n                    <Button onClick={agreeWithCookies}>Agree</Button>\n                    <Button\n                        onClick={() => {\n                            window.open('https://websiter.dev', '_self')\n                        }}\n                    >\n                        Return to the homepage\n                    </Button>\n                </>\n            ) : (\n                <>\n                    <h1>Continue with:</h1>\n                    <div className={classes.socialButtons}>\n                        <a href={basicURL + `google/start${remeberMeParam}`}>\n                            <Svg icon='<svg width=\"50\" height=\"50\" viewBox=\"0 0 24 24\"><path fill=\"#4285F4\" d=\"M12.24 10.285V14.4h6.806c-.275 1.765-2.056 5.174-6.806 5.174-4.095 0-7.439-3.389-7.439-7.574s3.345-7.574 7.439-7.574c2.33 0 3.891.989 4.785 1.849l3.254-3.138C18.189 1.186 15.479 0 12.24 0c-6.635 0-12 5.365-12 12s5.365 12 12 12c6.926 0 11.52-4.869 11.52-11.726 0-.788-.085-1.39-.189-1.989H12.24z\"></path></svg>' />\n                            <div>GOOGLE</div>\n                        </a>\n                        <a href={basicURL + `facebook/start${remeberMeParam}`}>\n                            <Svg icon='<svg width=\"50\" height=\"50\" viewBox=\"0 0 24 24\"><path fill=\"#1877F2\" d=\"M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z\"></path></svg>' />\n                            <div>FACEBOOK</div>\n                        </a>\n                        {/* <a href={basicURL + `twitter/start${remeberMeParam}`}>\n                            <Svg icon='<svg width=\"50\" height=\"50\" viewBox=\"0 0 24 24\"><path fill=\"#1DA1F2\" d=\"M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z\"></path></svg>' />\n                            <div>TWITTER</div>\n                        </a> */}\n                        <a href={basicURL + `github/start${remeberMeParam}`}>\n                            <Svg icon='<svg width=\"50\" height=\"50\" viewBox=\"0 0 16 16\"><path fill=\"#333\" d=\"M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z\"></path></svg>' />\n                            <div>GITHUB</div>\n                        </a>\n                    </div>\n                    <Checkbox checked={state} onChange={() => setState(!state)}>\n                        Remember me\n                    </Checkbox>\n                </>\n            )}\n        </div>\n    )\n}\nexport default Auth\n","import React from 'react'\nimport classes from './Spinner.module.css'\nimport Spin from 'antd/es/spin'\nimport LoadingOutlined from '@ant-design/icons/LoadingOutlined'\n// type Props = {\n//     cover?: boolean,\n//     datatestid?: string,\n// }\n\nconst spinner = props => {\n    const spiningIcon = (\n        <Spin\n            indicator={<LoadingOutlined style={{ fontSize: 74 }} spin />}\n            tip=\"Loading...\"\n        />\n    )\n\n    return props.cover ? (\n        <div\n            className={classes.Cover}\n            data-testid={props.datatestid || 'cover'}\n        >\n            {spiningIcon}\n        </div>\n    ) : (\n        spiningIcon\n    )\n}\n\nexport default spinner\n","import React, { Component } from 'react'\nimport { Route, Switch, withRouter, Redirect } from 'react-router-dom'\nimport { connect } from 'react-redux'\n\nimport Logout from './containers/Auth/Logout/Logout'\nimport asyncComponent from './hoc/asyncComponent'\nimport * as actions from './store/actions/index'\nimport Auth from './containers/Auth/Auth'\nimport Spinner from './components/UI/Spinner/Spinner'\nimport { initialState, initialStateType } from './store/reducer/reducer'\nimport './components/UI/loadStyles'\n\nconst asyncSiteBuilderLayout = asyncComponent(() => {\n    return import('./containers/SiteBuilderLayout/SiteBuilderLayout')\n})\n\ntype Props = {\n    onTryAutoSignup: Function\n    isAuthenticated: boolean\n    loading: typeof initialState.loading\n}\n\nclass App extends Component<Props> {\n    componentDidMount() {\n        this.props.onTryAutoSignup()\n    }\n\n    render() {\n        let routes = (\n            <Switch>\n                <Route path=\"/login\" component={Auth} />\n                <Redirect to=\"/login\" />\n            </Switch>\n        )\n        if (this.props.isAuthenticated) {\n            routes = (\n                <div style={{ height: '100%' }}>\n                    <Switch>\n                        <Route\n                            path=\"/editor\"\n                            component={asyncSiteBuilderLayout}\n                        />\n                        <Route path=\"/logout\" component={Logout} />\n                        <Redirect to=\"/editor\" />\n                    </Switch>\n                </div>\n            )\n        }\n        return (\n            <>\n                {routes} {this.props.loading && <Spinner cover />}\n            </>\n        )\n    }\n}\n\nconst mapStateToProps = (state: initialStateType) => {\n    return {\n        isAuthenticated: state.userId !== null,\n        loading: state.loading,\n    }\n}\n\nconst mapDispatchToProps = (dispatch: any) => {\n    return {\n        onTryAutoSignup: () => dispatch(actions.authCheckState()),\n    }\n}\n\nexport default withRouter(\n    connect(\n        mapStateToProps,\n        mapDispatchToProps\n    )(App)\n)\n","import isEqual from 'lodash/isEqual'\nimport omit from 'lodash/omit'\n\nexport default (draft1, draft2) =>\n    isEqual(\n        {\n            structure: draft1.structure.map(item =>\n                omit(item, ['expanded', 'children', 'itemPath', 'itemIndex'])\n            ),\n            values: draft1.values,\n        },\n        {\n            structure: draft2.structure.map(item =>\n                omit(item, ['expanded', 'children', 'itemPath', 'itemIndex'])\n            ),\n            values: draft2.values,\n        }\n    )\n","import {\n    structure,\n    current,\n    resourceObjectIndex,\n} from '../../utils/resourceTypeIndex'\nimport cloneDeep from 'lodash/cloneDeep'\nimport isEqual from 'lodash/isEqual'\nimport { checkIfCapital } from '../../utils/basic'\nimport resourcesAreEqual from '../../utils/resourcesAreEqual'\n\nconst diffpatcher = require('jsondiffpatch/dist/jsondiffpatch.umd.js').create({\n    objectHash: obj => obj.id,\n    propertyFilter: (name, context) => name !== '__patch__',\n})\n\nconst patchStructure = (state: Object, action: Object) => {\n    return diffpatcher.patch(\n        state[structure[action.resourceType]],\n        action.structurePatch\n    )\n}\n\nexport const addResourceSuccess = (state: Object, action: Object) => {\n    state[structure[action.resourceType]] = patchStructure(state, action)\n    state.resourcesObjects[action._id] = action.resource\n}\n\nexport const deleteResourceSuccess = (state: Object, action: Object) => {\n    action.deletedResources.forEach(id => delete state.resourcesObjects[id])\n    state[structure[action.resourceType]] = patchStructure(state, action)\n    state[current[action.resourceType]] = action.current || ''\n}\n\nexport const setCurrentResource = (state: Object, action: Object) => {\n    state.resourcesObjects[action.mD.currentWebsiteId][\n        current[action.resourceType]\n    ] = action._id\n    if (action.resourceType === 'page') {\n        state.hoveredElementSize = {}\n    }\n}\n\nexport const saveResourcesStructureSuccess = (\n    state: Object,\n    action: Object\n) => {\n    state[structure[action.resourceType]] = action.structure\n}\n\nexport const removeResourceFromUnsaved = (state: Object, action: Object) => {\n    state.notSavedResources = state.notSavedResources.filter(\n        item => item !== action._id\n    )\n}\n\nexport const addResourceToUnsaved = (state: Object, action: Object) => {\n    if (!state.notSavedResources.includes(action._id))\n        state.notSavedResources.push(action._id)\n}\n\nexport const removeResourceFromNewVersions = (\n    state: Object,\n    action: Object\n) => {\n    state.newVersionResources = state.newVersionResources.filter(\n        item => item !== action._id\n    )\n}\n\nexport const addResourceToNewVersions = (state: Object, action: Object) => {\n    if (!state.newVersionResources.includes(action._id))\n        state.newVersionResources.push(action._id)\n}\n\nexport const savePageInState = (state: Object, action: Object) => ({\n    ...state,\n    resourcesObjects: {\n        ...state.resourcesObjects,\n        [state.currentPage]: {\n            ...state.resourcesObjects[state.currentPage],\n            content: action.value,\n        },\n    },\n})\n\nexport const saveResourceDraftInState = (state: Object, action: Object) => {\n    state.resourcesObjects[action.currentResource].draft = action.draft\n}\n\nexport const saveResourceInState = (state: Object, action: Object) => {\n    state.resourcesObjects[action.currentResource].draft = action.draft\n    state.resourcesObjects[action.currentResource].present = action.draft\n    state.notSavedResources = state.notSavedResources.filter(\n        item => item !== action.currentResource\n    )\n}\n\nexport const addResourceVersion = (state: Object, action: Object) => {\n    const resource = cloneDeep(\n        action.globalSettings\n            ? action.mD.globalSettingsPageObject\n            : action.mD[resourceObjectIndex[action.resourceType]]\n    )\n    if (!isEqual(resource.present, action.draft)) {\n        if (action.isNotForHistory) {\n            resource.present = action.draft\n            state.resourcesObjects[resource._id] = resource\n        } else {\n            const newDraft = { ...action.draft }\n            if (\n                action.draft.structure &&\n                ['template', 'plugin'].includes(action.resourceType)\n            ) {\n                const connectedResources = []\n                action.draft.structure.forEach(item => {\n                    if (item.tag.length > 0 && item.path.length > 0) {\n                        if (\n                            checkIfCapital(item.tag.charAt(0)) &&\n                            !item.childrenTo &&\n                            !item.isChildren &&\n                            !item.isElementFromCMSVariable\n                        ) {\n                            connectedResources.push({\n                                name: item.tag,\n                                type: 'plugin',\n                            })\n                        }\n                    }\n                })\n                newDraft.connectedResources = connectedResources\n\n                // let resource =\n                //     state.resourcesObjects[\n                //         state.resourcesObjects[state.userId].loadedWebsite\n                //     ].templatesStructure.find(\n                //         item => item.id === action.currentResource\n                //     ) ||\n                //     state.pluginsStructure.find(\n                //         item => item.id === action.currentResource\n                //     )\n                // if (resource) {\n                //     resource.connectedResources = connectedResources\n                // }\n            }\n            const currentResourceId = action.globalSettings\n                ? action.mD.globalSettingsPageId\n                : action.mD[current[action.resourceType]]\n            if (\n                !resourcesAreEqual(\n                    resource.present.structure\n                        ? resource.present\n                        : resource.draft,\n                    newDraft\n                )\n            ) {\n                if (!state.notSavedResources.includes(currentResourceId))\n                    state.notSavedResources.push(currentResourceId)\n            }\n            // if (resource.past.length > 5) resource.past.shift()\n            // resource.past.push(diffpatcher.diff(resource.present, newDraft))\n            resource.present = newDraft\n            resource.future = []\n            state.resourcesObjects[resource._id] = resource\n        }\n    }\n}\n\n// export const undoResourceVersion = (state: Object, action: Object) => {\n//     const currentResource = state[current[state.currentTopTab]]\n//     const resource = state.resourcesObjects[currentResource]\n//     if (resource) {\n//         if (resource.past.length > 0) {\n//             if (\n//                 !isEqual(\n//                     resource.present,\n//                     resource.past[resource.past.length - 1]\n//                 )\n//             ) {\n//                 if (!state.notSavedResources.includes(action.currentResource))\n//                     state.notSavedResources.push(action.currentResource)\n//             } else {\n//                 state.notSavedResources = state.notSavedResources.filter(\n//                     item => item !== action.currentResource\n//                 )\n//             }\n\n//             const delta = resource.past.pop()\n//             resource.future.unshift(delta)\n//             resource.present = diffpatcher.unpatch(resource.present, delta)\n//         }\n//     }\n// }\n\n// export const redoResourceVersion = (state: Object, action: Object) => {\n//     const currentResource = state[current[state.currentTopTab]]\n//     const resource = state.resourcesObjects[currentResource]\n//     if (resource) {\n//         if (resource.future.length > 0) {\n//             if (!isEqual(resource.present, resource.future[0])) {\n//                 if (!state.notSavedResources.includes(action.currentResource))\n//                     state.notSavedResources.push(action.currentResource)\n//             } else {\n//                 state.notSavedResources = state.notSavedResources.filter(\n//                     item => item !== action.currentResource\n//                 )\n//             }\n\n//             const delta = resource.future.shift()\n//             resource.past.push(delta)\n//             resource.present = diffpatcher.patch(resource.present, delta)\n//         }\n//     }\n// }\n","import * as auth from './auth'\nimport * as images from './images'\nimport * as resources from './resources'\nimport { createReducer } from '@reduxjs/toolkit'\nimport resourcesAreEqual from '../../utils/resourcesAreEqual'\n\nexport type menuItemType = {\n    all: boolean\n    id: string\n    generatedFrom: string\n    sourceItem: boolean\n    name: string\n    type: string\n    path: Array<string>\n    properties: {\n        url: string\n        class: string\n    }\n}\n\nexport type requiredRightsType = Array<string>\n\nexport type elementType = {\n    id: string\n    path: Array<string>\n    tag: string\n    properties: {\n        name?: string\n        topMenuBlockClasses?: Array<string>\n        topMenuItemClasses?: Array<string>\n        topMenuItemActiveClasses?: Array<string>\n        popupMenuBlockClasses?: Array<string>\n        popupMenuItemClasses?: Array<string>\n        popupMenuItemActiveClasses?: Array<string>\n        mode?: 'horizontal' | 'vertical'\n        trigger?: 'click'\n        id?: string\n        class?: string\n    }\n    propertiesString: string\n    style?: string\n    expanded?: boolean\n    textMode: string\n    cursorPosition?: {\n        row: number\n        column: number\n    }\n    text?: boolean\n    textContent?: string\n    isChildren?: boolean\n    childrenTo?: string\n    forPlugin?: string\n    sourcePlugin?: string\n    menuItems?: Array<menuItemType>\n    currentMenuItem?: string\n    children?: Array<elementType>\n    isElementFromCMSVariable?: boolean\n    isCMSVariable?: boolean\n    CMSVariableType?: string\n    CMSVariableSystemName?: string\n    CMSVariableDescription?: string\n    CMSVariableDefaultValue?: any\n    currentMenuId?: string\n    defaultMenuItems?: Array<menuItemType>\n    value?: any\n}\nexport type resourceType = {\n    currentId: number\n    structure: Array<elementType>\n    currentBox?: string\n    cursorPosition?: {\n        row: number\n        column: number\n    }\n    value?: string\n}\n\nexport type pageType = {\n    id: string\n    path: Array<string>\n    name: string\n    url: string\n    template: string\n    homepage: boolean\n    hidden: boolean\n    notPublished: boolean\n    connectedResources: {\n        name: string\n        type: string\n    }\n}\n\nexport type pluginType = {\n    id: string\n    path: Array<string>\n    name: string\n    url: string\n    template: string\n    homepage: boolean\n    notPublished: boolean\n    hidden: boolean\n    connectedResources: {\n        name: string\n        type: string\n    }\n}\n\nexport type templateType = {\n    id: string\n    path: Array<string>\n    name: string\n    url: string\n    template: string\n    homepage: boolean\n    notPublished: boolean\n    hidden: boolean\n    connectedResources: {\n        name: string\n        type: string\n    }\n}\n\nexport type imageType = {\n    name: string\n    label: string\n    url: string\n    size: number\n}\nexport type websiteType = {\n    _id: string\n    domain: string\n    name: string\n    customDomain?: string\n    domainHidden?: boolean\n    customDomainHidden?: boolean\n    customDomainVerified?: boolean\n    verifyCode?: string\n    cname?: string\n    domainNoIndex?: boolean\n    sharing: Array<{\n        userId: string\n        rights: Array<string>\n    }>\n    user: string\n    storage: number\n    images: Array<imageType>\n}\n\nexport interface initialStateType {\n    websites: Array<websiteType>\n    resourcesObjects: {\n        [key: string]: {\n            draft: resourceType\n            present: resourceType\n            future: Array<resourceType>\n            past: Array<resourceType>\n        }\n    }\n    pagesStructure: Array<pageType>\n    pluginsStructure: Array<pluginType>\n    templatesStructure: Array<templateType>\n    loadedWebsite: string\n    error: null | {}\n    loading: boolean\n    currentPage: string\n    currentPlugin: string\n    currentTemplate: string\n    domainNotOk: boolean\n    customDomainNotOk: boolean\n    maxStorage: number\n    uploadingImage: boolean\n    currentBoxInPlugin: string\n    currentImage: string\n    sizeIsChanging: boolean\n    currentWebsite: string\n    notSavedResources: Array<string>\n    pageZoom: number\n    hoveredElementId: null | string\n    hoveredElementSize: {\n        [key: string]: {\n            children: {}\n            left: number\n            top: number\n            width: number\n            height: number\n        }\n    }\n    isRefreshing: boolean\n    userId: null | string\n    barSizes: { height: number; width: number; width2: number; width3: number }\n    // currentTopTab: string,\n    findMode: null | string\n    hoverMode: string\n    fromFrame: boolean\n    search: {}\n    tryWebsiter: boolean\n    currentUserInWebsiteSharing: string\n    currentSiteBuilderMode: 'template' | 'page' | ''\n    accountInfo: {\n        displayName?: string\n        emails?: Array<string>\n        photos?: Array<string>\n    }\n}\n\nexport const initialState = {\n    resourcesObjects: {},\n    error: null,\n    loading: false,\n    domainNotOk: false,\n    customDomainNotOk: false,\n    maxStorage: 0,\n    uploadingImage: false,\n    currentBoxInPlugin: '',\n    currentImage: '',\n    sizeIsChanging: false,\n    notSavedResources: [],\n    newVersionResources: [],\n    pageZoom: 100,\n    hoveredElementId: null,\n    hoveredElementSize: {},\n    isRefreshing: false,\n    userId: null,\n    barSizes: {\n        height: 200,\n        width: 400,\n        width2: 200,\n        width3: 200,\n    },\n    // currentTopTab: 'page',\n    findMode: null,\n    hoverMode: '',\n    fromFrame: false,\n    search: {},\n    shouldRefresh: false,\n    tryWebsiter: false,\n    currentUserInWebsiteSharing: '',\n    // currentSiteBuilderMode: '',\n    mD: {},\n    activeContainer: '',\n    clipboard: {},\n}\n\nconst saveHoveredElementRect = (state, action) => {\n    const checkAndCreatePath = (path, index, parent) => {\n        if (index < path.length - 1) {\n            if (!parent[path[index].id]) {\n                parent[path[index].id] = {\n                    plugin: path[index].plugin,\n                    children: {},\n                }\n            }\n            checkAndCreatePath(\n                action.path,\n                index + 1,\n                parent[path[index].id].children\n            )\n        } else {\n            parent[path[index].id] = {\n                plugin: path[index].plugin,\n                children: {},\n                ...action.size,\n            }\n        }\n    }\n    if (action.path.length > 0)\n        checkAndCreatePath(action.path, 0, state.hoveredElementSize)\n}\n\nconst removeFromHoveredSizes = (state, action) => {\n    // ,\n    // removedElements,\n    const checkAndRemoveElement = parent => {\n        for (const item in parent) {\n            if (parent[item].plugin === action.currentResource) {\n                for (const child in parent[item].children) {\n                    if (action.removedElements.includes(child))\n                        delete parent[item].children[child]\n                }\n            } else {\n                checkAndRemoveElement(parent.children)\n            }\n        }\n    }\n    checkAndRemoveElement(state.hoveredElementSize)\n}\n\nconst toggleFindMode = (state, action) => {\n    if (action.value) {\n        if (state.findMode === action.value) {\n            state.findMode = null\n        } else {\n            state.findMode = action.value\n        }\n    } else {\n        state.findMode = null\n    }\n}\n\nconst reducer = createReducer(initialState, {\n    REMOVE_RESOURCE_FROM_UNSAVED: (state, action) =>\n        resources.removeResourceFromUnsaved(state, action),\n    REMOVE_RESOURCE_FROM_NEW_VERSIONS: (state, action) =>\n        resources.removeResourceFromNewVersions(state, action),\n    ACTION_START_IMAGE_UPLOAD: (state, action) =>\n        images.actionStartImageUpload(state),\n    ACTION_FAIL_IMAGE_UPLOAD: (state, action) =>\n        images.actionFailImageUpload(state, action),\n    ACTION_SUCCESS_IMAGE_UPLOAD: (state, action) =>\n        images.actionSuccessImageUpload(state),\n    CHOOSE_IMAGE: (state, action) => images.chooseImage(state, action),\n\n    SIZE_IS_CHANGING: (state, action) => {\n        state.sizeIsChanging = action.isChanging\n    },\n    ACTION_START: (state, action) => {\n        state.error = null\n        state.pagesLoading = true\n    },\n    ACTION_FAIL: (state, action) => {\n        state.error = action.error\n        state.pagesLoading = false\n    },\n    ACTION_SUCCESS: (state, action) => {\n        state.error = null\n        state.pagesLoading = false\n    },\n\n    ADD_RESOURCE_VERSION: (state, action) =>\n        resources.addResourceVersion(state, action),\n    // UNDO_RESOURCE_VERSION: (state, action) =>\n    //     resources.undoResourceVersion(state, action),\n    // REDO_RESOURCE_VERSION: (state, action) =>\n    //     resources.redoResourceVersion(state, action),\n\n    AUTH_START: (state, action) => auth.authStart(state),\n    AUTH_SUCCESS: (state, action) => auth.authSuccess(state, action),\n    AUTH_FAIL: (state, action) => auth.authFail(state, action),\n    AUTH_LOGOUT: (state, action) => auth.authLogout(state),\n    CHANGE_BAR_SIZE: (state, action) => auth.changeBarSize(state, action),\n    // SET_CURRENT_TOP_TAB: (state, action) => {\n    //     state.currentTopTab = action.currentTopTab\n    // },\n\n    SAVE_HOVERED_ELEMENT_RECT: (state: Object, action: Object) =>\n        saveHoveredElementRect(state, action),\n    REMOVE_FROM_HOVERED_SIZES: (state: Object, action: Object) =>\n        removeFromHoveredSizes(state, action),\n    HOVER_ELEMENT: (state: Object, action: Object) => {\n        state.hoveredElementId = action.id\n        state.hoverMode = action.mode\n        state.fromFrame = action.fromFrame\n    },\n    UNHOVER_ELEMENT: (state: Object, action: Object) => {\n        state.hoveredElementId = null\n        state.fromFrame = false\n    },\n    TOGGLE_FIND_MODE: (state: Object, action: Object) =>\n        toggleFindMode(state, action),\n    MARK_REFRESHING: (state: Object, action: Object) => {\n        state.isRefreshing = action.refreshing\n    },\n    MARK_SHOULD_REFRESHING: (state: Object, action: Object) => {\n        state.shouldRefresh = action.value\n    },\n    CHOOSE_USER_IN_WEBSITE_SHARING: (state: Object, action: Object) => {\n        state.currentUserInWebsiteSharing = action.id\n    },\n    SET_CURRENT_SITEBUILDER_MODE: (state: Object, action: Object) => {\n        state.currentSiteBuilderMode = action.mode\n    },\n    SAVE_MAIN_DATA: (state: Object, action: Object) => {\n        state.mD = action.mD\n    },\n    //ws\n    ADD_RESOURCE: (state: Object, action: Object) => {\n        const { mD } = state\n        if (action.data) {\n            if (action.data._id) {\n                if (mD.resourcesObjects[action.data._id]) {\n                    if (mD.resourcesObjects[action.data._id].draft) {\n                        state.resourcesObjects[action.data._id] = {\n                            ...mD.resourcesObjects[action.data._id],\n                            draft: action.data.draft,\n                            __v: action.data.__v,\n                        }\n                        let saved\n                        if (\n                            !mD.resourcesObjects[action.data._id].present\n                                .structure\n                        )\n                            saved = true\n                        else\n                            saved = resourcesAreEqual(\n                                action.data.draft,\n                                mD.resourcesObjects[action.data._id].present\n                            )\n\n                        if (saved) {\n                            resources.removeResourceFromUnsaved(state, {\n                                _id: action.data._id,\n                            })\n                            resources.removeResourceFromNewVersions(state, {\n                                _id: action.data._id,\n                            })\n                        } else {\n                            resources.addResourceToUnsaved(state, {\n                                _id: action.data._id,\n                            })\n                            resources.addResourceToNewVersions(state, {\n                                _id: action.data._id,\n                            })\n                        }\n                    } else {\n                        state.resourcesObjects[action.data._id] = {\n                            ...state.resourcesObjects[action.data._id],\n                            ...action.data,\n                        }\n                    }\n                } else state.resourcesObjects[action.data._id] = action.data\n                if (action.data._id.toString() === mD.userId.toString()) {\n                    if (action.data.settings)\n                        if (action.data.settings.barSizes)\n                            state.barSizes = action.data.settings.barSizes\n                }\n            }\n        }\n    },\n\n    DELETE_RESOURCE: (state: Object, action: Object) => {\n        if (action.data) {\n            delete state.resourcesObjects[action.data.resourceId]\n        }\n    },\n    REVERT_RESOURCE: (state: Object, action: Object) => {\n        if (action.data) {\n            state.resourcesObjects[action.data._id].present = action.data.draft\n            if (action.data.to === 'draft') {\n                resources.removeResourceFromUnsaved(state, {\n                    _id: action.data._id,\n                })\n                resources.removeResourceFromNewVersions(state, {\n                    _id: action.data._id,\n                })\n            }\n        }\n    },\n    SAVE_OBJECT: (state: Object, action: Object) => {\n        if (action.data) {\n            state.resourcesObjects[action.data._id] = action.data\n        }\n    },\n    SET_ACTIVE_CONTAINER: (state: Object, action: Object) => {\n        if (state.activeContainer !== action.container)\n            state.activeContainer = action.container\n    },\n    UNSET_ACTIVE_CONTAINER: (state: Object, action: Object) => {\n        if (state.activeContainer === action.container)\n            state.activeContainer = ''\n    },\n    SAVE_TO_CLIPBOARD: (state: Object, action: Object) => {\n        state.clipboard = action.data\n    },\n})\n\nexport default reducer\n","import { initialState } from './reducer'\n\nexport const actionStartImageUpload = (state: Object) => ({\n    ...state,\n    error: null,\n    loading: true,\n})\n\nexport const actionSuccessImageUpload = (state: Object) => ({\n    ...state,\n    error: null,\n    loading: false,\n})\n\nexport const actionFailImageUpload = (state: Object, action: Object) => ({\n    ...state,\n    error: action.error,\n    loading: false,\n})\n\nexport const chooseImage = (state: Object = initialState, action: Object) => {\n    state.currentImage = action.image\n}\n","export const authStart = (state: Object) => {\n    state.loading = true\n    state.error = null\n}\n\nexport const authFail = (state: Object, action: Object) => {\n    state.loading = false\n    state.error = action.error\n    state.userId = null\n}\n\nexport const authLogout = (state: Object) => {\n    state.userId = null\n}\n\nexport const authSuccess = (state: Object, action: { data: {} }) => {\n    state.userId = action.data._id\n    state.accountInfo = action.data.accountInfo\n    state.error = null\n    state.loading = false\n    state.barSizes = { ...state.barSizes, ...action.data.barSizes }\n    state.tryWebsiter = action.data.tryWebsiter\n}\n\nexport const changeBarSize = (state: Object, action: Object) => {\n    state.barSizes[action.key] = action.value\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { composeWithDevTools } from 'redux-devtools-extension'\nimport { BrowserRouter } from 'react-router-dom'\nimport { Provider } from 'react-redux'\nimport { createStore, applyMiddleware } from 'redux'\nimport thunk from 'redux-thunk'\nimport axios from 'axios'\nimport throttle from './store/middleware/throttle'\n\nimport './index.css'\nimport App from './App'\n//import * as serviceWorker from './serviceWorker';\nimport reducer from './store/reducer/reducer'\n\nimport 'react-sortable-tree/style.css'\n\nif (process.env.NODE_ENV === 'development') {\n    axios.defaults.baseURL = 'http://api.websiter.test:5000'\n} else {\n    axios.defaults.baseURL = 'https://api.websiter.dev'\n}\n\nconst defaultWait = 300\nconst defaultThrottleOption = {\n    leading: true,\n    trailing: true,\n}\n\nconst throttleMiddleware = throttle(defaultWait, defaultThrottleOption)\n\nexport const store = createStore(\n    reducer,\n    composeWithDevTools(applyMiddleware(throttleMiddleware, thunk))\n)\n\nconst app = (\n    <Provider store={store}>\n        <BrowserRouter>\n            <App />\n        </BrowserRouter>\n    </Provider>\n)\nconst inIframe = window.self !== window.top\n\nconst root = document.getElementById('root')\nif (root !== null && !inIframe) {\n    ReactDOM.render(app, root)\n}\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\n//serviceWorker.unregister();\n","export const structure = {\n    page: 'pagesStructure',\n    plugin: 'pluginsStructure',\n    template: 'templatesStructure',\n    file: 'filesStructure',\n}\n\nexport const current = {\n    page: 'currentPageId',\n    plugin: 'currentPluginId',\n    template: 'currentTemplateId',\n    file: 'currentFileId',\n}\n\nexport const resourceDraftIndex = {\n    page: 'currentPageDraft',\n    plugin: 'currentPluginDraft',\n    template: 'currentTemplateDraft',\n    file: 'currentFileDraft',\n}\n\nexport const resourceItemIndex = {\n    page: 'currentPageItem',\n    plugin: 'currentPluginItem',\n    template: 'currentTemplateItem',\n    file: 'currentFileItem',\n}\n\nexport const resourceObjectIndex = {\n    page: 'currentPageObject',\n    plugin: 'currentPluginObject',\n    template: 'currentTemplateObject',\n    file: 'currentFileObject',\n}\n","const addConnectedResources = (\n    draft,\n    id,\n    newRequestedResourcesList,\n    currentWebsiteObject,\n    resourcesObjects\n) => {\n    if (!resourcesObjects[id])\n        newRequestedResourcesList.push({\n            id,\n            type: 'resource',\n        })\n    if (draft)\n        if (draft.connectedResources)\n            draft.connectedResources.forEach(connectedResource => {\n                let nextResourceItem\n                if (connectedResource.type === 'plugin') {\n                    nextResourceItem = currentWebsiteObject.pluginsStructure.find(\n                        item => item.name === connectedResource.name\n                    )\n                }\n                if (nextResourceItem) {\n                    const nextResourceObject =\n                        resourcesObjects[nextResourceItem.id]\n                    let nextResourceDraft = {}\n                    if (nextResourceObject) {\n                        nextResourceDraft = nextResourceObject.present.structure\n                            ? nextResourceObject.present\n                            : nextResourceObject.draft\n                    }\n                    addConnectedResources(\n                        nextResourceDraft,\n                        nextResourceItem.id,\n                        newRequestedResourcesList,\n                        currentWebsiteObject,\n                        resourcesObjects\n                    )\n                }\n            })\n}\n\nexport default props => {\n    const { mD } = props\n    let newRequestedResourcesList = []\n    if (mD.userId && mD.resourcesObjects) {\n        if (!mD.userObject) {\n            newRequestedResourcesList.push({\n                id: mD.userId,\n                type: 'user',\n            })\n        } else {\n            let currentWebsiteId = mD.currentWebsiteId\n            for (let item of mD.websites) {\n                newRequestedResourcesList.push({\n                    id: item.id,\n                    type: 'website',\n                })\n            }\n            if (!currentWebsiteId) {\n                if (mD.websites.length > 0) currentWebsiteId = mD.websites[0].id\n                if (currentWebsiteId) {\n                    props.chooseWebsite(currentWebsiteId)\n                }\n            } else {\n                if (mD.currentPageId) {\n                    // if (!mD.currentPageObject) {\n                    //     newRequestedResourcesList.push({\n                    //         id: mD.currentPageId,\n                    //         type: 'resource',\n                    //     })\n                    // }\n\n                    addConnectedResources(\n                        mD.currentPageDraft,\n                        mD.currentPageId,\n                        newRequestedResourcesList,\n                        mD.currentWebsiteObject,\n                        mD.resourcesObjects\n                    )\n                    if (mD.pageTemplateId) {\n                        addConnectedResources(\n                            mD.pageTemplateDraft,\n                            mD.pageTemplateId,\n                            newRequestedResourcesList,\n                            mD.currentWebsiteObject,\n                            mD.resourcesObjects\n                        )\n                    }\n                }\n                if (mD.currentTemplateId) {\n                    addConnectedResources(\n                        mD.currentTemplateDraft,\n                        mD.currentTemplateId,\n                        newRequestedResourcesList,\n                        mD.currentWebsiteObject,\n                        mD.resourcesObjects\n                    )\n                }\n                if (mD.currentPluginId) {\n                    addConnectedResources(\n                        mD.currentPluginDraft,\n                        mD.currentPluginId,\n                        newRequestedResourcesList,\n                        mD.currentWebsiteObject,\n                        mD.resourcesObjects\n                    )\n                }\n                if (mD.globalSettingsPageId) {\n                    addConnectedResources(\n                        mD.globalSettingsPageDraft,\n                        mD.globalSettingsPageId,\n                        newRequestedResourcesList,\n                        mD.currentWebsiteObject,\n                        mD.resourcesObjects\n                    )\n                }\n                if (mD.globalSettingsTemplateId) {\n                    addConnectedResources(\n                        mD.globalSettingsTemplateDraft,\n                        mD.globalSettingsTemplateId,\n                        newRequestedResourcesList,\n                        mD.currentWebsiteObject,\n                        mD.resourcesObjects\n                    )\n                }\n            }\n        }\n    }\n    newRequestedResourcesList = Array.from(new Set(newRequestedResourcesList))\n    return newRequestedResourcesList\n}\n","import React from 'react'\n\nimport { connect } from 'react-redux'\nimport axios from 'axios'\n\nimport * as actions from '../../store/actions/index'\nimport { Component } from 'react'\nimport getListOfNeededResources from './methods/getListOfNeededResources'\nimport getEssentialData from '../../utils/getEssentialData'\n\n// type Props = {\n//     loadedWebsite: string,\n// }\n\n// type State = {\n//     requestedResources: Array<{}>,\n//     taskId: number,\n// }\n\nexport let webSocket = false\n\nclass ReserveWebsiteInn extends Component {\n    state = {\n        requestedResources: [],\n        taskId: 0,\n    }\n\n    start = () => {\n        let url\n        if (process.env.NODE_ENV === 'development') {\n            url = 'ws://api.websiter.test:5000'\n        } else {\n            url = 'wss://api.websiter.dev'\n        }\n        let pingTimeout, authInterval\n        webSocket = new WebSocket(url)\n\n        const heartbeat = () => {\n            clearTimeout(pingTimeout)\n            pingTimeout = setTimeout(() => {\n                webSocket.close()\n            }, 30000 + 1000)\n            const versions = {}\n            for (let id in this.props.mD.resourcesObjects) {\n                versions[id] = {\n                    __v: this.props.mD.resourcesObjects[id].__v,\n                    type: this.props.mD.resourcesObjects[id].draft\n                        ? 'resource'\n                        : this.props.mD.resourcesObjects[id].pagesStructure\n                        ? 'website'\n                        : 'user',\n                }\n            }\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'heartbeat',\n                    versions,\n                })\n            )\n        }\n\n        webSocket.onopen = event => {\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'auth',\n                    user: axios.defaults.headers.common['x-auth-token'],\n                    tryWebsiter: sessionStorage.getItem('tryWebsiter'),\n                })\n            )\n            authInterval = setInterval(\n                () =>\n                    webSocket.send(\n                        JSON.stringify({\n                            messageCode: 'auth',\n                            noRequest: true,\n                            user: axios.defaults.headers.common['x-auth-token'],\n                            tryWebsiter: sessionStorage.getItem('tryWebsiter'),\n                        })\n                    ),\n                600000\n            )\n            heartbeat()\n        }\n        webSocket.onmessage = event => {\n            const data = JSON.parse(event.data)\n\n            switch (data.messageCode) {\n                case 'heartbeat':\n                    heartbeat()\n                    break\n                case 'logout':\n                    this.props.logout()\n                    break\n                case 'addResource':\n                    let resource = data.resource\n                    this.props.addResource(resource)\n                    break\n                case 'updateuser':\n                    this.props.updateUser(data, webSocket)\n                    break\n                case 'updatewebsite':\n                    this.props.updateWebsite(data, webSocket)\n                    break\n                case 'updateresource':\n                    this.props.updateResource(data, webSocket)\n                    break\n                case 'revertResource':\n                    this.props.revertResource(data)\n                    break\n                case 'deleteuser':\n                case 'deletewebsite':\n                case 'deleteresource':\n                    this.props.deleteResource(data)\n                    break\n                case 'confirmSaved':\n                    this.props.confirmSaved(data)\n                    break\n                case 'notFoundResource':\n                    this.markNotFoundResource(data)\n                    break\n                case 'error':\n                    alert(data.text)\n                    break\n                default:\n                    break\n            }\n        }\n        webSocket.onclose = event => {\n            clearTimeout(pingTimeout)\n            clearInterval(authInterval)\n        }\n    }\n\n    markNotFoundResource = data => {\n        const requestedResources = this.state.requestedResources.filter(\n            item => item.id.toString() === data._id.toString()\n        )\n        this.setState({ requestedResources })\n    }\n\n    checkInterval = null\n\n    check = () => {\n        if (!webSocket || webSocket.readyState === 3) {\n            this.start()\n        }\n    }\n    componentWillMount() {\n        this.checkInterval = setInterval(this.check, 5000)\n    }\n\n    reRequestResourcesInterval = null\n    reRequestResources = () => {\n        for (let requestedResource of this.state.requestedResources) {\n            if (requestedResource)\n                if (!this.props.mD.resourcesObjects[requestedResource.id]) {\n                    if (webSocket && webSocket.readyState !== 3) {\n                        webSocket.send(\n                            JSON.stringify({\n                                messageCode: 'requestResource',\n                                id: requestedResource.id,\n                                type: requestedResource.type,\n                            })\n                        )\n                    }\n                }\n        }\n    }\n    componentWillUnmount() {\n        clearInterval(this.reRequestResourcesInterval)\n        clearInterval(this.checkInterval)\n        if (webSocket) {\n            webSocket.close()\n        }\n    }\n\n    componentWillReceiveProps(nextProps) {\n        const newRequestedResourcesList = getListOfNeededResources(nextProps)\n        const requestedResources = []\n        for (const requestItem of newRequestedResourcesList) {\n            if (requestItem) {\n                let requestedResourceItem = this.state.requestedResources.find(\n                    item => item.id === requestItem.id\n                )\n                if (!requestedResourceItem) {\n                    if (webSocket && webSocket.readyState !== 3) {\n                        webSocket.send(\n                            JSON.stringify({\n                                messageCode: 'requestResource',\n                                id: requestItem.id,\n                                type: requestItem.type,\n                            })\n                        )\n                        requestedResourceItem = {\n                            id: requestItem.id,\n                            type: requestItem.type,\n                            state: 'sent',\n                        }\n                    }\n                }\n                if (requestedResourceItem)\n                    requestedResources.push(requestedResourceItem)\n            }\n        }\n        this.setState({ requestedResources })\n        clearInterval(this.reRequestResourcesInterval)\n        this.reRequestResourcesInterval = setInterval(\n            this.reRequestResources,\n            3000\n        )\n    }\n\n    render() {\n        return null\n    }\n}\n\nconst mapStateToPropsDo = state => {\n    return {\n        mD: state.mD,\n    }\n}\n\nconst mapDispatchToPropsDo = dispatch => {\n    return {\n        logout: () => dispatch(actions.logout()),\n        addResource: data => dispatch(actions.addResource(data)),\n        updateUser: (data, webSocket) =>\n            dispatch(actions.updateUser(data, webSocket)),\n        updateWebsite: (data, webSocket) =>\n            dispatch(actions.updateWebsite(data, webSocket)),\n        updateResource: (data, webSocket) =>\n            dispatch(actions.updateResource(data, webSocket)),\n        deleteResource: data => dispatch(actions.deleteResource(data)),\n        revertResource: data => dispatch(actions.revertResource(data)),\n        chooseWebsite: currentWebsiteId =>\n            dispatch(actions.chooseWebsite(currentWebsiteId)),\n        confirmSaved: data => dispatch(actions.removeResourceFromUnsaved(data)),\n    }\n}\n\nconst ReserveWebsiteDo = connect(\n    mapStateToPropsDo,\n    mapDispatchToPropsDo\n)(ReserveWebsiteInn)\n\nconst ReserveWebsite = props => {\n    const mainData = getEssentialData(\n        props.userId,\n        props.resourcesObjects,\n        props.tryWebsiter\n    )\n\n    props.saveMainData(mainData)\n    return <ReserveWebsiteDo />\n}\n\nconst mapStateToProps = state => {\n    return {\n        userId: state.userId,\n        resourcesObjects: state.resourcesObjects,\n        tryWebsiter: state.tryWebsiter,\n    }\n}\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        saveMainData: mD => dispatch(actions.saveMainData(mD)),\n    }\n}\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(ReserveWebsite)\n","export default (userId, resourcesObjects, tryWebsiter) => {\n    const userObject = resourcesObjects[userId]\n    let websites,\n        currentWebsiteItem,\n        currentWebsiteId,\n        currentWebsiteObject,\n        pagesStructure = [],\n        templatesStructure = [],\n        pluginsStructure = [],\n        filesStructure = [],\n        currentPageId = '',\n        currentPageFSBId = '',\n        currentTemplateId = '',\n        currentPluginId = '',\n        currentFileId = '',\n        currentPageItem,\n        currentPageFSBItem,\n        currentTemplateItem,\n        currentPluginItem,\n        currentFileItem,\n        currentPageObject,\n        currentPageFSBObject,\n        currentTemplateObject,\n        currentPluginObject,\n        currentFileObject,\n        currentPageDraft,\n        currentPageFSBDraft,\n        currentTemplateDraft,\n        currentPluginDraft,\n        globalSettingsPageId,\n        globalSettingsPageObject,\n        globalSettingsPageDraft,\n        globalSettingsTemplateId,\n        globalSettingsTemplateDraft,\n        pageTemplateName = '',\n        pageTemplateId = '',\n        pageTemplateItem,\n        pageTemplateObject,\n        pageTemplateDraft,\n        pageTemplateFSBName = '',\n        pageTemplateFSBId = '',\n        pageTemplateFSBItem,\n        pageTemplateFSBObject,\n        pageTemplateFSBDraft,\n        nextFileId = 0\n    if (userObject) {\n        websites = userObject.websites\n        if (websites) {\n            if (websites.length > 0 && userObject.settings) {\n                if (userObject.settings.currentWebsite) {\n                    currentWebsiteItem = websites.find(\n                        item => item.id === userObject.settings.currentWebsite\n                    )\n                }\n                if (currentWebsiteItem) {\n                    currentWebsiteId = currentWebsiteItem.id\n                    currentWebsiteObject = resourcesObjects[currentWebsiteId]\n                    if (currentWebsiteObject) {\n                        pagesStructure = currentWebsiteObject.pagesStructure\n                        templatesStructure =\n                            currentWebsiteObject.templatesStructure\n                        pluginsStructure = currentWebsiteObject.pluginsStructure\n                        filesStructure = currentWebsiteObject.filesStructure\n                        nextFileId = currentWebsiteObject.nextFileId || 0\n\n                        const currentWebsiteItemSettings =\n                            userObject.settings.websites[currentWebsiteId]\n                        if (currentWebsiteItemSettings) {\n                            currentPageId =\n                                currentWebsiteItemSettings.currentPageId\n                            currentPageFSBId =\n                                currentWebsiteItemSettings.currentPageFSBId\n                            currentTemplateId =\n                                currentWebsiteItemSettings.currentTemplateId\n                            currentPluginId =\n                                currentWebsiteItemSettings.currentPluginId\n                            currentFileId =\n                                currentWebsiteItemSettings.currentFileId\n\n                            currentPageItem = pagesStructure.find(\n                                item => item.id === currentPageId\n                            )\n                            currentPageFSBItem = pagesStructure.find(\n                                item => item.id === currentPageFSBId\n                            )\n                            currentTemplateItem = templatesStructure.find(\n                                item => item.id === currentTemplateId\n                            )\n                            currentPluginItem = pluginsStructure.find(\n                                item => item.id === currentPluginId\n                            )\n                            currentFileItem = filesStructure.find(\n                                item => item.id === currentFileId\n                            )\n\n                            if (currentPageItem) {\n                                currentPageObject =\n                                    resourcesObjects[currentPageId]\n                                if (currentPageObject) {\n                                    currentPageDraft = !currentPageObject\n                                        .present.structure\n                                        ? currentPageObject.draft\n                                        : currentPageObject.present\n                                }\n                                pageTemplateName =\n                                    currentPageItem.template || ''\n                                if (pageTemplateName) {\n                                    pageTemplateItem = templatesStructure.find(\n                                        item => item.name === pageTemplateName\n                                    )\n                                    if (pageTemplateItem) {\n                                        pageTemplateId = pageTemplateItem.id\n                                        pageTemplateObject =\n                                            resourcesObjects[pageTemplateId]\n                                        if (pageTemplateObject) {\n                                            pageTemplateDraft = !pageTemplateObject\n                                                .present.structure\n                                                ? pageTemplateObject.draft\n                                                : pageTemplateObject.present\n                                        }\n                                    }\n                                }\n                            }\n                            if (currentPageFSBItem) {\n                                currentPageFSBObject =\n                                    resourcesObjects[currentPageFSBId]\n                                if (currentPageFSBObject) {\n                                    currentPageFSBDraft = !currentPageFSBObject\n                                        .present.structure\n                                        ? currentPageFSBObject.draft\n                                        : currentPageFSBObject.present\n                                }\n                                pageTemplateFSBName =\n                                    currentPageFSBItem.template || ''\n                                if (pageTemplateFSBName) {\n                                    pageTemplateFSBItem = templatesStructure.find(\n                                        item =>\n                                            item.name === pageTemplateFSBName &&\n                                            !item.hidden\n                                    )\n                                    if (pageTemplateFSBItem) {\n                                        pageTemplateFSBId =\n                                            pageTemplateFSBItem.id\n                                        pageTemplateFSBObject =\n                                            resourcesObjects[pageTemplateFSBId]\n                                        if (pageTemplateFSBObject) {\n                                            pageTemplateFSBDraft = !pageTemplateFSBObject\n                                                .present.structure\n                                                ? pageTemplateFSBObject.draft\n                                                : pageTemplateFSBObject.present\n                                        }\n                                    }\n                                }\n                            }\n\n                            if (currentTemplateItem) {\n                                currentTemplateObject =\n                                    resourcesObjects[currentTemplateId]\n                                if (currentTemplateObject) {\n                                    currentTemplateDraft = !currentTemplateObject\n                                        .present.structure\n                                        ? currentTemplateObject.draft\n                                        : currentTemplateObject.present\n                                }\n                            }\n                            if (currentPluginItem) {\n                                currentPluginObject =\n                                    resourcesObjects[currentPluginId]\n                                if (currentPluginObject) {\n                                    currentPluginDraft = !currentPluginObject\n                                        .present.structure\n                                        ? currentPluginObject.draft\n                                        : currentPluginObject.present\n                                }\n                            }\n                            if (currentFileItem) {\n                                currentFileObject =\n                                    resourcesObjects[currentFileId]\n                            }\n\n                            const globalSettingsPageItem = pagesStructure.find(\n                                item => item.generalSettings\n                            )\n                            if (globalSettingsPageItem) {\n                                globalSettingsPageId = globalSettingsPageItem.id\n                                globalSettingsPageObject =\n                                    resourcesObjects[globalSettingsPageId]\n                                if (globalSettingsPageObject) {\n                                    globalSettingsPageDraft = !globalSettingsPageObject\n                                        .present.structure\n                                        ? globalSettingsPageObject.draft\n                                        : globalSettingsPageObject.present\n                                }\n                            }\n\n                            const globalSettingsTemplateItem = templatesStructure.find(\n                                item => item.generalSettings\n                            )\n                            if (globalSettingsTemplateItem) {\n                                globalSettingsTemplateId =\n                                    globalSettingsTemplateItem.id\n                                const globalSettingsTemplateObject =\n                                    resourcesObjects[globalSettingsTemplateId]\n                                if (globalSettingsTemplateObject) {\n                                    globalSettingsTemplateDraft = !globalSettingsTemplateObject\n                                        .present.structure\n                                        ? globalSettingsTemplateObject.draft\n                                        : globalSettingsTemplateObject.present\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n    return {\n        userObject,\n        websites,\n        currentWebsiteItem,\n        currentWebsiteId,\n        currentWebsiteObject,\n        pagesStructure,\n        templatesStructure,\n        pluginsStructure,\n        filesStructure,\n        currentPageId,\n        currentPageFSBId,\n        currentTemplateId,\n        currentPluginId,\n        currentFileId,\n        currentPageItem,\n        currentPageFSBItem,\n        currentTemplateItem,\n        currentPluginItem,\n        currentFileItem,\n        currentPageObject,\n        currentPageFSBObject,\n        currentTemplateObject,\n        currentPluginObject,\n        currentFileObject,\n        currentPageDraft,\n        currentPageFSBDraft,\n        currentTemplateDraft,\n        currentPluginDraft,\n        globalSettingsPageId,\n        globalSettingsPageObject,\n        globalSettingsPageDraft,\n        globalSettingsTemplateId,\n        globalSettingsTemplateDraft,\n        pageTemplateName,\n        pageTemplateId,\n        pageTemplateItem,\n        pageTemplateObject,\n        pageTemplateDraft,\n        pageTemplateFSBName,\n        pageTemplateFSBId,\n        pageTemplateFSBItem,\n        pageTemplateFSBObject,\n        pageTemplateFSBDraft,\n        resourcesObjects,\n        userId,\n        tryWebsiter,\n        nextFileId,\n    }\n}\n","export default (structure, page) =>\n    structure.map(item => ({\n        ...item,\n        relUrl:\n            item.path.reduce((totalPath, itemId) => {\n                const el = structure.find(itemInn => itemInn.id === itemId)\n                if (el && (!el.hidden || el.folderPage))\n                    return totalPath + el[page ? 'url' : 'name'] + '/'\n                else {\n                    return totalPath\n                }\n            }, '') + item[page ? 'url' : 'name'],\n    }))\n","import isEmpty from 'lodash/isEmpty'\nimport isEqual from 'lodash/isEqual'\nimport omit from 'lodash/omit'\n\nexport const checkIfCapital = (char: string) => {\n    if (char === char.toUpperCase() && char !== char.toLowerCase()) {\n        return true\n    }\n}\n\nexport const getCurrentResourceValue = (id: string, resourcesObjects: {}) =>\n    id\n        ? resourcesObjects[id]\n            ? isEmpty(resourcesObjects[id].present)\n                ? resourcesObjects[id].draft\n                : resourcesObjects[id].present\n            : null\n        : null\n\nfunction _objectSpread(target) {\n    for (var i = 1; i < arguments.length; i++) {\n        var source = arguments[i] != null ? arguments[i] : {}\n        var ownKeys = Object.keys(source)\n        if (typeof Object.getOwnPropertySymbols === 'function') {\n            ownKeys = ownKeys.concat(\n                //eslint-disable-next-line\n                Object.getOwnPropertySymbols(source).filter(function(sym) {\n                    return Object.getOwnPropertyDescriptor(\n                        source,\n                        sym\n                    ).enumerable\n                })\n            )\n        }\n        //eslint-disable-next-line\n        ownKeys.forEach(function(key) {\n            _defineProperty(target, key, source[key])\n        })\n    }\n    return target\n}\n\nfunction _defineProperty(obj, key, value) {\n    if (key in obj) {\n        Object.defineProperty(obj, key, {\n            value: value,\n            enumerable: true,\n            configurable: true,\n            writable: true,\n        })\n    } else {\n        obj[key] = value\n    }\n    return obj\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n    if (source == null) return {}\n    var target = _objectWithoutPropertiesLoose(source, excluded)\n    var key, i\n    if (Object.getOwnPropertySymbols) {\n        var sourceSymbolKeys = Object.getOwnPropertySymbols(source)\n        for (i = 0; i < sourceSymbolKeys.length; i++) {\n            key = sourceSymbolKeys[i]\n            if (excluded.indexOf(key) >= 0) continue\n            if (!Object.prototype.propertyIsEnumerable.call(source, key))\n                continue\n\n            target[key] = source[key]\n        }\n    }\n    return target\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {}\n    var target = {}\n    var sourceKeys = Object.keys(source)\n    var key, i\n    for (i = 0; i < sourceKeys.length; i++) {\n        key = sourceKeys[i]\n        if (excluded.indexOf(key) >= 0) continue\n        target[key] = source[key]\n    }\n    return target\n}\n\nexport function buildTree(items) {\n    var buildItem = function buildItem(item) {\n        // var path = item.path,\n        var data = _objectWithoutProperties(item, ['path'])\n\n        return _objectSpread({}, data, {\n            children: items\n                .filter(function(child) {\n                    return child.path[child.path.length - 1] === item.id\n                })\n                .map(function(child) {\n                    return buildItem(child)\n                }),\n        })\n    }\n\n    var tree = items\n        .filter(function(item) {\n            return item.path.length === 0\n        })\n        .map(function(item) {\n            return buildItem(item)\n        })\n    return tree\n}\n\nexport const getInheritedPropertyName = (value: string) => {\n    const length = value.length\n    if (length > 2) {\n        if (value.charAt(0) === '$' && value.charAt(length - 1) === '$') {\n            return value.substr(1, length - 2)\n        }\n    }\n    return false\n}\n\nexport const isEqualStructuresWithOmit = (structure1, structure2) =>\n    isEqual(\n        structure1.map(item =>\n            omit(item, ['expanded', 'children', 'itemPath'])\n        ),\n        structure2.map(item => omit(item, ['expanded', 'children', 'itemPath']))\n    )\n","import { webSocket } from '../components/ReserveWebsite/ReserveWebsite'\nimport {\n    resourceItemIndex,\n    resourceDraftIndex,\n} from '../utils/resourceTypeIndex'\nimport * as actions from '../store/actions'\nimport buildRelUrls from '../utils/buildRelUrls'\n\nconst diffpatcher = require('jsondiffpatch/dist/jsondiffpatch.umd.js').create({\n    objectHash: obj => obj.id,\n    propertyFilter: (name, context) => name !== '__patch__',\n})\n\nexport const sendUpdate = (\n    type: 'user' | 'website' | 'page' | 'template' | 'plugin',\n    changes: {},\n    id: string\n) => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    const oldResource = mD.resourcesObjects[id]\n    if (oldResource) {\n        let draft, currentDraft\n        if (['page', 'template', 'plugin'].includes(type)) {\n            draft = oldResource.draft\n            currentDraft = mD[resourceDraftIndex[type]]\n        } else {\n            draft = oldResource\n            currentDraft = oldResource\n        }\n        if (draft && changes) {\n            const newResource = { ...currentDraft, ...changes }\n            if (type === 'website') {\n                newResource.pagesStructure = buildRelUrls(\n                    newResource.pagesStructure,\n                    true\n                )\n                newResource.filesStructure = buildRelUrls(\n                    newResource.filesStructure\n                )\n            }\n            const patch = diffpatcher.diff(draft, newResource)\n            if (patch) {\n                if (webSocket && webSocket.readyState !== 3) {\n                    webSocket.send(\n                        JSON.stringify({\n                            messageCode: 'updateResource',\n                            type,\n                            _id: id,\n                            __patch__: patch,\n                            __v: oldResource.__v,\n                            markPublish: [\n                                'page',\n                                'template',\n                                'plugin',\n                            ].includes(type)\n                                ? !mD[resourceItemIndex[type]].notPublished\n                                : false,\n                        })\n                    )\n                }\n            } else {\n                actions.removeResourceFromUnsaved({ _id: id })\n                actions.removeResourceFromNewVersions({ _id: id })\n            }\n        }\n    }\n}\n","import { webSocket } from '../components/ReserveWebsite/ReserveWebsite'\nimport { current, resourceObjectIndex } from '../utils/resourceTypeIndex'\nimport * as actions from '../store/actions'\n\nexport const addResource = (\n    type: 'page' | 'plugin' | 'template',\n    duplicate?: boolean,\n    newResourceName?: string,\n    resourceData?: {}\n) => (dispatch: Object, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'addResource',\n                type,\n                websiteId: mD.currentWebsiteId,\n                duplicate,\n                _id: mD[current[type]],\n                name: newResourceName,\n                resourceData,\n            })\n        )\n    }\n}\n\nexport const deleteResource = (type: 'page' | 'plugin' | 'template') => (\n    dispatch: Object,\n    getState\n) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (!window.confirm('Are you sure you want to delete this resource?'))\n        return\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'deleteResource',\n                type,\n                _id: mD[current[type]],\n                websiteId: mD.currentWebsiteId,\n            })\n        )\n    }\n}\n\nexport const publishResource = (type: 'page' | 'plugin' | 'template') => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'publishResource',\n                type,\n                _id: mD[current[type]],\n            })\n        )\n    }\n}\n\nexport const revertResource = (type, to) => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (to === 'draft') {\n        dispatch(\n            actions.revertResource({\n                _id: mD[current[type]],\n                draft: mD[resourceObjectIndex[type]].draft,\n                to,\n            })\n        )\n    } else {\n        if (webSocket && webSocket.readyState !== 3) {\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'revertResource',\n                    type,\n                    _id: mD[current[type]],\n                    to,\n                })\n            )\n        }\n    }\n}\n","import { webSocket } from '../components/ReserveWebsite/ReserveWebsite'\nimport { sendUpdate } from './sendUpdate'\nimport cloneDeep from 'lodash/cloneDeep'\n\nexport const changeWebsiteProperty = (key, value, id) => (\n    dispatch,\n    getState\n) => {\n    const { mD } = getState()\n    if (!mD.currentWebsiteObject || !mD.currentWebsiteId) return\n    const newResource = cloneDeep(\n        id ? mD.resourcesObjects[id] : mD.currentWebsiteObject\n    )\n    if (!newResource) return\n    newResource[key] = value\n    dispatch(sendUpdate('website', newResource, mD.currentWebsiteId))\n}\n\nexport const addWebsite = (duplicate?: boolean) => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'addWebsite',\n                _id: mD.currentWebsiteId,\n                duplicate,\n            })\n        )\n    }\n}\n\nexport const deleteWebsite = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (!window.confirm('Are you sure you want to delete this website?')) return\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'deleteWebsite',\n                _id: mD.currentWebsiteId,\n            })\n        )\n    }\n}\n\nexport const verifyCustomDomain = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'verifyCustomDomain',\n                _id: mD.currentWebsiteId,\n            })\n        )\n    }\n}\n\nexport const sharingRightsChange = (userId, right, value) => (\n    dispatch,\n    getState\n) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (mD.currentWebsiteObject) {\n        const newSharing = cloneDeep(mD.currentWebsiteObject.sharing)\n        const account = newSharing.find(item => item.userId === userId)\n        if (account) {\n            let newRights = []\n            if (value) {\n                newRights = [...account.rights, right]\n            } else {\n                newRights = account.rights.filter(item => item !== right)\n            }\n            // const updatedSharing = mD.currentWebsiteObject.sharing.filter(\n            //     item => item.userId !== userId\n            // )\n            // updatedSharing.push({\n            //     ...account,\n            //     rights: newRights,\n            // })\n            account.rights = newRights\n            dispatch(\n                changeWebsiteProperty(\n                    'sharing',\n                    newSharing,\n                    mD.currentWebsiteId\n                )\n            )\n        }\n    }\n}\n\nexport const addUserInWebsiteSharing = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (mD.currentWebsiteObject) {\n        const id = window.prompt('Paste the user id to share the website.')\n        if (!id) return\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'addUserInSharing',\n                _id: mD.currentWebsiteId,\n                userId: id,\n                type: 'add',\n            })\n        )\n    }\n}\n\nexport const deleteUserInWebsiteSharing = userId => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (\n        !window.confirm(\n            'Are you sure you want to delete this user from sharing?'\n        )\n    )\n        return\n    const { mD } = getState()\n    if (userId && userId !== mD.userId) {\n        if (\n            !window.confirm(\n                'Are you sure you want to remove this user from sharing?'\n            )\n        )\n            return\n    }\n\n    webSocket.send(\n        JSON.stringify({\n            messageCode: 'addUserInSharing',\n            _id: mD.currentWebsiteId,\n            userId,\n            type: 'delete',\n        })\n    )\n}\n\nexport const transferWebsite = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (mD.currentWebsiteObject) {\n        const userTo = window.prompt(\n            'Enter the user id to whom you would like to transfer the website. It can be found in the user account menu tab.'\n        )\n        if (\n            !userTo ||\n            !window.confirm(\n                'Are you sure you want to transfer this website to user - ' +\n                    userTo +\n                    '?'\n            )\n        )\n            return\n\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'transferWebsite',\n                _id: mD.currentWebsiteId,\n                userTo,\n            })\n        )\n    }\n}\n\nexport const saveDomainName = (name, type) => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (mD.currentWebsiteObject) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'saveDomainName',\n                _id: mD.currentWebsiteId,\n                name,\n                type,\n            })\n        )\n    }\n}\n","export { sendUpdate } from './sendUpdate'\n\nexport {\n    addResource,\n    deleteResource,\n    publishResource,\n    revertResource,\n} from './resources'\n\nexport {\n    addWebsite,\n    deleteWebsite,\n    changeWebsiteProperty,\n    verifyCustomDomain,\n    sharingRightsChange,\n    addUserInWebsiteSharing,\n    deleteUserInWebsiteSharing,\n    transferWebsite,\n    saveDomainName,\n} from './websites'\n","import React from 'react'\n\n// type Props = {\n//     className?: string,\n//     icon: ?string,\n//     datatestid?: string,\n// }\n\n// type Element = {\n//     type: string,\n//     children: Array<Element>,\n//     fill: string,\n//     d: string,\n// }\n\nexport const Svg = props => {\n    const svgStringToObj = svg => {\n        const obj = []\n\n        const stack = []\n\n        while (svg.length > 0) {\n            svg = svg.trim()\n            if (svg.indexOf('</') === 0) {\n                svg = svg.substring(2)\n                if (svg.indexOf('<') > 0) {\n                    svg = svg.substring(svg.indexOf('<'))\n                    stack.pop()\n                } else {\n                    svg = ''\n                }\n            } else {\n                svg = svg.substring(svg.indexOf('<'))\n                const curObj = {\n                    type: svg.substring(1, svg.indexOf(' ')),\n                    children: [],\n                }\n                svg = svg.substring(svg.indexOf(' '))\n                let attr = svg.substring(0, svg.indexOf('>'))\n                let selfclosing = attr.indexOf('/>') >= 0\n\n                svg = svg.substring(svg.indexOf('>') + 1).trim()\n                while (attr.length > 0) {\n                    let key = attr.substring(0, attr.indexOf('=')).trim()\n                    attr = attr.substring(attr.indexOf('\"') + 1)\n                    let value = attr.substring(0, attr.indexOf('\"')).trim()\n                    attr = attr.substring(attr.indexOf('\"') + 1).trim()\n                    curObj[key] = value\n                }\n                if (stack.length === 0) {\n                    obj.push(curObj)\n                } else {\n                    stack[stack.length - 1].children.push(curObj)\n                }\n                if (!selfclosing) {\n                    stack.push(curObj)\n                }\n            }\n        }\n        return obj[0]\n    }\n\n    const svgChildrenToElements = (element, elementIndex) => {\n        switch (element.type) {\n            case 'path':\n                return (\n                    <path key={elementIndex} d={element.d} fill={element.fill}>\n                        {element.children.map((el: Element, index) =>\n                            svgChildrenToElements(el, index)\n                        )}\n                    </path>\n                )\n            case 'g':\n                return (\n                    <g key={elementIndex} fill={element.fill}>\n                        {element.children.map((el: Element, index) =>\n                            svgChildrenToElements(el, index)\n                        )}\n                    </g>\n                )\n            default:\n                return\n        }\n    }\n\n    let result = null\n    if (props.icon) {\n        const objectSvg = svgStringToObj(props.icon)\n\n        result = (\n            <svg\n                data-testid={props.datatestid || 'svg'}\n                height={objectSvg.height}\n                width={objectSvg.width}\n                viewBox={objectSvg.viewBox}\n                className={props.className}\n            >\n                {objectSvg.children.map((element, index) =>\n                    svgChildrenToElements(element, index)\n                )}\n            </svg>\n        )\n    }\n    return result\n}\n\nexport default Svg\n"],"sourceRoot":""}