{"version":3,"sources":["store/actions/builder.js","store/actions/auth.js","store/actions/website.js","store/actions/images.js","store/actions/resources.js","store/actions/webSocket.js","store/actions/index.js","components/UI/LoginButton/LoginButton.module.css","containers/Auth/Auth.module.css","utils/basic.js","websocketActions/sendUpdate.js","websocketActions/resources.js","websocketActions/websites.js","websocketActions/images.js","websocketActions/index.js","components/UI/Checkbox/Checkbox.js","store/middleware/throttle.js","containers/Auth/Logout/Logout.js","hoc/asyncComponent.js","components/UI/LoginButton/LoginButton.js","containers/Auth/Auth.js","components/UI/Spinner/Spinner.js","utils/resourcesAreEqual.js","store/reducer/resources.js","store/reducer/reducer.js","store/reducer/images.js","store/reducer/auth.js","App.js","index.js","components/ReserveWebsite/methods/getListOfNeededResources.js","components/ReserveWebsite/ReserveWebsite.js","utils/getEssentialData.js","utils/resourceTypeIndex.js","components/UI/Checkbox/Checkbox.module.css","components/Svg/Svg.js","components/UI/Spinner/Spinner.module.css"],"names":["htmlparser","require","findElementIndex","draft","currentBox","length","structure","findIndex","item","id","findRouteElements","mode","result","push","forEach","index","path","isEqual","saveElementsStructure","type","dispatch","getState","mD","resourceDraft","resourceDraftIndex","newStructure","map","oldItem","find","itemInn","Object","objectSpread","expanded","isNotForHistory","omit","actions","saveElementsStructureFromBuilder","pageTemplateDraft","newValues","newItem","values","value","menuItems","currentMenuItem","currentMenuId","chooseBox","unhoverBox","changeBoxPropertyInStructure","key","boxId","elementIndex","deleteFromHoveredSizes","current","changes","isObject","String","toString","concat","toConsumableArray","slice","throttle","changeBoxPropertyInValues","defineProperty","saveHoveredElementRect","size","currentResource","removedElements","hoverBox","fromFrame","toggleFindMode","addBox","putInside","routeElements","element","isChildren","childrenTo","newId","currentId","newCurrentId","isCMSVariable","tag","textMode","text","isElementFromCMSVariable","textContent","properties","propertiesString","CMSVariableType","CMSVariableSystemName","CMSVariableDescription","CMSVariableDefaultValue","deleteBox","withChildren","includes","elementId","filter","notRemove","newPageStructure","pathItem","_i","_removedElements","duplicateBox","sourceChildren","idMatch","newValuesElements","newChildren","newItemId","splitText","start","end","textContent0","substr","textContent1","textContent2","newElements","textToSpan","spanId","style","changeMenuItemProperty","itemId","resource","newMenuItems","markRefreshing","refreshing","markShouldRefreshing","mergeBoxToPlugin","onlyChildren","newResourcesIds","oldResourcesIds","resourceDataValues","resourceDataStructure","indexOf","resourceData","element_0","newPluginName","prompt","wsActions","i","dissolvePluginToBox","plugin","pluginsStructure","name","resourcesObjects","pluginResource","present","pluginDataValues","pluginDataStructure","parseHTML","htmlArray","parseDOM","newElementsValues","parseToWebsiter","curArray","data","trim","attribs","newElement","newElementValues","JSON","stringify","children","cookies","Cookies","authSuccess","deleteUser","sessionStorage","getItem","alert","window","confirm","webSocket","send","messageCode","logout","all","remove","axios","defaults","headers","common","logoutDo","authCheckState","setItem","tryWebsiter","get","console","log","_id","token","rememberMe","userId","jwt","decode","post","put","delete","Accept","then","response","removeItem","catch","err","error","message","changeBarSizeDo","savePropertiesOnLeave","_getState","barSizes","settings","userObject","changeBarSize","initiator","dif","dif2","value2","value3","width","Math","max","innerWidth","height","innerHeight","width2","width3","switchTooltips","cloneDeep","tooltipsOff","chooseWebsite","currentWebsite","saveObject","chooseUserInWebsiteSharing","setSizeIsChanging","isChanging","setCurrentTopTab","currentTopTab","saveMainData","actionFailImageUpload","uploadFile","fileDetails","signedRequest","url","websiteId","file","Content-Type","label","chooseImage","image","imageUpload","files","split","currentWebsiteId","replace","namePrefix","k","currentWebsiteObject","images","fileName","fileType","fileSize","status","getSignedRequest","chooseResource","resourceType","websites","addResourceVersion","meta","undoResourceVersion","redoResourceVersion","removeResourceFromUnsaved","diffpatcher","create","objectHash","obj","propertyFilter","context","addResource","addResourceDo","deleteResource","revertResource","updateUser","currentUser","resourceId","__v","patch","__patch__","requestResource","updateWebsite","newWebsite","updateResource","isEmpty","readyState","__webpack_require__","d","__webpack_exports__","builder_chooseBox","builder_addBox","builder_deleteBox","builder_duplicateBox","builder_saveElementsStructure","builder_saveElementsStructureFromBuilder","builder_changeBoxPropertyInStructure","builder_changeBoxPropertyInValues","builder_splitText","builder_textToSpan","builder_changeMenuItemProperty","builder_mergeBoxToPlugin","builder_dissolvePluginToBox","builder_parseHTML","auth_logout","auth_authCheckState","auth_deleteUser","auth_changeBarSize","auth_savePropertiesOnLeave","auth_switchTooltips","website_chooseWebsite","resources_chooseResource","webSocket_updateUser","webSocket_updateWebsite","webSocket_updateResource","module","exports","Button","Success","Danger","Auth","Form","Title","Subtitle","ActionBlock","Middle","RememberForgot","ForgotPassword","Link","RememberMe","RememberMeLabel","Container","socialButtons","checkIfCapital","getCurrentResourceValue","buildTree","getInheritedPropertyName","lodash_isEmpty__WEBPACK_IMPORTED_MODULE_0__","lodash_isEmpty__WEBPACK_IMPORTED_MODULE_0___default","n","char","toUpperCase","toLowerCase","_defineProperty","enumerable","configurable","writable","_objectWithoutProperties","source","excluded","target","sourceKeys","keys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","prototype","propertyIsEnumerable","call","items","buildItem","arguments","ownKeys","sym","getOwnPropertyDescriptor","_objectSpread","child","charAt","sendUpdate","currentDraft","oldResource","newResource","diff","markPublish","resourceItemIndex","notPublished","duplicate","newResourceName","publishResource","to","resourceObjectIndex","changeWebsiteProperty","addWebsite","deleteWebsite","verifyCustomDomain","sharingRightsChange","right","newSharing","sharing","account","newRights","rights","addUserInWebsiteSharing","deleteUserInWebsiteSharing","transferWebsite","userTo","saveDomainName","deleteImage","renameImage","sendUpdate_sendUpdate","resources_addResource","resources_deleteResource","resources_publishResource","resources_revertResource","websites_addWebsite","websites_deleteWebsite","websites_changeWebsiteProperty","websites_verifyCustomDomain","websites_sharingRightsChange","websites_addUserInWebsiteSharing","websites_deleteUserInWebsiteSharing","websites_transferWebsite","websites_saveDomainName","images_renameImage","images_deleteImage","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","_Checkbox_module_css__WEBPACK_IMPORTED_MODULE_1__","_Checkbox_module_css__WEBPACK_IMPORTED_MODULE_1___default","Checkbox","props","a","createElement","className","inline","classes","Div","Inline","join","data-testid","datatestid","radio","Input","checked","onChange","e","title","CANCEL","FLUSH","throttled","action","method","payload","types","Array","isArray","t","Logout","this","onLogout","react_default","Redirect","Component","connect","asyncComponent","importComponent","_Component","_temp","_getPrototypeOf2","_this","classCallCheck","_len","args","_key","possibleConstructorReturn","getPrototypeOf","apply","state","component","inherits","createClass","_this2","cmp","setState","default","C","LoginButton","disabled","btnType","onClick","clicked","_useState","useState","_useState2","slicedToArray","_useState3","_useState4","cookieConsent","setCookieConsent","useEffect","checkCookieConsent","remeberMeParam","basicURL","Fragment","href","Svg","icon","UI_LoginButton_LoginButton","set","maxAge","open","spinner","cover","Cover","Loader","resourcesAreEqual","draft1","draft2","notSavedResources","removeResourceFromNewVersions","newVersionResources","initialState","loading","domainNotOk","customDomainNotOk","maxStorage","uploadingImage","currentBoxInPlugin","currentImage","sizeIsChanging","pageZoom","hoveredElementId","hoveredElementSize","isRefreshing","findMode","hoverMode","search","shouldRefresh","currentUserInWebsiteSharing","reducer","createReducer","REMOVE_RESOURCE_FROM_UNSAVED","resources","ACTION_START_IMAGE_UPLOAD","ACTION_FAIL_IMAGE_UPLOAD","ACTION_SUCCESS_IMAGE_UPLOAD","CHOOSE_IMAGE","undefined","SIZE_IS_CHANGING","ACTION_START","pagesLoading","ACTION_FAIL","ACTION_SUCCESS","ADD_RESOURCE_VERSION","newDraft","connectedResources","currentResourceId","past","shift","future","UNDO_RESOURCE_VERSION","delta","pop","unshift","unpatch","REDO_RESOURCE_VERSION","AUTH_START","auth","AUTH_SUCCESS","accountInfo","AUTH_FAIL","AUTH_LOGOUT","CHANGE_BAR_SIZE","SET_CURRENT_TOP_TAB","SAVE_HOVERED_ELEMENT_RECT","checkAndCreatePath","parent","REMOVE_FROM_HOVERED_SIZES","checkAndRemoveElement","removeFromHoveredSizes","HOVER_ELEMENT","UNHOVER_ELEMENT","TOGGLE_FIND_MODE","MARK_REFRESHING","MARK_SHOULD_REFRESHING","CHOOSE_USER_IN_WEBSITE_SHARING","SET_CURRENT_SITEBUILDER_MODE","currentSiteBuilderMode","SAVE_MAIN_DATA","ADD_RESOURCE","DELETE_RESOURCE","REVERT_RESOURCE","SAVE_OBJECT","asyncSiteBuilderLayout","Promise","bind","App","onTryAutoSignup","routes","Switch","Route","isAuthenticated","Spinner","withRouter","src_store","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","baseURL","throttleMiddleware","defaultWait","defaultThrottleOption","store","next","shouldThrottle","wait","options","isNaN","leading","trailing","createStore","applyMiddleware","thunk","app","es","BrowserRouter","src_App","inIframe","self","top","root","document","getElementById","ReactDOM","render","addConnectedResources","newRequestedResourcesList","connectedResource","nextResourceItem","nextResourceObject","nextResourceDraft","ReserveWebsiteInn","requestedResources","taskId","pingTimeout","authInterval","WebSocket","heartbeat","clearTimeout","setTimeout","close","versions","pagesStructure","onopen","event","user","setInterval","noRequest","onmessage","parse","confirmSaved","markNotFoundResource","onclose","clearInterval","checkInterval","check","reRequestResourcesInterval","reRequestResources","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","requestedResource","return","nextProps","currentPageId","currentPageDraft","pageTemplateId","currentTemplateId","currentTemplateDraft","currentPluginId","currentPluginDraft","from","Set","getListOfNeededResources","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_loop","requestItem","requestedResourceItem","_iterator2","ReserveWebsiteDo","mainData","currentWebsiteItem","currentPageItem","currentTemplateItem","currentPluginItem","currentPageObject","currentTemplateObject","currentPluginObject","pageTemplateItem","pageTemplateObject","templatesStructure","pageTemplateName","currentWebsiteItemSettings","template","getEssentialData","page","StyleControls","objectSvg","svg","stack","substring","curObj","attr","selfclosing","svgStringToObj","viewBox","svgChildrenToElements","fill","el","load3"],"mappings":"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","file":"static/js/main.5a398756.chunk.js","sourcesContent":["import * as actions from './index'\nimport * as wsActions from '../../websocketActions'\nimport isEqual from 'lodash/isEqual'\nimport omit from 'lodash/omit'\nimport isObject from 'lodash/isObject'\nimport { current, resourceDraftIndex } from '../../utils/resourceTypeIndex'\n\nimport type { resourceType } from '../../store/reducer/reducer'\nvar htmlparser = require('htmlparser2')\n\nconst findElementIndex = (draft: resourceType): number => {\n    if (!draft.currentBox) return -1\n    if (draft.currentBox.length < 1) return -1\n    return draft.structure.findIndex(item => item.id === draft.currentBox)\n}\n\nconst findRouteElements = (\n    draft: resourceType,\n    mode: 'plugin' | 'template' | 'page'\n): Array<number> => {\n    const result = []\n    if (mode === 'plugin') {\n        result.push(0)\n    } else if (mode === 'template') {\n        draft.structure.forEach((item, index) => {\n            if (item.path.length === 0 || isEqual(item.path, ['element_01']))\n                result.push(index)\n        })\n    }\n    return result\n}\n\nexport const saveElementsStructure = (\n    type,\n    structure: $PropertyType<resourceType, 'structure'>\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!mD || !type || !resourceDraft || !structure) return\n\n    const newStructure = structure.map(item => {\n        const oldItem = resourceDraft.structure.find(\n            itemInn => itemInn.id === item.id\n        )\n        if (oldItem)\n            return {\n                ...item,\n                ...oldItem,\n                expanded: item.expanded,\n                path: item.path,\n            }\n        else return item\n    })\n    const draft = { ...resourceDraft, structure: newStructure }\n\n    const isNotForHistory = isEqual(\n        resourceDraft.structure.map(item =>\n            omit(item, ['expanded', 'children', 'itemPath'])\n        ),\n        newStructure.map(item =>\n            omit(item, ['expanded', 'children', 'itemPath'])\n        )\n    )\n    dispatch(actions.addResourceVersion(mD, type, draft, {}, isNotForHistory))\n}\n\nexport const saveElementsStructureFromBuilder = (\n    type,\n    structure: $PropertyType<resourceType, 'structure'>\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!mD || !type || !resourceDraft || !structure) return\n\n    const pageTemplateDraft = mD.pageTemplateDraft\n    const newValues = {}\n    const newStructure = structure.map(item => {\n        const oldItem = resourceDraft.structure.find(\n            itemInn => itemInn.id === item.id\n        )\n        let newItem = { ...item }\n        if (oldItem) newItem = { ...newItem, expanded: oldItem.expanded }\n\n        newValues[item.id] = {\n            ...pageTemplateDraft.values[item.id],\n            value: '',\n            menuItems: [],\n            currentMenuItem: '',\n            currentMenuId: 0,\n            // properties: {},\n\n            ...(resourceDraft.values[item.id] || {}),\n        }\n\n        return { ...newItem, path: item.path }\n    })\n    const draft = {\n        ...resourceDraft,\n        structure: newStructure,\n        values: newValues,\n    }\n\n    const isNotForHistory =\n        isEqual(\n            resourceDraft.structure.map(item =>\n                omit(item, ['expanded', 'children', 'itemPath'])\n            ),\n            newStructure.map(item =>\n                omit(item, ['expanded', 'children', 'itemPath'])\n            )\n        ) && isEqual(resourceDraft.values, draft.values)\n    dispatch(actions.addResourceVersion(mD, type, draft, {}, isNotForHistory))\n}\n\nexport const chooseBox = (type, item: string) => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!mD || !type || !item || !resourceDraft) return\n    const draft = { ...resourceDraft, currentBox: item }\n    dispatch(actions.addResourceVersion(mD, type, draft, {}, true))\n    dispatch(unhoverBox())\n}\n\nexport const changeBoxPropertyInStructure = (\n    type,\n    key: string | {},\n    value: any,\n    isNotForHistory?: boolean,\n    boxId?: string\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!mD || !type || !key || !resourceDraft) return\n    let elementIndex\n    if (boxId) {\n        elementIndex = resourceDraft.structure.findIndex(\n            item => item.id === boxId\n        )\n    } else {\n        elementIndex = findElementIndex(resourceDraft)\n    }\n    if (elementIndex < 0) return\n    if (key === 'tag') {\n        dispatch(\n            deleteFromHoveredSizes(mD[current[type]], [\n                resourceDraft.structure[elementIndex].id,\n            ])\n        )\n    }\n\n    let changes = {}\n    if (isObject(key) && !(typeof key === 'string' || key instanceof String))\n        changes = key\n    else changes[key.toString()] = value\n    const draft = {\n        ...resourceDraft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            {\n                ...resourceDraft.structure[elementIndex],\n                ...changes,\n            },\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n    }\n\n    dispatch(\n        actions.addResourceVersion(\n            mD,\n            type,\n            draft,\n            {\n                throttle: 100,\n            },\n            isNotForHistory\n        )\n    )\n}\n\nexport const changeBoxPropertyInValues = (\n    type,\n    key: string | {},\n    value: any,\n    isNotForHistory?: boolean,\n    boxId?: string\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!mD || !type || !key || !resourceDraft) return\n    let elementIndex\n    if (boxId) {\n        elementIndex = resourceDraft.structure.findIndex(\n            item => item.id === boxId\n        )\n    } else {\n        elementIndex = findElementIndex(resourceDraft)\n    }\n    if (elementIndex < 0) return\n    if (key === 'tag') {\n        dispatch(\n            deleteFromHoveredSizes(mD[current[type]], [\n                resourceDraft.structure[elementIndex].id,\n            ])\n        )\n    }\n\n    let changes = {}\n    if (isObject(key) && !(typeof key === 'string' || key instanceof String))\n        changes = key\n    else changes[key.toString()] = value\n    const draft = {\n        ...resourceDraft,\n        values: {\n            ...resourceDraft.values,\n            [resourceDraft.structure[elementIndex].id]: {\n                ...resourceDraft.values[\n                    resourceDraft.structure[elementIndex].id\n                ],\n                ...changes,\n            },\n        },\n    }\n\n    dispatch(\n        actions.addResourceVersion(\n            mD,\n            type,\n            draft,\n            {\n                throttle: 1000,\n            },\n            isNotForHistory\n        )\n    )\n}\n\nexport const saveHoveredElementRect = (path: Array<string>, size: Object) => ({\n    type: 'SAVE_HOVERED_ELEMENT_RECT',\n    path,\n    size,\n})\n\nconst deleteFromHoveredSizes = (currentResource, removedElements) => ({\n    type: 'REMOVE_FROM_HOVERED_SIZES',\n    currentResource,\n    removedElements,\n})\n\nexport const hoverBox = (id: string, mode: string, fromFrame?: boolean) => ({\n    type: 'HOVER_ELEMENT',\n    id,\n    mode,\n    fromFrame,\n})\n\nexport const unhoverBox = () => ({\n    type: 'UNHOVER_ELEMENT',\n})\n\nexport const toggleFindMode = (value?: string) => ({\n    type: 'TOGGLE_FIND_MODE',\n    value,\n})\n\nexport const addBox = (\n    mode: 'plugin' | 'template' | 'page',\n    type?: 'children' | 'inside' | 'text' | 'cmsVariable'\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[mode]]\n    if (!resourceDraft) return\n    const routeElements = findRouteElements(resourceDraft, mode)\n    let elementIndex = findElementIndex(resourceDraft)\n\n    let putInside\n    if (mode === 'plugin') {\n        if (elementIndex <= 0) {\n            elementIndex = 0\n            putInside = true\n        }\n    } else if (mode === 'template') {\n        if (elementIndex < 0)\n            elementIndex = routeElements[routeElements.length - 1]\n\n        if (resourceDraft.structure[elementIndex].id === 'element_01')\n            elementIndex = routeElements[routeElements.length - 1]\n\n        if (\n            resourceDraft.structure[elementIndex].path.length < 2 &&\n            !isEqual(resourceDraft.structure[elementIndex].path, ['element_02'])\n        )\n            putInside = true\n    }\n\n    const element = resourceDraft.structure[elementIndex]\n    if (element.isChildren) {\n        putInside = false\n    } else if (element.childrenTo) {\n        putInside = true\n    } else {\n        if (type === 'inside') putInside = true\n    }\n\n    if (type === 'inside') putInside = true\n\n    const newId = `element_${resourceDraft.currentId}`\n    const newCurrentId = resourceDraft.currentId + 1\n\n    const isCMSVariable =\n        resourceDraft.structure[elementIndex].id === 'element_02' ||\n        isEqual(resourceDraft.structure[elementIndex].path, ['element_02'])\n\n    const draft = {\n        ...resourceDraft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex + 1),\n            {\n                id: newId,\n                path: putInside\n                    ? [\n                          ...resourceDraft.structure[elementIndex].path,\n                          resourceDraft.structure[elementIndex].id,\n                      ]\n                    : [...resourceDraft.structure[elementIndex].path],\n                tag:\n                    type === 'text'\n                        ? 'text'\n                        : type === 'children'\n                        ? 'New children'\n                        : isCMSVariable\n                        ? 'New CMS variable'\n                        : 'div',\n                textMode: 'text',\n                text: type === 'text',\n                isChildren: type === 'children',\n                isCMSVariable: isCMSVariable,\n                isElementFromCMSVariable: type === 'cmsVariable',\n            },\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            [newId]: {\n                textContent: '',\n                properties: {},\n                propertiesString: '',\n                CMSVariableType: 'text',\n                CMSVariableSystemName: 'newCmsVariable',\n                CMSVariableDescription: 'New CMS variable description',\n                CMSVariableDefaultValue: 'New CMS variable default value',\n            },\n        },\n        currentId: newCurrentId,\n        currentBox: newId,\n    }\n    dispatch(actions.addResourceVersion(mD, mode, draft))\n}\n\nexport const deleteBox = (\n    type: 'page' | 'plugin' | 'template',\n    withChildren?: boolean\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const routeElements = findRouteElements(resourceDraft, type)\n    let elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0 || routeElements.includes(elementIndex)) return\n\n    const elementId = resourceDraft.structure[elementIndex].id\n\n    let draft = {}\n    const removedElements = [elementId]\n    if (withChildren) {\n        draft = {\n            ...resourceDraft,\n            structure: resourceDraft.structure.filter(item => {\n                const notRemove =\n                    elementId !== item.id && !item.path.includes(elementId)\n                if (!notRemove) removedElements.push(item.id)\n                return notRemove\n            }),\n        }\n    } else {\n        const newPageStructure = resourceDraft.structure.map(item => ({\n            ...item,\n            path: item.path.filter(pathItem => pathItem !== elementId),\n        }))\n\n        draft = {\n            ...resourceDraft,\n            structure: [\n                ...newPageStructure.slice(0, elementIndex),\n                ...newPageStructure.slice(elementIndex + 1),\n            ],\n        }\n    }\n    for (let item of removedElements) {\n        delete draft.values[item.id]\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n    dispatch(deleteFromHoveredSizes(mD[current[type]], removedElements))\n}\n\nexport const duplicateBox = (\n    type: 'page' | 'plugin' | 'template',\n    withChildren?: boolean\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const routeElements = findRouteElements(resourceDraft, type)\n    let elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0 || routeElements.includes(elementIndex)) return\n\n    const elementId = resourceDraft.structure[elementIndex].id\n\n    const sourceChildren = resourceDraft.structure.filter(item =>\n        item.path.includes(elementId)\n    )\n\n    const newId = `element_${resourceDraft.currentId}`\n    let draft = { currentId: resourceDraft.currentId + 1 }\n\n    if (withChildren) {\n        const idMatch = { [elementId]: newId }\n        const newValuesElements = { [newId]: resourceDraft.values[elementId] }\n        const newChildren = sourceChildren\n            .map(item => {\n                let newItemId = `element_${draft.currentId}`\n                draft.currentId += 1\n                idMatch[item.id] = newItemId\n                newValuesElements[newItemId] = resourceDraft.values[item.id]\n                return {\n                    ...item,\n                    id: newItemId,\n                }\n            })\n            .map(item => {\n                return {\n                    ...item,\n                    // $FlowFixMe\n                    path: item.path.map(pathItem => {\n                        if (idMatch[pathItem]) {\n                            return idMatch[pathItem]\n                        } else {\n                            return pathItem\n                        }\n                    }),\n                }\n            })\n\n        draft = {\n            ...resourceDraft,\n            ...draft,\n            structure: [\n                ...resourceDraft.structure.slice(\n                    0,\n                    elementIndex + sourceChildren.length\n                ),\n                {\n                    ...resourceDraft.structure[elementIndex],\n                    id: newId,\n                },\n                ...newChildren,\n                ...resourceDraft.structure.slice(\n                    elementIndex + sourceChildren.length\n                ),\n            ],\n            values: {\n                ...resourceDraft.values,\n                ...newValuesElements,\n            },\n        }\n    } else {\n        draft = {\n            ...resourceDraft,\n            ...draft,\n            structure: [\n                ...resourceDraft.structure.slice(\n                    0,\n                    elementIndex + sourceChildren.length\n                ),\n                {\n                    ...resourceDraft.structure[elementIndex],\n                    id: newId,\n                },\n                ...resourceDraft.structure.slice(\n                    elementIndex + sourceChildren.length\n                ),\n            ],\n            values: {\n                ...resourceDraft.values,\n                [newId]: resourceDraft.values[elementId],\n            },\n        }\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n\nexport const splitText = (type, start: number, end: number) => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0) return\n\n    let draft = { currentId: resourceDraft.currentId }\n\n    let newId\n\n    const text = resourceDraft.structure[elementIndex].textContent\n    if (!text) return\n    const textContent0 = text.substr(0, start)\n    const textContent1 = text.substr(start, end - start)\n    const textContent2 = text.substr(end)\n\n    const newElements = [\n        {\n            ...resourceDraft.structure[elementIndex],\n        },\n    ]\n\n    const newValues = {\n        [elementIndex]: {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent0,\n        },\n    }\n\n    if (textContent1.length > 0) {\n        newId = `element_${draft.currentId}`\n        draft.currentId = draft.currentId + 1\n        newElements.push({\n            ...resourceDraft.structure[elementIndex],\n            id: newId,\n        })\n        newValues[newId] = {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent1,\n        }\n    }\n\n    if (textContent2.length > 0 || textContent1.length === 0) {\n        newId = `element_${draft.currentId}`\n        draft.currentId = draft.currentId + 1\n        newElements.push({\n            ...resourceDraft.structure[elementIndex],\n            id: newId,\n        })\n        newValues[newId] = {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent2,\n        }\n    }\n\n    draft = {\n        ...resourceDraft,\n        ...draft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            ...newElements,\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            ...newValues,\n        },\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n\nexport const textToSpan = (type, start: number, end: number) => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0) return\n\n    let newId\n    let draft = { currentId: resourceDraft.currentId }\n\n    const text = resourceDraft.structure[elementIndex].textContent\n    if (!text) return\n    const textContent0 = text.substr(0, start)\n    const textContent1 = text.substr(start, end - start)\n    const textContent2 = text.substr(end)\n\n    const newElements = [\n        {\n            ...resourceDraft.structure[elementIndex],\n        },\n    ]\n\n    const newValues = {\n        [elementIndex]: {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent0,\n        },\n    }\n\n    const spanId = `element_${draft.currentId}`\n    draft.currentId = draft.currentId + 1\n    newElements.push({\n        id: spanId,\n        path: [...resourceDraft.structure[elementIndex].path],\n        tag: 'span',\n        text: false,\n    })\n\n    newValues[spanId] = {\n        textContent: '',\n        style: '',\n        properties: {},\n    }\n\n    newId = `element_${draft.currentId}`\n    draft.currentId = draft.currentId + 1\n    newElements.push({\n        ...resourceDraft.structure[elementIndex],\n        path: [...resourceDraft.structure[elementIndex].path, spanId],\n        textContent: textContent1,\n        id: newId,\n    })\n\n    newValues[newId] = {\n        ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n        textContent: textContent1,\n    }\n\n    if (textContent2.length > 0) {\n        newId = `element_${draft.currentId}`\n        draft.currentId = draft.currentId + 1\n        newElements.push({\n            ...resourceDraft.structure[elementIndex],\n            textContent: textContent2,\n            id: newId,\n        })\n        newValues[newId] = {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent2,\n        }\n    }\n\n    draft = {\n        ...resourceDraft,\n        ...draft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            ...newElements,\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            ...newValues,\n        },\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n//Menu\n\nexport const changeMenuItemProperty = (\n    type,\n    key: string,\n    value: string,\n    itemId?: string\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resource = mD[resourceDraftIndex[type]]\n\n    if (!resource) return\n\n    const elementIndex = findElementIndex(resource)\n    if (elementIndex < 0) return\n    const elementId = resource.structure[elementIndex].id\n\n    if (!resource.values[elementId].menuItems) return\n    const newMenuItems = resource.values[elementId].menuItems.map(item => {\n        if (\n            item.id ===\n            (itemId ? itemId : resource.values[elementId].currentMenuItem)\n        ) {\n            return { ...item, [key]: value }\n        } else {\n            return item\n        }\n    })\n    if (!isEqual(newMenuItems, resource.values[elementId].menuItems)) {\n        dispatch(changeBoxPropertyInValues(type, 'menuItems', newMenuItems))\n    }\n}\nexport const markRefreshing = (refreshing: boolean) => ({\n    type: 'MARK_REFRESHING',\n    refreshing,\n})\n\nexport const markShouldRefreshing = (value?: boolean) => ({\n    type: 'MARK_SHOULD_REFRESHING',\n    value,\n})\n\nexport const mergeBoxToPlugin = (\n    type: 'page' | 'plugin' | 'template',\n    onlyChildren?: boolean\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n\n    if (!resourceDraft) return\n    const routeElements = findRouteElements(resourceDraft, type)\n    let elementIndex = findElementIndex(resourceDraft)\n    if (\n        elementIndex <= 0 ||\n        (!onlyChildren && routeElements.includes(elementIndex))\n    )\n        return\n\n    const elementId = resourceDraft.structure[elementIndex].id\n    let currentId = 1\n    const newResourcesIds = ['element_0']\n    const oldResourcesIds = ['element_0']\n    const resourceDataValues = {}\n\n    const resourceDataStructure = resourceDraft.structure\n        .filter(\n            item =>\n                (!onlyChildren && item.id === elementId) ||\n                item.path.includes(elementId)\n        )\n        .map(item => {\n            oldResourcesIds.push(item.id)\n            const newItem = { ...item, id: `element_${currentId}` }\n            resourceDataValues[newItem.id] = {\n                ...resourceDraft.values[item.id],\n            }\n            if (item.id === elementId) {\n                newItem.path = ['element_0']\n            } else {\n                newItem.path = [\n                    'element_0',\n                    ...newItem.path.slice(\n                        newItem.path.indexOf(elementId) + (onlyChildren ? 1 : 0)\n                    ),\n                ]\n            }\n            newResourcesIds.push(newItem.id)\n            currentId++\n            return newItem\n        })\n        .map(item => ({\n            ...item,\n            path: item.path.map(\n                id => newResourcesIds[oldResourcesIds.indexOf(id)]\n            ),\n        }))\n    if (resourceDataStructure.length === 0) return\n    const resourceData = {\n        structure: [\n            {\n                id: 'element_0',\n                path: [],\n                tag: 'Main element',\n                textMode: '',\n            },\n            ...resourceDataStructure,\n        ],\n        values: {\n            ...resourceDataValues,\n            element_0: {\n                properties: {},\n                propertiesString: '',\n                textContent: '',\n            },\n        },\n        currentId,\n    }\n\n    const newPluginName =\n        prompt('Name the new plugin', 'New plugin') || 'New plugin'\n\n    dispatch(\n        wsActions.addResource('plugin', false, newPluginName, resourceData)\n    )\n\n    const draft = {\n        ...resourceDraft,\n        structure: [\n            ...resourceDraft.structure.slice(\n                0,\n                elementIndex + (onlyChildren ? 1 : 0)\n            ),\n            {\n                ...resourceDraft.structure[elementIndex],\n                path: [\n                    ...resourceDraft.structure[elementIndex].path,\n                    ...(onlyChildren\n                        ? [resourceDraft.structure[elementIndex].id]\n                        : []),\n                ],\n                tag: newPluginName,\n                text: false,\n                id: oldResourcesIds[1],\n            },\n            ...resourceDraft.structure.slice(\n                elementIndex +\n                    (onlyChildren ? 1 : 0) +\n                    resourceDataStructure.length\n            ),\n        ],\n        values: {\n            ...resourceDraft.values,\n            [oldResourcesIds[1]]: {\n                textContent: '',\n                propertiesString: '',\n                properties: {},\n            },\n        },\n    }\n    for (let i = 2; i < oldResourcesIds.length; i++) {\n        delete draft.values[oldResourcesIds[i]]\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft, { throttle: 1000 }))\n}\n\nexport const dissolvePluginToBox = type => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    let elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0) return\n\n    // const elementId = resourceDraft.structure[elementIndex].id\n\n    const plugin = mD.pluginsStructure.find(\n        item => item.name === resourceDraft.structure[elementIndex].tag\n    )\n    if (!plugin) return\n    if (!mD.resourcesObjects[plugin.id]) return\n\n    const pluginResource = !mD.resourcesObjects[plugin.id].present.structure\n        ? mD.resourcesObjects[plugin.id].draft\n        : mD.resourcesObjects[plugin.id].present\n\n    let currentId = resourceDraft.currentId\n    const newResourcesIds = []\n    const oldResourcesIds = []\n    const pluginDataValues = {}\n\n    const pluginDataStructure = pluginResource.structure\n        .filter(item => item.path.length > 0)\n        .map(item => {\n            oldResourcesIds.push(item.id)\n            const newItem = {\n                ...item,\n                id: `element_${currentId}`,\n                path: [...item.path.slice(1)],\n            }\n            pluginDataValues[newItem.id] = resourceDraft.values[item.id]\n\n            newResourcesIds.push(newItem.id)\n            currentId++\n            return newItem\n        })\n        .map(item => ({\n            ...item,\n            path: [\n                ...resourceDraft.structure[elementIndex].path,\n                ...item.path.map(\n                    id => newResourcesIds[oldResourcesIds.indexOf(id)]\n                ),\n            ],\n        }))\n\n    const draft = {\n        ...resourceDraft,\n        currentId,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            ...pluginDataStructure,\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            ...pluginDataValues,\n        },\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n\nexport const setCurrentSiteBuilderMode = (mode: string) => ({\n    type: 'SET_CURRENT_SITEBUILDER_MODE',\n    mode,\n})\n\nexport const parseHTML = (type, value: string) => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0) return\n    let draft = { currentId: resourceDraft.currentId }\n\n    const htmlArray = htmlparser.parseDOM(value)\n    const newElements = []\n    const newElementsValues = {}\n    const parseToWebsiter = (curArray, path) => {\n        curArray.forEach(item => {\n            if (!(item.type === 'text' && item.data.trim() === '')) {\n                if (item.type === 'text' || item.type === 'tag') {\n                    const newId = `element_${draft.currentId}`\n                    draft.currentId = draft.currentId + 1\n                    const properties = item.attribs\n                        ? omit(item.attribs, 'style')\n                        : {}\n                    const newElement = {\n                        id: newId,\n                        path,\n                        tag: item.name || 'div',\n                        text: false,\n                    }\n                    const newElementValues = {\n                        textContent: '',\n                        style: item.attribs ? item.attribs.style || '' : '',\n                        properties,\n                        propertiesString: JSON.stringify(properties),\n                    }\n                    if (item.type === 'text') {\n                        newElement.tag = 'text'\n                        newElement.text = true\n                        newElementValues.textMode = 'text'\n                        newElementValues.textContent = item.data\n                    }\n                    newElements.push(newElement)\n                    newElementsValues[newId] = newElementValues\n                    if (item.children)\n                        parseToWebsiter(item.children, [...path, newId])\n                }\n            }\n        })\n    }\n    parseToWebsiter(htmlArray, resourceDraft.structure[elementIndex].path)\n    draft = {\n        ...resourceDraft,\n        ...draft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            ...newElements,\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            ...newElementsValues,\n        },\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n\n/////////////////////OLDOLDOLDOLDOLD\n// export const changeElementStyleValue = (\n//     index: number,\n//     key: string,\n//     value: any,\n//     elementId: string\n// ) => ({\n//     type: actionTypes.CHANGE_ELEMENT_STYLE_VALUE,\n//     index,\n//     key,\n//     value,\n//     elementId,\n// })\n\n// export const addElementStyleValue = (index: number, elementId: string) => ({\n//     type: actionTypes.ADD_ELEMENT_STYLE_VALUE,\n//     index,\n//     elementId,\n// })\n\n// export const deleteElementStyleValue = (index: number, elementId: string) => ({\n//     type: actionTypes.DELETE_ELEMENT_STYLE_VALUE,\n//     index,\n//     elementId,\n// })\n\n// export const changeElementPropertyValue = (\n//     value: any,\n//     key: string,\n//     isSection?: boolean,\n//     isNotForHistory?: boolean\n// ) => ({\n//     type: actionTypes.CHANGE_ELEMENT_PROPERTY_VALUE,\n//     value,\n//     key,\n//     isSection,\n//     isNotForHistory,\n// })\n\n// export const builderZoomOut = () => ({ type: actionTypes.BUILDER_ZOOM_OUT })\n// export const builderZoomIn = () => ({ type: actionTypes.BUILDER_ZOOM_IN })\n// export const builderZoomReset = () => ({ type: actionTypes.BUILDER_ZOOM_RESET })\n\n// export const saveToHistory = () => ({ type: actionTypes.SAVE_TO_HISTORY })\n\n// export const loadCurrentPageToBuilder = (\n//     _id: ?string,\n//     resourcesObjects?: Object,\n//     pageObject?: Object\n// ) => ({\n//     type: actionTypes.LOAD_CURRENT_PAGE_TO_BUILDER,\n//     _id,\n//     resourcesObjects,\n//     pageObject,\n// })\n","import axios from 'axios'\nimport Cookies from 'universal-cookie'\nimport jwt from 'jsonwebtoken'\n\nimport * as actions from './index'\n\nimport cloneDeep from 'lodash/cloneDeep'\nimport { webSocket } from '../../components/ReserveWebsite/ReserveWebsite'\n\nconst cookies = new Cookies()\n\nexport const authStart = () => ({\n    type: 'AUTH_START',\n})\n\nexport const authSuccess = (data: Object) => ({\n    type: 'AUTH_SUCCESS',\n    data,\n})\n\nexport const authFail = (error: string) => ({\n    type: 'AUTH_FAIL',\n    error,\n})\n\nexport const deleteStart = () => ({\n    type: 'ACTION_START',\n})\n\nexport const deleteSuccess = () => ({\n    type: 'ACTION_SUCCESS',\n})\n\nexport const deleteFail = (error: string) => ({\n    type: 'ACTION_FAIL',\n    error,\n})\n\nexport const deleteUser = () => (dispatch: Object) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (window.confirm('Are you sure you would like to delete your account?'))\n        if (\n            window.confirm(\n                'This action cannot be reverted. All your websites will be deleted.'\n            )\n        )\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'deleteUser',\n                })\n            )\n}\n\nexport const logout = (all?: boolean) => (dispatch: Object) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (!all) {\n        cookies.remove('auth_token')\n        axios.defaults.headers.common['x-auth-token'] = null\n        dispatch(logoutDo())\n    } else {\n        if (webSocket) {\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'logoutAll',\n                })\n            )\n        }\n    }\n}\n\nconst logoutDo = () => ({\n    type: 'AUTH_LOGOUT',\n})\n\nexport const authCheckState = () => (dispatch: Object) => {\n    sessionStorage.setItem('systemRefresh', '0')\n    const tryWebsiter = cookies.get('try_websiter')\n    console.log(tryWebsiter)\n    if (tryWebsiter) {\n        cookies.remove('try_websiter', {\n            path: '/',\n        })\n        sessionStorage.setItem('tryWebsiter', '1')\n        dispatch(\n            authSuccess({\n                _id: 'try',\n            })\n        )\n        return\n    }\n    const token = cookies.get('auth_token')\n    const rememberMe = cookies.get('rememberme')\n    if (rememberMe) {\n        cookies.remove('rememberme', {\n            path: '/',\n        })\n        if (rememberMe === 'false') {\n            cookies.remove('auth_token', {\n                path: '/',\n            })\n        }\n    }\n    const userId = jwt.decode(token)\n    axios.defaults.headers.post['Content-Type'] = 'application/json'\n    axios.defaults.headers.put['Content-Type'] = 'application/json'\n    axios.defaults.headers.delete['Content-Type'] = 'application/json'\n    axios.defaults.headers.common.Accept = 'application/json'\n\n    if (!token || !userId) {\n        dispatch(logout())\n    } else {\n        axios.defaults.headers.common['x-auth-token'] = token\n        axios.defaults.headers.post['x-auth-token'] = token\n        axios.defaults.headers.get['x-auth-token'] = token\n        axios.defaults.headers.delete['x-auth-token'] = token\n        axios.defaults.headers.put['x-auth-token'] = token\n        dispatch(authStart())\n        return axios\n            .get('/api/users')\n            .then(response => {\n                sessionStorage.removeItem('tryWebsiter')\n                dispatch(\n                    authSuccess({\n                        _id: userId._id,\n                    })\n                )\n            })\n            .catch(err => {\n                cookies.remove('auth_token', {\n                    path: '/',\n                })\n                dispatch(authFail(err.message))\n            })\n    }\n}\n\nexport const changeBarSizeDo = (key: string, value: number) => ({\n    type: 'CHANGE_BAR_SIZE',\n    key,\n    value,\n})\n\nexport const savePropertiesOnLeave = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter')) return\n    const { mD, barSizes } = getState()\n    webSocket.send(\n        JSON.stringify({\n            messageCode: 'saveSettings',\n            settings: {\n                ...mD.userObject.settings,\n                barSizes,\n            },\n        })\n    )\n}\n\nexport const changeBarSize = (initiator?: { key: string, value: number }) => (\n    dispatch: Object,\n    getState\n) => {\n    const { barSizes } = getState()\n    const width = Math.max(window.innerWidth, 700),\n        height = window.innerHeight\n    let value, dif, dif2, value2, value3\n\n    if (!initiator) {\n        if (barSizes.height > height - 50) {\n            dispatch(actions.changeBarSizeDo('height', height - 50))\n        }\n        if (barSizes.width > width - 100) {\n            dispatch(actions.changeBarSizeDo('width', width - 100))\n        }\n        if (barSizes.width + barSizes.width2 > width - 50) {\n            dispatch(\n                actions.changeBarSizeDo('width2', width - barSizes.width - 50)\n            )\n        }\n    } else {\n        switch (initiator.key) {\n            case 'height':\n                value = initiator.value\n                if (value < 50) value = 50\n                if (value > height - 50) value = height - 50\n                dispatch(actions.changeBarSizeDo('height', value))\n                break\n            case 'width':\n                value = initiator.value\n                if (value < 50) value = 50\n                dif = value - barSizes.width\n                value2 = barSizes.width2 - dif\n                value3 = barSizes.width3\n                if (value2 < 50) {\n                    dif2 = value2 - 50\n                    value2 = 50\n                    value3 = barSizes.width3 + dif2\n                    if (value3 < 50) value3 = 50\n                }\n                if (value + value2 + value3 + 50 > width) {\n                    value = width - 150\n                    value2 = 50\n                    value3 = 50\n                }\n                dispatch(actions.changeBarSizeDo('width', value))\n                dispatch(actions.changeBarSizeDo('width2', value2))\n                dispatch(actions.changeBarSizeDo('width3', value3))\n                break\n            case 'width2':\n                value2 = initiator.value\n                value = barSizes.width\n                dif = value2 - 50\n                if (dif < 0) {\n                    value = value + dif\n                    if (value < 50) value = 50\n                    dif2 = value - barSizes.width\n                    value3 = barSizes.width3 - dif2\n                    value2 = 50\n                }\n                dif = value + value2 - barSizes.width - barSizes.width2\n                value3 = barSizes.width3 - dif\n                if (value3 < 50) value3 = 50\n                if (value + value2 + value3 + 50 > width) {\n                    value2 = width - value - 100\n                }\n                dispatch(actions.changeBarSizeDo('width', value))\n                dispatch(actions.changeBarSizeDo('width2', value2))\n                dispatch(actions.changeBarSizeDo('width3', value3))\n                break\n            case 'width3':\n                value3 = initiator.value\n                value = barSizes.width\n                value2 = barSizes.width2\n                dif = value3 - 50\n                if (dif < 0) {\n                    value2 = value2 + dif\n                    dif2 = value2 - 50\n                    if (dif2 < 0) {\n                        value = value + dif2\n                        if (value < 50) value = 50\n                        value2 = 50\n                    }\n                    value3 = 50\n                }\n                if (value + value2 + value3 + 50 > width) {\n                    value3 = width - value - value2 - 50\n                }\n                dispatch(actions.changeBarSizeDo('width', value))\n                dispatch(actions.changeBarSizeDo('width2', value2))\n                dispatch(actions.changeBarSizeDo('width3', value3))\n                break\n            default:\n                break\n        }\n    }\n}\n\nexport const switchTooltips = () => (dispatch, getState) => {\n    const { mD } = getState()\n    const userObject = cloneDeep(mD.userObject)\n    userObject.settings.tooltipsOff = !userObject.settings.tooltipsOff\n    dispatch(actions.saveObject(userObject))\n}\n","import cloneDeep from 'lodash/cloneDeep'\n\nexport const chooseWebsite = id => (dispatch, getState) => {\n    const { mD } = getState()\n    const userObject = cloneDeep(mD.userObject)\n    userObject.settings.currentWebsite = id\n    dispatch(saveObject(userObject))\n}\n\nexport const saveObject = data => ({\n    type: 'SAVE_OBJECT',\n    data,\n})\n\nexport const chooseUserInWebsiteSharing = (id: string) => ({\n    type: 'CHOOSE_USER_IN_WEBSITE_SHARING',\n    id,\n})\n\nexport const setSizeIsChanging = (isChanging: boolean) => ({\n    type: 'SIZE_IS_CHANGING',\n    isChanging,\n})\n\nexport const setCurrentTopTab = (currentTopTab: string) => ({\n    type: 'SET_CURRENT_TOP_TAB',\n    currentTopTab,\n})\n\nexport const saveMainData = mD => ({\n    type: 'SAVE_MAIN_DATA',\n    mD,\n})\n","import axios from 'axios'\nimport { webSocket } from '../../components/ReserveWebsite/ReserveWebsite'\n\nconst actionStartImageUpload = () => ({\n    type: 'ACTION_START_IMAGE_UPLOAD',\n})\n\nconst actionSuccessImageUpload = () => ({\n    type: 'ACTION_SUCCESS_IMAGE_UPLOAD',\n})\n\nconst actionFailImageUpload = (error: string) => ({\n    type: 'ACTION_FAIL_IMAGE_UPLOAD',\n    error,\n})\n\nconst getSignedRequest = file => (dispatch: Object, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (!mD.currentWebsiteId) return\n    let name =\n        mD.currentWebsiteId +\n        '/' +\n        file.name.replace(/([^a-zA-Z0-9\\\\.\\\\-])/g, '_')\n\n    let namePrefix = ''\n    let k = 0\n\n    const checkName = () =>\n        mD.currentWebsiteObject.images.findIndex(\n            image => name + namePrefix === image.name\n        )\n    while (checkName() >= 0) {\n        k++\n        namePrefix = '_' + k\n    }\n\n    const fileDetails = {\n        size: file.size,\n        name: name + namePrefix,\n        label: file.name + namePrefix,\n        type: file.type,\n        file,\n    }\n\n    return axios\n        .post('/api/sign-s3', {\n            fileName: fileDetails.name,\n            fileType: file.type,\n            fileSize: fileDetails.size,\n            websiteId: mD.currentWebsiteId,\n        })\n        .then(response => {\n            dispatch(\n                uploadFile(\n                    fileDetails,\n                    response.data.signedRequest,\n                    response.data.url,\n                    mD.currentWebsiteId\n                )\n            )\n        })\n        .catch(err => {\n            dispatch(actionFailImageUpload(err.message))\n            if (err.response.status === 400) alert(err.response.data)\n        })\n}\n\nconst uploadFile = (fileDetails, signedRequest, url, websiteId) => (\n    dispatch: Object\n) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    return axios\n        .put(signedRequest, fileDetails.file, {\n            headers: {\n                'Content-Type': 'multipart/form-data',\n            },\n        })\n        .then(response => {\n            if (webSocket)\n                webSocket.send(\n                    JSON.stringify({\n                        messageCode: 'addImage',\n                        _id: websiteId,\n                        size: fileDetails.size,\n                        name: fileDetails.name,\n                        label: fileDetails.label,\n                        type: fileDetails.type,\n                        url,\n                    })\n                )\n            dispatch(actionSuccessImageUpload())\n        })\n        .catch(err => {\n            dispatch(actionFailImageUpload(err.message))\n        })\n}\n\nexport const chooseImage = (image: string) => ({\n    type: 'CHOOSE_IMAGE',\n    image,\n})\n\nexport const imageUpload = (\n    files: Array<{ type: string, size: number, name: string }>\n) => (dispatch: Object) => {\n    const file = files[0]\n\n    if (file == null) {\n        return alert('No file selected.')\n    }\n    if (file.type.split('/')[0] !== 'image') {\n        return alert('File is not an image.')\n    }\n    dispatch(actionStartImageUpload())\n    dispatch(getSignedRequest(file))\n}\n","import * as actions from './'\nimport { current } from '../../utils/resourceTypeIndex'\nimport cloneDeep from 'lodash/cloneDeep'\n\nexport const chooseResource = (\n    id: string,\n    resourceType: 'plugin' | 'page' | 'template'\n) => (dispatch, getState) => {\n    const { mD } = getState()\n    const userObject = cloneDeep(mD.userObject)\n    if (!userObject.settings.websites[userObject.settings.currentWebsite])\n        userObject.settings.websites[userObject.settings.currentWebsite] = {}\n    userObject.settings.websites[userObject.settings.currentWebsite][\n        current[resourceType]\n    ] = id\n    dispatch(actions.saveObject(userObject))\n}\n\nexport const addResourceVersion = (\n    mD,\n    resourceType,\n    draft,\n    meta,\n    isNotForHistory?: boolean\n) => ({\n    type: 'ADD_RESOURCE_VERSION',\n    mD,\n    resourceType,\n    draft,\n    meta,\n    isNotForHistory,\n})\n\nexport const undoResourceVersion = () => ({\n    type: 'UNDO_RESOURCE_VERSION',\n})\n\nexport const redoResourceVersion = () => ({\n    type: 'REDO_RESOURCE_VERSION',\n})\n\nexport const removeResourceFromUnsaved = data => ({\n    type: 'REMOVE_RESOURCE_FROM_UNSAVED',\n    _id: data._id,\n})\n","import cloneDeep from 'lodash/cloneDeep'\nimport omit from 'lodash/omit'\nimport isEmpty from 'lodash/isEmpty'\n\nconst diffpatcher = require('jsondiffpatch/dist/jsondiffpatch.umd.js').create({\n    objectHash: obj => obj.id,\n    propertyFilter: (name, context) => name !== '__patch__',\n})\n\nexport const addResource = (data: Object) => (dispatch, getState) => {\n    dispatch(addResourceDo(data))\n}\n\nexport const addResourceDo = (data: Object) => ({\n    type: 'ADD_RESOURCE',\n    data,\n})\n\nexport const deleteResource = (data: Object) => ({\n    type: 'DELETE_RESOURCE',\n    data,\n})\n\nexport const revertResource = (data: Object) => ({\n    type: 'REVERT_RESOURCE',\n    data,\n})\n\nexport const updateUser = (data: Object, webSocket) => (dispatch, getState) => {\n    if (data) {\n        const { mD } = getState()\n        const currentUser = omit(\n            cloneDeep(mD.resourcesObjects[data.resourceId]),\n            ['settings']\n        )\n        if (currentUser) {\n            if (currentUser.__v === data.resource.__v - 1) {\n                currentUser.websites = diffpatcher.patch(\n                    currentUser.websites,\n                    data.resource.__patch__\n                )\n                currentUser.__v = data.resource.__v\n                dispatch(addResource(currentUser, mD))\n                return\n            }\n        }\n        requestResource(data.resource._id, data.type, webSocket)\n    }\n}\n\nexport const updateWebsite = (data: Object, webSocket) => (\n    dispatch,\n    getState\n) => {\n    if (data) {\n        const { mD } = getState()\n        const currentWebsite = cloneDeep(mD.resourcesObjects[data.resourceId])\n        if (currentWebsite) {\n            if (currentWebsite.__v === data.resource.__v - 1) {\n                const newWebsite = diffpatcher.patch(\n                    currentWebsite,\n                    data.resource.__patch__\n                )\n                newWebsite.__v = data.resource.__v\n                dispatch(addResource(newWebsite, mD))\n                return\n            }\n        }\n        requestResource(data.resource._id, data.type, webSocket)\n    }\n}\n\nexport const updateResource = (data: Object, webSocket) => (\n    dispatch,\n    getState\n) => {\n    if (data) {\n        const { mD } = getState()\n        const currentResource = cloneDeep(mD.resourcesObjects[data.resourceId])\n        if (currentResource) {\n            if (currentResource.__v === data.resource.__v - 1) {\n                if (!isEmpty(data.resource.__patch__)) {\n                    currentResource.draft = diffpatcher.patch(\n                        currentResource.draft,\n                        data.resource.__patch__\n                    )\n                }\n                currentResource.__v = data.resource.__v\n                dispatch(addResource(currentResource, mD))\n                return\n            }\n        }\n        requestResource(data.resource._id, data.type, webSocket)\n    }\n}\n\nconst requestResource = (id, type, webSocket) => {\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'requestResource',\n                id,\n                type,\n            })\n        )\n    }\n}\n","export {\n    chooseBox,\n    addBox,\n    deleteBox,\n    duplicateBox,\n    saveElementsStructure,\n    saveElementsStructureFromBuilder,\n    changeBoxPropertyInStructure,\n    changeBoxPropertyInValues,\n    hoverBox,\n    unhoverBox,\n    saveHoveredElementRect,\n    splitText,\n    textToSpan,\n    changeMenuItemProperty,\n    markRefreshing,\n    mergeBoxToPlugin,\n    dissolvePluginToBox,\n    toggleFindMode,\n    markShouldRefreshing,\n    setCurrentSiteBuilderMode,\n    parseHTML,\n} from './builder'\n\nexport {\n    logout,\n    authCheckState,\n    deleteUser,\n    changeBarSize,\n    changeBarSizeDo,\n    savePropertiesOnLeave,\n    switchTooltips,\n} from './auth'\n\nexport {\n    setSizeIsChanging,\n    chooseWebsite,\n    setCurrentTopTab,\n    chooseUserInWebsiteSharing,\n    saveObject,\n    saveMainData,\n} from './website'\n\nexport { imageUpload, chooseImage } from './images'\n\nexport {\n    chooseResource,\n    addResourceVersion,\n    undoResourceVersion,\n    redoResourceVersion,\n    removeResourceFromUnsaved,\n} from './resources'\n\nexport {\n    addResource,\n    updateUser,\n    updateWebsite,\n    updateResource,\n    deleteResource,\n    revertResource,\n} from './webSocket'\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Button\":\"LoginButton_Button__2dj44\",\"Success\":\"LoginButton_Success__21MoZ\",\"Danger\":\"LoginButton_Danger__2V7Lr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Auth\":\"Auth_Auth__3LJcp\",\"Form\":\"Auth_Form__2cblE\",\"Title\":\"Auth_Title__akRbA\",\"Subtitle\":\"Auth_Subtitle__2ymfd\",\"ActionBlock\":\"Auth_ActionBlock__3jKGi\",\"Middle\":\"Auth_Middle__J8yom\",\"RememberForgot\":\"Auth_RememberForgot__vAgsm\",\"ForgotPassword\":\"Auth_ForgotPassword__2P2hF\",\"Link\":\"Auth_Link__1O5md\",\"RememberMe\":\"Auth_RememberMe__3xI2n\",\"RememberMeLabel\":\"Auth_RememberMeLabel__2SEKu\",\"Container\":\"Auth_Container__KMvOh\",\"socialButtons\":\"Auth_socialButtons__37I7_\"};","import isEmpty from 'lodash/isEmpty'\n\nexport const checkIfCapital = (char: string) => {\n    if (char === char.toUpperCase() && char !== char.toLowerCase()) {\n        return true\n    }\n}\n\nexport const getCurrentResourceValue = (id: string, resourcesObjects: {}) =>\n    id\n        ? resourcesObjects[id]\n            ? isEmpty(resourcesObjects[id].present)\n                ? resourcesObjects[id].draft\n                : resourcesObjects[id].present\n            : null\n        : null\n\nfunction _objectSpread(target) {\n    for (var i = 1; i < arguments.length; i++) {\n        var source = arguments[i] != null ? arguments[i] : {}\n        var ownKeys = Object.keys(source)\n        if (typeof Object.getOwnPropertySymbols === 'function') {\n            ownKeys = ownKeys.concat(\n                //eslint-disable-next-line\n                Object.getOwnPropertySymbols(source).filter(function(sym) {\n                    return Object.getOwnPropertyDescriptor(\n                        source,\n                        sym\n                        // $FlowFixMe\n                    ).enumerable\n                })\n            )\n        }\n        //eslint-disable-next-line\n        ownKeys.forEach(function(key) {\n            // $FlowFixMe\n            _defineProperty(target, key, source[key])\n        })\n    }\n    return target\n}\n\nfunction _defineProperty(obj, key, value) {\n    // $FlowFixMe\n    if (key in obj) {\n        Object.defineProperty(obj, key, {\n            value: value,\n            enumerable: true,\n            configurable: true,\n            writable: true,\n        })\n    } else {\n        // $FlowFixMe\n        obj[key] = value\n    }\n    return obj\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n    if (source == null) return {}\n    var target = _objectWithoutPropertiesLoose(source, excluded)\n    var key, i\n    if (Object.getOwnPropertySymbols) {\n        var sourceSymbolKeys = Object.getOwnPropertySymbols(source)\n        for (i = 0; i < sourceSymbolKeys.length; i++) {\n            key = sourceSymbolKeys[i]\n            if (excluded.indexOf(key) >= 0) continue\n            if (!Object.prototype.propertyIsEnumerable.call(source, key))\n                continue\n            // $FlowFixMe\n            target[key] = source[key]\n        }\n    }\n    return target\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {}\n    var target = {}\n    var sourceKeys = Object.keys(source)\n    var key, i\n    for (i = 0; i < sourceKeys.length; i++) {\n        key = sourceKeys[i]\n        if (excluded.indexOf(key) >= 0) continue\n        target[key] = source[key]\n    }\n    return target\n}\n// $FlowFixMe\nexport function buildTree(items) {\n    var buildItem = function buildItem(item) {\n        // var path = item.path,\n        var data = _objectWithoutProperties(item, ['path'])\n        // $FlowFixMe\n        return _objectSpread({}, data, {\n            children: items\n                .filter(function(child) {\n                    return child.path[child.path.length - 1] === item.id\n                })\n                .map(function(child) {\n                    return buildItem(child)\n                }),\n        })\n    }\n\n    var tree = items\n        .filter(function(item) {\n            return item.path.length === 0\n        })\n        .map(function(item) {\n            return buildItem(item)\n        })\n    return tree\n}\n\nexport const getInheritedPropertyName = (value: string) => {\n    const length = value.length\n    if (length > 2) {\n        if (value.charAt(0) === '$' && value.charAt(length - 1) === '$') {\n            return value.substr(1, length - 2)\n        }\n    }\n    return false\n}\n","import { webSocket } from '../components/ReserveWebsite/ReserveWebsite'\nimport {\n    resourceItemIndex,\n    resourceDraftIndex,\n} from '../utils/resourceTypeIndex'\n\nconst diffpatcher = require('jsondiffpatch/dist/jsondiffpatch.umd.js').create({\n    objectHash: obj => obj.id,\n    propertyFilter: (name, context) => name !== '__patch__',\n})\n\nexport const sendUpdate = (\n    type: 'user' | 'website' | 'page' | 'template' | 'plugin',\n    changes: {},\n    id: string\n) => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    const oldResource = mD.resourcesObjects[id]\n    if (oldResource) {\n        let draft, currentDraft\n        if (['page', 'template', 'plugin'].includes(type)) {\n            draft = oldResource.draft\n            currentDraft = mD[resourceDraftIndex[type]]\n        } else {\n            draft = oldResource\n            currentDraft = oldResource\n        }\n        if (draft && changes) {\n            const newResource = { ...currentDraft, ...changes }\n            const patch = diffpatcher.diff(draft, newResource)\n            if (patch) {\n                if (webSocket && webSocket.readyState !== 3) {\n                    webSocket.send(\n                        JSON.stringify({\n                            messageCode: 'updateResource',\n                            type,\n                            _id: id,\n                            __patch__: patch,\n                            __v: oldResource.__v,\n                            markPublish: [\n                                'page',\n                                'template',\n                                'plugin',\n                            ].includes(type)\n                                ? !mD[resourceItemIndex[type]].notPublished\n                                : false,\n                        })\n                    )\n                }\n            }\n        }\n    }\n}\n","import { webSocket } from '../components/ReserveWebsite/ReserveWebsite'\nimport { current, resourceObjectIndex } from '../utils/resourceTypeIndex'\nimport * as actions from '../store/actions'\n\nexport const addResource = (\n    type: 'page' | 'plugin' | 'template',\n    duplicate?: boolean,\n    newResourceName?: string,\n    resourceData?: {}\n) => (dispatch: Object, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'addResource',\n                type,\n                websiteId: mD.currentWebsiteId,\n                duplicate,\n                _id: mD[current[type]],\n                name: newResourceName,\n                resourceData,\n            })\n        )\n    }\n}\n\nexport const deleteResource = (type: 'page' | 'plugin' | 'template') => (\n    dispatch: Object,\n    getState\n) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (!window.confirm('Are you sure you want to delete this resource?'))\n        return\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'deleteResource',\n                type,\n                _id: mD[current[type]],\n            })\n        )\n    }\n}\n\nexport const publishResource = (type: 'page' | 'plugin' | 'template') => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'publishResource',\n                type,\n                _id: mD[current[type]],\n            })\n        )\n    }\n}\n\nexport const revertResource = (type, to) => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (to === 'draft') {\n        dispatch(\n            actions.revertResource({\n                _id: mD[current[type]],\n                draft: mD[resourceObjectIndex[type]].draft,\n                to,\n            })\n        )\n    } else {\n        if (webSocket && webSocket.readyState !== 3) {\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'revertResource',\n                    type,\n                    _id: mD[current[type]],\n                    to,\n                })\n            )\n        }\n    }\n}\n","import { webSocket } from '../components/ReserveWebsite/ReserveWebsite'\nimport { sendUpdate } from './sendUpdate'\nimport cloneDeep from 'lodash/cloneDeep'\n\nexport const changeWebsiteProperty = (key, value, id) => (\n    dispatch,\n    getState\n) => {\n    const { mD } = getState()\n    if (!mD.currentWebsiteObject || !mD.currentWebsiteId) return\n    const newResource = cloneDeep(\n        id ? mD.resourcesObjects[id] : mD.currentWebsiteObject\n    )\n    if (!newResource) return\n    newResource[key] = value\n    dispatch(sendUpdate('website', newResource, mD.currentWebsiteId))\n}\n\nexport const addWebsite = (duplicate?: boolean) => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'addWebsite',\n                _id: mD.currentWebsiteId,\n                duplicate,\n            })\n        )\n    }\n}\n\nexport const deleteWebsite = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'deleteWebsite',\n                _id: mD.currentWebsiteId,\n            })\n        )\n    }\n}\n\nexport const verifyCustomDomain = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'verifyCustomDomain',\n                _id: mD.currentWebsiteId,\n            })\n        )\n    }\n}\n\nexport const sharingRightsChange = (userId, right, value) => (\n    dispatch,\n    getState\n) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (mD.currentWebsiteObject) {\n        const newSharing = cloneDeep(mD.currentWebsiteObject.sharing)\n        const account = newSharing.find(item => item.userId === userId)\n        if (account) {\n            let newRights = []\n            if (value) {\n                newRights = [...account.rights, right]\n            } else {\n                newRights = account.rights.filter(item => item !== right)\n            }\n            // const updatedSharing = mD.currentWebsiteObject.sharing.filter(\n            //     item => item.userId !== userId\n            // )\n            // updatedSharing.push({\n            //     ...account,\n            //     rights: newRights,\n            // })\n            account.rights = newRights\n            dispatch(\n                changeWebsiteProperty(\n                    'sharing',\n                    newSharing,\n                    mD.currentWebsiteId\n                )\n            )\n        }\n    }\n}\n\nexport const addUserInWebsiteSharing = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (mD.currentWebsiteObject) {\n        const id = window.prompt('Paste the user id to share the website.')\n        if (!id) return\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'addUserInSharing',\n                _id: mD.currentWebsiteId,\n                userId: id,\n                type: 'add',\n            })\n        )\n    }\n}\n\nexport const deleteUserInWebsiteSharing = userId => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (userId && userId !== mD.userId) {\n        if (\n            !window.confirm(\n                'Are you sure you want to remove this user from sharing?'\n            )\n        )\n            return\n    }\n\n    webSocket.send(\n        JSON.stringify({\n            messageCode: 'addUserInSharing',\n            _id: mD.currentWebsiteId,\n            userId,\n            type: 'delete',\n        })\n    )\n}\n\nexport const transferWebsite = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (mD.currentWebsiteObject) {\n        const userTo = window.prompt(\n            'Enter the user id to whom you would like to transfer the website. It can be found in the user account menu tab.'\n        )\n        if (\n            !userTo ||\n            !window.confirm(\n                'Are you sure you want to transfer this website to user - ' +\n                    userTo +\n                    '?'\n            )\n        )\n            return\n\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'transferWebsite',\n                _id: mD.currentWebsiteId,\n                userTo,\n            })\n        )\n    }\n}\n\nexport const saveDomainName = (name, type) => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (mD.currentWebsiteObject) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'saveDomainName',\n                _id: mD.currentWebsiteId,\n                name,\n                type,\n            })\n        )\n    }\n}\n","import { webSocket } from '../components/ReserveWebsite/ReserveWebsite'\n\nexport const deleteImage = (url: string) => (dispatch: Object, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (\n        window.confirm(\n            'Are you sure you want to delete this image? The image will be unavailable after the deletion and will not be visible in all elements and on all pages of your websites.'\n        )\n    ) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'deleteImage',\n                url,\n                _id: mD.currentWebsiteId,\n            })\n        )\n    }\n}\n\nexport const renameImage = (url: string) => (dispatch: Object, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    const label = window.prompt('Type a new name for the image.')\n    if (label !== null) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'renameImage',\n                url,\n                _id: mD.currentWebsiteId,\n                label,\n            })\n        )\n    }\n}\n","export { sendUpdate } from './sendUpdate'\n\nexport {\n    addResource,\n    deleteResource,\n    publishResource,\n    revertResource,\n} from './resources'\n\nexport {\n    addWebsite,\n    deleteWebsite,\n    changeWebsiteProperty,\n    verifyCustomDomain,\n    sharingRightsChange,\n    addUserInWebsiteSharing,\n    deleteUserInWebsiteSharing,\n    transferWebsite,\n    saveDomainName,\n} from './websites'\n\nexport { renameImage, deleteImage } from './images'\n","import React from 'react'\n//import { connect } from 'react-redux';\nimport type { Node } from 'react'\n\n//import * as actions from '../../../store/actions/index';\nimport classes from './Checkbox.module.css'\n//import SmallButton from '../Buttons/SmallButton/SmallButton';\n\ntype Props = {\n    checked?: boolean,\n    title?: string,\n    onChange: Function,\n    datatestid?: string,\n    radio?: boolean,\n    children?: Node,\n    inline?: boolean,\n}\n\nconst Checkbox = (props: Props) => {\n    return (\n        <div\n            className={\n                props.inline\n                    ? [classes.Div, classes.Inline].join(' ')\n                    : classes.Div\n            }\n        >\n            <label>\n                <input\n                    data-testid={props.datatestid}\n                    type={props.radio ? 'radio' : 'checkbox'}\n                    className={classes.Input}\n                    checked={props.checked || false}\n                    onChange={e => props.onChange(e.target.checked)}\n                />\n                {props.title}\n                {props.children}\n            </label>\n        </div>\n    )\n}\n\nexport default Checkbox\n","import throttle from 'lodash.throttle'\n\nexport const CANCEL = 'redux-throttle/CANCEL'\nexport const FLUSH = 'redux-throttle/FLUSH'\n\nfunction map(throttled, action, method) {\n    if (action.payload && action.payload.type) {\n        let types = action.payload.type\n        if (!Array.isArray(types)) {\n            types = [types]\n        }\n        Object.keys(throttled)\n            .filter(t => types.includes(t))\n            .forEach(t => throttled[t][method]())\n        return\n    }\n    Object.keys(throttled).forEach(t => throttled[t][method]())\n    return\n}\n\nexport default function middleware(\n    defaultWait = 300,\n    defaultThrottleOption = {}\n) {\n    const throttled = {}\n    return store => next => action => {\n        if (action.type === CANCEL) {\n            map(throttled, action, 'cancel')\n            return next(action)\n        }\n\n        if (action.type === FLUSH) {\n            map(throttled, action, 'flush')\n            return next(action)\n        }\n\n        const shouldThrottle = (action.meta || {}).throttle\n\n        if (!shouldThrottle) {\n            return next(action)\n        }\n\n        if (throttled[action.type]) {\n            return throttled[action.type](action)\n        }\n\n        let wait = defaultWait\n        let options = defaultThrottleOption\n\n        if (!isNaN(shouldThrottle) && shouldThrottle !== true) {\n            wait = shouldThrottle\n        } else if (typeof shouldThrottle === 'object') {\n            wait = shouldThrottle.wait || defaultWait\n            options = { ...defaultThrottleOption, ...shouldThrottle }\n        }\n\n        throttled[action.type] = throttle(next, wait, options)\n\n        return throttled[action.type](action)\n    }\n}\n","import React, { Component } from 'react'\nimport { Redirect } from 'react-router-dom'\nimport { connect } from 'react-redux'\n\nimport * as actions from '../../../store/actions/index'\n\ntype Props = {\n    onLogout: () => {},\n}\n\nclass Logout extends Component<Props> {\n    componentDidMount() {\n        this.props.onLogout()\n    }\n\n    render() {\n        return <Redirect to=\"/login\" />\n    }\n}\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        onLogout: () => dispatch(actions.logout()),\n    }\n}\n\nexport default connect(\n    null,\n    mapDispatchToProps\n)(Logout)\n","import React, { Component } from 'react'\n\ntype Props = {}\n\ntype State = {\n    component: Object | null,\n}\n\nconst asyncComponent = (importComponent: Object) => {\n    return class extends Component<Props, State> {\n        state = {\n            component: null,\n        }\n\n        componentDidMount() {\n            importComponent().then(cmp => {\n                this.setState({ component: cmp.default })\n            })\n        }\n\n        render() {\n            const C = this.state.component\n            return C ? <C {...this.props} /> : <div>Loading...</div>\n        }\n    }\n}\n\nexport default asyncComponent\n","import React from 'react'\nimport type { Node } from 'react'\nimport classes from './LoginButton.module.css'\n\ntype Props = {\n    clicked?: Function,\n    disabled?: boolean,\n    btnType?: 'Success' | 'Danger',\n    children?: Node,\n    datatestid?: string,\n}\n\nconst LoginButton = (props: Props) => (\n    <button\n        data-testid={props.datatestid || 'LoginButton'}\n        disabled={props.disabled}\n        className={[classes.Button, classes[props.btnType]].join(' ')}\n        onClick={props.clicked}\n    >\n        {props.children}\n    </button>\n)\n\nexport default LoginButton\n","import React, { useState, useEffect } from 'react'\n\nimport Checkbox from '../../components/UI/Checkbox/Checkbox'\nimport Cookies from 'universal-cookie'\nimport LoginButton from '../../components/UI/LoginButton/LoginButton'\nimport classes from './Auth.module.css'\nimport Svg from '../../components/Svg/Svg'\n\nconst cookies = new Cookies()\n\ntype Props = {\n    test?: boolean,\n}\n\nconst Auth = (props: Props) => {\n    const [state: boolean, setState] = useState(false)\n    const [cookieConsent: boolean, setCookieConsent] = useState(false)\n\n    useEffect(() => {\n        checkCookieConsent()\n    })\n\n    let remeberMeParam = '?rememberme=false'\n    if (state) {\n        remeberMeParam = '?rememberme=true'\n    }\n\n    const checkCookieConsent = () => {\n        const cookiesConsent = cookies.get('cookies_consent')\n        if (cookiesConsent) {\n            setCookieConsent(true)\n        }\n    }\n\n    const agreeWithCookies = () => {\n        cookies.set('cookies_consent', 'true', {\n            path: '/',\n            maxAge: 31530000,\n        })\n        checkCookieConsent()\n    }\n    const basicURL =\n        process.env.NODE_ENV !== 'development'\n            ? 'https://my.websiter.dev/api/auth/'\n            : 'http://my.websiter.dev:5000/api/auth/'\n    return (\n        <div className={classes.Container}>\n            {!cookieConsent ? (\n                <>\n                    <div>\n                        We use cookies only for login purposes. In order to\n                        proceed you need to agree with the use of cookies.\n                    </div>\n                    <LoginButton btnType=\"Success\" clicked={agreeWithCookies}>\n                        AGREE\n                    </LoginButton>\n                    <LoginButton\n                        btnType=\"Danger\"\n                        clicked={() => {\n                            window.open('https://websiter.dev', '_self')\n                        }}\n                    >\n                        Return to the homepage\n                    </LoginButton>\n                </>\n            ) : (\n                <>\n                    <h1>Continue with:</h1>\n                    <div className={classes.socialButtons}>\n                        <a href={basicURL + `google/start${remeberMeParam}`}>\n                            <Svg icon='<svg width=\"50\" height=\"50\" viewBox=\"0 0 24 24\"><path fill=\"#4285F4\" d=\"M12.24 10.285V14.4h6.806c-.275 1.765-2.056 5.174-6.806 5.174-4.095 0-7.439-3.389-7.439-7.574s3.345-7.574 7.439-7.574c2.33 0 3.891.989 4.785 1.849l3.254-3.138C18.189 1.186 15.479 0 12.24 0c-6.635 0-12 5.365-12 12s5.365 12 12 12c6.926 0 11.52-4.869 11.52-11.726 0-.788-.085-1.39-.189-1.989H12.24z\"></path></svg>' />\n                            <div>GOOGLE</div>\n                        </a>\n                        <a href={basicURL + `facebook/start${remeberMeParam}`}>\n                            <Svg icon='<svg width=\"50\" height=\"50\" viewBox=\"0 0 24 24\"><path fill=\"#1877F2\" d=\"M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z\"></path></svg>' />\n                            <div>FACEBOOK</div>\n                        </a>\n                        <a href={basicURL + `twitter/start${remeberMeParam}`}>\n                            <Svg icon='<svg width=\"50\" height=\"50\" viewBox=\"0 0 24 24\"><path fill=\"#1DA1F2\" d=\"M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z\"></path></svg>' />\n                            <div>TWITTER</div>\n                        </a>\n                    </div>\n                    <Checkbox\n                        title=\"Remember me\"\n                        checked={state}\n                        onChange={() => setState(!state)}\n                    />\n                </>\n            )}\n        </div>\n    )\n}\nexport default Auth\n","import React from 'react'\nimport classes from './Spinner.module.css'\n\ntype Props = {\n    cover?: boolean,\n    datatestid?: string,\n}\n\nconst spinner = (props: Props) => (\n    <>\n        {props.cover ? (\n            <div\n                className={classes.Cover}\n                data-testid={props.datatestid || 'cover'}\n            >\n                <div className={classes.Loader}>Loading...</div>\n            </div>\n        ) : (\n            <div className={classes.Loader}>Loading...</div>\n        )}\n    </>\n)\n\nexport default spinner\n","import isEqual from 'lodash/isEqual'\nimport omit from 'lodash/omit'\n\nexport default (draft1, draft2) =>\n    isEqual(\n        {\n            structure: draft1.structure.map(item =>\n                omit(item, ['expanded', 'children', 'itemPath', 'itemIndex'])\n            ),\n            values: draft1.values,\n        },\n        {\n            structure: draft2.structure.map(item =>\n                omit(item, ['expanded', 'children', 'itemPath', 'itemIndex'])\n            ),\n            values: draft2.values,\n        }\n    )\n","import {\n    structure,\n    current,\n    resourceObjectIndex,\n} from '../../utils/resourceTypeIndex'\nimport cloneDeep from 'lodash/cloneDeep'\nimport isEqual from 'lodash/isEqual'\nimport { checkIfCapital } from '../../utils/basic'\nimport resourcesAreEqual from '../../utils/resourcesAreEqual'\n\n// $FlowFixMe\nconst diffpatcher = require('jsondiffpatch/dist/jsondiffpatch.umd.js').create({\n    objectHash: obj => obj.id,\n    propertyFilter: (name, context) => name !== '__patch__',\n})\n\nconst patchStructure = (state: Object, action: Object) => {\n    return diffpatcher.patch(\n        state[structure[action.resourceType]],\n        action.structurePatch\n    )\n}\n\nexport const addResourceSuccess = (state: Object, action: Object) => {\n    state[structure[action.resourceType]] = patchStructure(state, action)\n    state.resourcesObjects[action._id] = action.resource\n}\n\nexport const deleteResourceSuccess = (state: Object, action: Object) => {\n    action.deletedResources.forEach(id => delete state.resourcesObjects[id])\n    state[structure[action.resourceType]] = patchStructure(state, action)\n    state[current[action.resourceType]] = action.current || ''\n}\n\nexport const setCurrentResource = (state: Object, action: Object) => {\n    state.resourcesObjects[action.mD.currentWebsiteId][\n        current[action.resourceType]\n    ] = action._id\n    if (action.resourceType === 'page') {\n        state.hoveredElementSize = {}\n    }\n}\n\nexport const saveResourcesStructureSuccess = (\n    state: Object,\n    action: Object\n) => {\n    state[structure[action.resourceType]] = action.structure\n}\n\nexport const removeResourceFromUnsaved = (state: Object, action: Object) => {\n    state.notSavedResources = state.notSavedResources.filter(\n        item => item !== action._id\n    )\n}\n\nexport const addResourceToUnsaved = (state: Object, action: Object) => {\n    if (!state.notSavedResources.includes(action._id))\n        state.notSavedResources.push(action._id)\n}\n\nexport const removeResourceFromNewVersions = (\n    state: Object,\n    action: Object\n) => {\n    state.newVersionResources = state.newVersionResources.filter(\n        item => item !== action._id\n    )\n}\n\nexport const addResourceToNewVersions = (state: Object, action: Object) => {\n    if (!state.newVersionResources.includes(action._id))\n        state.newVersionResources.push(action._id)\n}\n\nexport const savePageInState = (state: Object, action: Object) => ({\n    ...state,\n    resourcesObjects: {\n        ...state.resourcesObjects,\n        [state.currentPage]: {\n            ...state.resourcesObjects[state.currentPage],\n            content: action.value,\n        },\n    },\n})\n\nexport const saveResourceDraftInState = (state: Object, action: Object) => {\n    state.resourcesObjects[action.currentResource].draft = action.draft\n}\n\nexport const saveResourceInState = (state: Object, action: Object) => {\n    state.resourcesObjects[action.currentResource].draft = action.draft\n    state.resourcesObjects[action.currentResource].present = action.draft\n    state.notSavedResources = state.notSavedResources.filter(\n        item => item !== action.currentResource\n    )\n}\n\nexport const addResourceVersion = (state: Object, action: Object) => {\n    const resource = cloneDeep(\n        action.mD[resourceObjectIndex[action.resourceType]]\n    )\n    if (!isEqual(resource.present, action.draft)) {\n        if (action.isNotForHistory) {\n            resource.present = action.draft\n            state.resourcesObjects[resource._id] = resource\n        } else {\n            const newDraft = { ...action.draft }\n            if (\n                action.draft.structure &&\n                ['template', 'plugin'].includes(action.resourceType)\n            ) {\n                const connectedResources = []\n                action.draft.structure.forEach(item => {\n                    if (item.tag.length > 0 && item.path.length > 0) {\n                        if (\n                            checkIfCapital(item.tag.charAt(0)) &&\n                            !item.childrenTo &&\n                            !item.isChildren &&\n                            !item.isElementFromCMSVariable\n                        ) {\n                            connectedResources.push({\n                                name: item.tag,\n                                type: 'plugin',\n                            })\n                        }\n                    }\n                })\n                newDraft.connectedResources = connectedResources\n\n                // let resource =\n                //     state.resourcesObjects[\n                //         state.resourcesObjects[state.userId].loadedWebsite\n                //     ].templatesStructure.find(\n                //         item => item.id === action.currentResource\n                //     ) ||\n                //     state.pluginsStructure.find(\n                //         item => item.id === action.currentResource\n                //     )\n                // if (resource) {\n                //     resource.connectedResources = connectedResources\n                // }\n            }\n            const currentResourceId = action.mD[current[action.resourceType]]\n            if (\n                !resourcesAreEqual(\n                    resource.present.structure\n                        ? resource.present\n                        : resource.draft,\n                    newDraft\n                )\n            ) {\n                if (!state.notSavedResources.includes(currentResourceId))\n                    state.notSavedResources.push(currentResourceId)\n            }\n            if (resource.past.length > 100) resource.past.shift()\n            resource.past.push(diffpatcher.diff(resource.present, newDraft))\n            resource.present = newDraft\n            resource.future = []\n            state.resourcesObjects[resource._id] = resource\n        }\n    }\n}\n\nexport const undoResourceVersion = (state: Object, action: Object) => {\n    const currentResource = state[current[state.currentTopTab]]\n    const resource = state.resourcesObjects[currentResource]\n    if (resource) {\n        if (resource.past.length > 0) {\n            if (\n                !isEqual(\n                    resource.present,\n                    resource.past[resource.past.length - 1]\n                )\n            ) {\n                if (!state.notSavedResources.includes(action.currentResource))\n                    state.notSavedResources.push(action.currentResource)\n            } else {\n                state.notSavedResources = state.notSavedResources.filter(\n                    item => item !== action.currentResource\n                )\n            }\n\n            const delta = resource.past.pop()\n            resource.future.unshift(delta)\n            resource.present = diffpatcher.unpatch(resource.present, delta)\n        }\n    }\n}\n\nexport const redoResourceVersion = (state: Object, action: Object) => {\n    const currentResource = state[current[state.currentTopTab]]\n    const resource = state.resourcesObjects[currentResource]\n    if (resource) {\n        if (resource.future.length > 0) {\n            if (!isEqual(resource.present, resource.future[0])) {\n                if (!state.notSavedResources.includes(action.currentResource))\n                    state.notSavedResources.push(action.currentResource)\n            } else {\n                state.notSavedResources = state.notSavedResources.filter(\n                    item => item !== action.currentResource\n                )\n            }\n\n            const delta = resource.future.shift()\n            resource.past.push(delta)\n            resource.present = diffpatcher.patch(resource.present, delta)\n        }\n    }\n}\n","import * as auth from './auth'\nimport * as images from './images'\nimport * as resources from './resources'\nimport { createReducer } from '@reduxjs/toolkit'\nimport resourcesAreEqual from '../../utils/resourcesAreEqual'\n\nexport type menuItemType = {\n    all: boolean,\n    id: string,\n    generatedFrom: string,\n    sourceItem: boolean,\n    name: string,\n    type: string,\n    path: Array<string>,\n    properties: {\n        url: string,\n        class: string,\n    },\n}\n\nexport type requiredRightsType = Array<string>\n\nexport type elementType = {\n    id: string,\n    path: Array<string>,\n    tag: string,\n    properties: {\n        name?: string,\n        topMenuBlockClasses?: Array<string>,\n        topMenuItemClasses?: Array<string>,\n        topMenuItemActiveClasses?: Array<string>,\n        popupMenuBlockClasses?: Array<string>,\n        popupMenuItemClasses?: Array<string>,\n        popupMenuItemActiveClasses?: Array<string>,\n        mode?: 'horizontal' | 'vertical',\n        trigger?: 'click',\n        id?: string,\n        class?: string,\n    },\n    propertiesString: string,\n    style?: string,\n    expanded?: boolean,\n    textMode: string,\n    cursorPosition?: {\n        row: number,\n        column: number,\n    },\n    text?: boolean,\n    textContent?: string,\n    isChildren?: boolean,\n    childrenTo?: string,\n    forPlugin?: string,\n    sourcePlugin?: string,\n    menuItems?: Array<menuItemType>,\n    currentMenuItem?: string,\n    children?: Array<elementType>,\n    isElementFromCMSVariable?: boolean,\n    isCMSVariable?: boolean,\n    CMSVariableType?: string,\n    CMSVariableSystemName?: string,\n    CMSVariableDescription?: string,\n    CMSVariableDefaultValue?: any,\n    currentMenuId?: string,\n    defaultMenuItems?: Array<menuItemType>,\n    value?: any,\n}\nexport type resourceType = {\n    currentId: number,\n    structure: Array<elementType>,\n    currentBox?: string,\n    cursorPosition?: {\n        row: number,\n        column: number,\n    },\n    value?: string,\n}\n\nexport type pageType = {\n    id: string,\n    path: Array<string>,\n    name: string,\n    url: string,\n    template: string,\n    homepage: boolean,\n    hidden: boolean,\n    notPublished: boolean,\n    connectedResources: {\n        name: string,\n        type: string,\n    },\n}\n\nexport type pluginType = {\n    id: string,\n    path: Array<string>,\n    name: string,\n    url: string,\n    template: string,\n    homepage: boolean,\n    notPublished: boolean,\n    hidden: boolean,\n    connectedResources: {\n        name: string,\n        type: string,\n    },\n}\n\nexport type templateType = {\n    id: string,\n    path: Array<string>,\n    name: string,\n    url: string,\n    template: string,\n    homepage: boolean,\n    notPublished: boolean,\n    hidden: boolean,\n    connectedResources: {\n        name: string,\n        type: string,\n    },\n}\n\nexport type imageType = {\n    name: string,\n    label: string,\n    url: string,\n    size: number,\n}\nexport type websiteType = {\n    _id: string,\n    domain: string,\n    name: string,\n    customDomain?: string,\n    domainHidden?: boolean,\n    customDomainHidden?: boolean,\n    customDomainVerified?: boolean,\n    verifyCode?: string,\n    cname?: string,\n    domainNoIndex?: boolean,\n    sharing: Array<{\n        userId: string,\n        rights: Array<string>,\n    }>,\n    user: string,\n    storage: number,\n    images: Array<imageType>,\n}\n\nexport type initialStateType = {\n    websites: Array<websiteType>,\n    resourcesObjects: {\n        [key: string]: {\n            draft: resourceType,\n            present: resourceType,\n            future: Array<resourceType>,\n            past: Array<resourceType>,\n        },\n    },\n    pagesStructure: Array<pageType>,\n    pluginsStructure: Array<pluginType>,\n    templatesStructure: Array<templateType>,\n    loadedWebsite: string,\n    error: null | {},\n    loading: boolean,\n    currentPage: string,\n    currentPlugin: string,\n    currentTemplate: string,\n    domainNotOk: boolean,\n    customDomainNotOk: boolean,\n    maxStorage: number,\n    uploadingImage: boolean,\n    currentBoxInPlugin: string,\n    currentImage: string,\n    sizeIsChanging: boolean,\n    currentWebsite: string,\n    notSavedResources: Array<string>,\n    pageZoom: number,\n    hoveredElementId: null | string,\n    hoveredElementSize: {\n        [key: string]: {\n            children: {},\n            left: number,\n            top: number,\n            width: number,\n            height: number,\n        },\n    },\n    isRefreshing: boolean,\n    userId: null | string,\n    barSizes: { height: number, width: number, width2: number, width3: number },\n    currentTopTab: string,\n    findMode: null | string,\n    hoverMode: string,\n    fromFrame: boolean,\n    search: {},\n    tryWebsiter: boolean,\n    currentUserInWebsiteSharing: string,\n    currentSiteBuilderMode: 'template' | 'page' | '',\n    accountInfo: {\n        displayName?: string,\n        emails?: Array<string>,\n        photos?: Array<string>,\n    },\n}\n\nexport const initialState: initialStateType = {\n    resourcesObjects: {},\n    error: null,\n    loading: false,\n    domainNotOk: false,\n    customDomainNotOk: false,\n    maxStorage: 0,\n    uploadingImage: false,\n    currentBoxInPlugin: '',\n    currentImage: '',\n    sizeIsChanging: false,\n    notSavedResources: [],\n    newVersionResources: [],\n    pageZoom: 100,\n    hoveredElementId: null,\n    hoveredElementSize: {},\n    isRefreshing: false,\n    userId: null,\n    barSizes: {\n        height: 200,\n        width: 400,\n        width2: 200,\n        width3: 200,\n    },\n    currentTopTab: 'page',\n    findMode: null,\n    hoverMode: '',\n    fromFrame: false,\n    search: {},\n    shouldRefresh: false,\n    tryWebsiter: false,\n    currentUserInWebsiteSharing: '',\n    // currentSiteBuilderMode: '',\n    mD: {},\n}\n\nconst saveHoveredElementRect = (state, action) => {\n    const checkAndCreatePath = (path, index, parent) => {\n        if (index < path.length - 1) {\n            if (!parent[path[index].id]) {\n                parent[path[index].id] = {\n                    plugin: path[index].plugin,\n                    children: {},\n                }\n            }\n            checkAndCreatePath(\n                action.path,\n                index + 1,\n                parent[path[index].id].children\n            )\n        } else {\n            parent[path[index].id] = {\n                plugin: path[index].plugin,\n                children: {},\n                ...action.size,\n            }\n        }\n    }\n    if (action.path.length > 0)\n        checkAndCreatePath(action.path, 0, state.hoveredElementSize)\n}\n\nconst removeFromHoveredSizes = (state, action) => {\n    // ,\n    // removedElements,\n    const checkAndRemoveElement = parent => {\n        for (const item in parent) {\n            if (parent[item].plugin === action.currentResource) {\n                for (const child in parent[item].children) {\n                    if (action.removedElements.includes(child))\n                        delete parent[item].children[child]\n                }\n            } else {\n                checkAndRemoveElement(parent.children)\n            }\n        }\n    }\n    checkAndRemoveElement(state.hoveredElementSize)\n}\n\nconst toggleFindMode = (state, action) => {\n    if (action.value) {\n        if (state.findMode === action.value) {\n            state.findMode = null\n        } else {\n            state.findMode = action.value\n        }\n    } else {\n        state.findMode = null\n    }\n}\n\nconst reducer = createReducer(initialState, {\n    REMOVE_RESOURCE_FROM_UNSAVED: (state, action) =>\n        resources.removeResourceFromUnsaved(state, action),\n    ACTION_START_IMAGE_UPLOAD: (state, action) =>\n        images.actionStartImageUpload(state),\n    ACTION_FAIL_IMAGE_UPLOAD: (state, action) =>\n        images.actionFailImageUpload(state, action),\n    ACTION_SUCCESS_IMAGE_UPLOAD: (state, action) =>\n        images.actionSuccessImageUpload(state),\n    CHOOSE_IMAGE: (state, action) => images.chooseImage(state, action),\n\n    SIZE_IS_CHANGING: (state, action) => {\n        state.sizeIsChanging = action.isChanging\n    },\n    ACTION_START: (state, action) => {\n        state.error = null\n        state.pagesLoading = true\n    },\n    ACTION_FAIL: (state, action) => {\n        state.error = action.error\n        state.pagesLoading = false\n    },\n    ACTION_SUCCESS: (state, action) => {\n        state.error = null\n        state.pagesLoading = false\n    },\n\n    ADD_RESOURCE_VERSION: (state, action) =>\n        resources.addResourceVersion(state, action),\n    UNDO_RESOURCE_VERSION: (state, action) =>\n        resources.undoResourceVersion(state, action),\n    REDO_RESOURCE_VERSION: (state, action) =>\n        resources.redoResourceVersion(state, action),\n\n    AUTH_START: (state, action) => auth.authStart(state),\n    AUTH_SUCCESS: (state, action) => auth.authSuccess(state, action),\n    AUTH_FAIL: (state, action) => auth.authFail(state, action),\n    AUTH_LOGOUT: (state, action) => auth.authLogout(state),\n    CHANGE_BAR_SIZE: (state, action) => auth.changeBarSize(state, action),\n    SET_CURRENT_TOP_TAB: (state, action) => {\n        state.currentTopTab = action.currentTopTab\n    },\n\n    SAVE_HOVERED_ELEMENT_RECT: (state: Object, action: Object) =>\n        saveHoveredElementRect(state, action),\n    REMOVE_FROM_HOVERED_SIZES: (state: Object, action: Object) =>\n        removeFromHoveredSizes(state, action),\n    HOVER_ELEMENT: (state: Object, action: Object) => {\n        state.hoveredElementId = action.id\n        state.hoverMode = action.mode\n        state.fromFrame = action.fromFrame\n    },\n    UNHOVER_ELEMENT: (state: Object, action: Object) => {\n        state.hoveredElementId = null\n        state.fromFrame = false\n    },\n    TOGGLE_FIND_MODE: (state: Object, action: Object) =>\n        toggleFindMode(state, action),\n    MARK_REFRESHING: (state: Object, action: Object) => {\n        state.isRefreshing = action.refreshing\n    },\n    MARK_SHOULD_REFRESHING: (state: Object, action: Object) => {\n        state.shouldRefresh = action.value\n    },\n    CHOOSE_USER_IN_WEBSITE_SHARING: (state: Object, action: Object) => {\n        state.currentUserInWebsiteSharing = action.id\n    },\n    SET_CURRENT_SITEBUILDER_MODE: (state: Object, action: Object) => {\n        state.currentSiteBuilderMode = action.mode\n    },\n    SAVE_MAIN_DATA: (state: Object, action: Object) => {\n        state.mD = action.mD\n    },\n    //ws\n    ADD_RESOURCE: (state: Object, action: Object) => {\n        const { mD } = state\n        if (action.data) {\n            if (action.data._id) {\n                if (mD.resourcesObjects[action.data._id]) {\n                    if (mD.resourcesObjects[action.data._id].draft) {\n                        state.resourcesObjects[action.data._id] = {\n                            ...mD.resourcesObjects[action.data._id],\n                            draft: action.data.draft,\n                            __v: action.data.__v,\n                        }\n                        let saved\n                        if (\n                            !mD.resourcesObjects[action.data._id].present\n                                .structure\n                        )\n                            saved = true\n                        else\n                            saved = resourcesAreEqual(\n                                action.data.draft,\n                                mD.resourcesObjects[action.data._id].present\n                            )\n\n                        if (saved) {\n                            resources.removeResourceFromUnsaved(state, {\n                                _id: action.data._id,\n                            })\n                            resources.removeResourceFromNewVersions(state, {\n                                _id: action.data._id,\n                            })\n                        } else {\n                            resources.addResourceToUnsaved(state, {\n                                _id: action.data._id,\n                            })\n                            resources.addResourceToNewVersions(state, {\n                                _id: action.data._id,\n                            })\n                        }\n                    } else {\n                        state.resourcesObjects[action.data._id] = {\n                            ...state.resourcesObjects[action.data._id],\n                            ...action.data,\n                        }\n                    }\n                } else state.resourcesObjects[action.data._id] = action.data\n                if (action.data._id.toString() === mD.userId.toString()) {\n                    if (action.data.settings)\n                        if (action.data.settings.barSizes)\n                            state.barSizes = action.data.settings.barSizes\n                }\n            }\n        }\n    },\n\n    DELETE_RESOURCE: (state: Object, action: Object) => {\n        if (action.data) {\n            delete state.resourcesObjects[action.data.resourceId]\n        }\n    },\n    REVERT_RESOURCE: (state: Object, action: Object) => {\n        if (action.data) {\n            state.resourcesObjects[action.data._id].present = action.data.draft\n            if (action.data.to === 'draft') {\n                resources.removeResourceFromUnsaved(state, {\n                    _id: action.data._id,\n                })\n                resources.removeResourceFromNewVersions(state, {\n                    _id: action.data._id,\n                })\n            }\n        }\n    },\n    SAVE_OBJECT: (state: Object, action: Object) => {\n        if (action.data) {\n            state.resourcesObjects[action.data._id] = action.data\n        }\n    },\n})\n\nexport default reducer\n","import { initialState } from './reducer'\n\nexport const actionStartImageUpload = (state: Object) => ({\n    ...state,\n    error: null,\n    loading: true,\n})\n\nexport const actionSuccessImageUpload = (state: Object) => ({\n    ...state,\n    error: null,\n    loading: false,\n})\n\nexport const actionFailImageUpload = (state: Object, action: Object) => ({\n    ...state,\n    error: action.error,\n    loading: false,\n})\n\nexport const chooseImage = (state: Object = initialState, action: Object) => {\n    state.currentImage = action.image\n}\n","export const authStart = (state: Object) => {\n    state.loading = true\n    state.error = null\n}\n\nexport const authFail = (state: Object, action: Object) => {\n    state.loading = false\n    state.error = action.error\n    state.userId = null\n}\n\nexport const authLogout = (state: Object) => {\n    state.userId = null\n}\n\nexport const authSuccess = (state: Object, action: Object) => {\n    state.userId = action.data._id\n    state.accountInfo = action.data.accountInfo\n    state.error = null\n    state.loading = false\n    state.barSizes = { ...state.barSizes, ...action.data.barSizes }\n    state.tryWebsiter = action.data.tryWebsiter\n}\n\nexport const changeBarSize = (state: Object, action: Object) => {\n    state.barSizes[action.key] = action.value\n}\n","import React, { Component } from 'react'\nimport { Route, Switch, withRouter, Redirect } from 'react-router-dom'\nimport { connect } from 'react-redux'\n\nimport Logout from './containers/Auth/Logout/Logout'\nimport asyncComponent from './hoc/asyncComponent'\nimport * as actions from './store/actions/index'\nimport Auth from './containers/Auth/Auth'\nimport Spinner from './components/UI/Spinner/Spinner'\n\nimport { initialState } from './store/reducer/reducer'\n\nconst asyncSiteBuilderLayout = asyncComponent(() => {\n    return import('./components/SiteBuilderLayout/SiteBuilderLayout')\n})\n\ntype Props = {\n    onTryAutoSignup: Function,\n    isAuthenticated: boolean,\n    loading: typeof initialState.loading,\n}\n\nclass App extends Component<Props> {\n    componentDidMount() {\n        this.props.onTryAutoSignup()\n    }\n\n    render() {\n        let routes = (\n            <Switch>\n                <Route path=\"/login\" component={Auth} />\n                <Redirect to=\"/login\" />\n            </Switch>\n        )\n        if (this.props.isAuthenticated) {\n            routes = (\n                <div style={{ height: '100%' }}>\n                    <Switch>\n                        <Route\n                            path=\"/editor\"\n                            component={asyncSiteBuilderLayout}\n                        />\n                        <Route path=\"/logout\" component={Logout} />\n                        <Redirect to=\"/editor\" />\n                    </Switch>\n                </div>\n            )\n        }\n        return (\n            <>\n                {routes} {this.props.loading ? <Spinner cover /> : null}\n            </>\n        )\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n        isAuthenticated: state.userId !== null,\n        loading: state.loading,\n    }\n}\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        onTryAutoSignup: () => dispatch(actions.authCheckState()),\n    }\n}\n\nexport default withRouter(\n    connect(\n        mapStateToProps,\n        mapDispatchToProps\n    )(App)\n)\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { BrowserRouter } from 'react-router-dom'\nimport { Provider } from 'react-redux'\nimport { createStore, applyMiddleware } from 'redux'\nimport thunk from 'redux-thunk'\nimport axios from 'axios'\nimport throttle from './store/middleware/throttle'\n\nimport './index.css'\nimport App from './App'\n//import * as serviceWorker from './serviceWorker';\nimport reducer from './store/reducer/reducer'\n// $FlowFixMe\nimport 'react-sortable-tree/style.css'\n\n// const composeEnhancers =\n//     process.env.NODE_ENV === 'development'\n//         ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\n//         : null || compose\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\n\nif (process.env.NODE_ENV === 'development') {\n    axios.defaults.baseURL = 'http://api.websiter.dev:5000'\n} else {\n    axios.defaults.baseURL = 'https://api.websiter.dev'\n}\n\nconst defaultWait = 300\nconst defaultThrottleOption = {\n    leading: true,\n    trailing: true,\n}\n\nconst throttleMiddleware = throttle(defaultWait, defaultThrottleOption)\n\nexport const store = createStore(\n    reducer,\n    composeEnhancers\n        ? composeEnhancers(applyMiddleware(throttleMiddleware, thunk))\n        : applyMiddleware(throttleMiddleware, thunk)\n)\n\nconst app = (\n    <Provider store={store}>\n        <BrowserRouter>\n            <App />\n        </BrowserRouter>\n    </Provider>\n)\nconst inIframe = window.self !== window.top\n\nconst root = document.getElementById('root')\nif (root !== null && !inIframe) {\n    ReactDOM.render(app, root)\n}\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\n//serviceWorker.unregister();\n","const addConnectedResources = (\n    draft,\n    id,\n    newRequestedResourcesList,\n    currentWebsiteObject,\n    resourcesObjects\n) => {\n    if (!resourcesObjects[id])\n        newRequestedResourcesList.push({\n            id,\n            type: 'resource',\n        })\n    if (draft)\n        if (draft.connectedResources)\n            draft.connectedResources.forEach(connectedResource => {\n                let nextResourceItem\n                if (connectedResource.type === 'plugin') {\n                    nextResourceItem = currentWebsiteObject.pluginsStructure.find(\n                        item => item.name === connectedResource.name\n                    )\n                }\n                if (nextResourceItem) {\n                    const nextResourceObject =\n                        resourcesObjects[nextResourceItem.id]\n                    let nextResourceDraft = {}\n                    if (nextResourceObject) {\n                        nextResourceDraft = nextResourceObject.present.structure\n                            ? nextResourceObject.present\n                            : nextResourceObject.draft\n                    }\n                    addConnectedResources(\n                        nextResourceDraft,\n                        nextResourceItem.id,\n                        newRequestedResourcesList,\n                        currentWebsiteObject,\n                        resourcesObjects\n                    )\n                }\n            })\n}\n\nexport default props => {\n    const { mD } = props\n    let newRequestedResourcesList = []\n    if (mD.userId && mD.resourcesObjects) {\n        if (!mD.userObject) {\n            newRequestedResourcesList.push({\n                id: mD.userId,\n                type: 'user',\n            })\n        } else {\n            let currentWebsiteId = mD.currentWebsiteId\n            for (let item of mD.websites) {\n                newRequestedResourcesList.push({\n                    id: item.id,\n                    type: 'website',\n                })\n            }\n            if (!currentWebsiteId) {\n                if (mD.websites.length > 0) currentWebsiteId = mD.websites[0].id\n                if (currentWebsiteId) {\n                    props.chooseWebsite(currentWebsiteId)\n                }\n            } else {\n                if (mD.currentPageId) {\n                    // if (!mD.currentPageObject) {\n                    //     newRequestedResourcesList.push({\n                    //         id: mD.currentPageId,\n                    //         type: 'resource',\n                    //     })\n                    // }\n\n                    addConnectedResources(\n                        mD.currentPageDraft,\n                        mD.currentPageId,\n                        newRequestedResourcesList,\n                        mD.currentWebsiteObject,\n                        mD.resourcesObjects\n                    )\n                    if (mD.pageTemplateId) {\n                        addConnectedResources(\n                            mD.pageTemplateDraft,\n                            mD.pageTemplateId,\n                            newRequestedResourcesList,\n                            mD.currentWebsiteObject,\n                            mD.resourcesObjects\n                        )\n                    }\n                }\n                if (mD.currentTemplateId) {\n                    addConnectedResources(\n                        mD.currentTemplateDraft,\n                        mD.currentTemplateId,\n                        newRequestedResourcesList,\n                        mD.currentWebsiteObject,\n                        mD.resourcesObjects\n                    )\n                }\n                if (mD.currentPluginId) {\n                    addConnectedResources(\n                        mD.currentPluginDraft,\n                        mD.currentPluginId,\n                        newRequestedResourcesList,\n                        mD.currentWebsiteObject,\n                        mD.resourcesObjects\n                    )\n                }\n            }\n        }\n    }\n    newRequestedResourcesList = Array.from(new Set(newRequestedResourcesList))\n    return newRequestedResourcesList\n}\n","import React from 'react'\n\nimport { connect } from 'react-redux'\nimport axios from 'axios'\n\nimport * as actions from '../../store/actions/index'\nimport { Component } from 'react'\nimport getListOfNeededResources from './methods/getListOfNeededResources'\nimport getEssentialData from '../../utils/getEssentialData'\n\ntype Props = {\n    loadedWebsite: string,\n}\n\ntype State = {\n    requestedResources: Array<{}>,\n    taskId: number,\n}\n\nexport let webSocket = false\n\nclass ReserveWebsiteInn extends Component<Props, State> {\n    state = {\n        requestedResources: [],\n        taskId: 0,\n    }\n\n    start = () => {\n        let url\n        if (process.env.NODE_ENV === 'development') {\n            url = 'ws://api.websiter.dev:5000'\n        } else {\n            url = 'wss://api.websiter.dev'\n        }\n        let pingTimeout, authInterval\n        webSocket = new WebSocket(url)\n\n        const heartbeat = () => {\n            clearTimeout(pingTimeout)\n            pingTimeout = setTimeout(() => {\n                webSocket.close()\n            }, 30000 + 1000)\n            const versions = {}\n            for (let id in this.props.mD.resourcesObjects) {\n                versions[id] = {\n                    __v: this.props.mD.resourcesObjects[id].__v,\n                    type: this.props.mD.resourcesObjects[id].draft\n                        ? 'resource'\n                        : this.props.mD.resourcesObjects[id].pagesStructure\n                        ? 'website'\n                        : 'user',\n                }\n            }\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'heartbeat',\n                    versions,\n                })\n            )\n        }\n\n        webSocket.onopen = event => {\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'auth',\n                    user: axios.defaults.headers.common['x-auth-token'],\n                    tryWebsiter: sessionStorage.getItem('tryWebsiter'),\n                })\n            )\n            authInterval = setInterval(\n                () =>\n                    webSocket.send(\n                        JSON.stringify({\n                            messageCode: 'auth',\n                            noRequest: true,\n                            user: axios.defaults.headers.common['x-auth-token'],\n                            tryWebsiter: sessionStorage.getItem('tryWebsiter'),\n                        })\n                    ),\n                600000\n            )\n            heartbeat()\n        }\n        webSocket.onmessage = event => {\n            const data = JSON.parse(event.data)\n\n            switch (data.messageCode) {\n                case 'heartbeat':\n                    heartbeat()\n                    break\n                case 'logout':\n                    this.props.logout()\n                    break\n                case 'addResource':\n                    let resource = data.resource\n                    this.props.addResource(resource)\n                    break\n                case 'updateuser':\n                    this.props.updateUser(data, webSocket)\n                    break\n                case 'updatewebsite':\n                    this.props.updateWebsite(data, webSocket)\n                    break\n                case 'updateresource':\n                    this.props.updateResource(data, webSocket)\n                    break\n                case 'revertResource':\n                    this.props.revertResource(data)\n                    break\n                case 'deleteuser':\n                case 'deletewebsite':\n                case 'deleteresource':\n                    this.props.deleteResource(data)\n                    break\n                case 'confirmSaved':\n                    this.props.confirmSaved(data)\n                    break\n                case 'notFoundResource':\n                    this.markNotFoundResource(data)\n                    break\n                case 'error':\n                    alert(data.text)\n                    break\n                default:\n                    break\n            }\n        }\n        webSocket.onclose = event => {\n            clearTimeout(pingTimeout)\n            clearInterval(authInterval)\n        }\n    }\n\n    markNotFoundResource = data => {\n        const requestedResources = this.state.requestedResources.filter(\n            item => item.id.toString() === data._id.toString()\n        )\n        this.setState({ requestedResources })\n    }\n\n    checkInterval = null\n\n    check = () => {\n        if (!webSocket || webSocket.readyState === 3) {\n            this.start()\n        }\n    }\n    componentWillMount() {\n        this.checkInterval = setInterval(this.check, 5000)\n    }\n\n    reRequestResourcesInterval = null\n    reRequestResources = () => {\n        for (let requestedResource of this.state.requestedResources) {\n            if (requestedResource)\n                if (!this.props.mD.resourcesObjects[requestedResource.id]) {\n                    if (webSocket && webSocket.readyState !== 3) {\n                        webSocket.send(\n                            JSON.stringify({\n                                messageCode: 'requestResource',\n                                id: requestedResource.id,\n                                type: requestedResource.type,\n                            })\n                        )\n                    }\n                }\n        }\n    }\n    componentWillUnmount() {\n        clearInterval(this.reRequestResourcesInterval)\n        clearInterval(this.checkInterval)\n        if (webSocket) {\n            webSocket.close()\n        }\n    }\n\n    componentWillReceiveProps(nextProps) {\n        const newRequestedResourcesList = getListOfNeededResources(nextProps)\n        const requestedResources = []\n        for (const requestItem of newRequestedResourcesList) {\n            if (requestItem) {\n                let requestedResourceItem = this.state.requestedResources.find(\n                    item => item.id === requestItem.id\n                )\n                if (!requestedResourceItem) {\n                    if (webSocket && webSocket.readyState !== 3) {\n                        webSocket.send(\n                            JSON.stringify({\n                                messageCode: 'requestResource',\n                                id: requestItem.id,\n                                type: requestItem.type,\n                            })\n                        )\n                        requestedResourceItem = {\n                            id: requestItem.id,\n                            type: requestItem.type,\n                            state: 'sent',\n                        }\n                    }\n                }\n                if (requestedResourceItem)\n                    requestedResources.push(requestedResourceItem)\n            }\n        }\n        this.setState({ requestedResources })\n        clearInterval(this.reRequestResourcesInterval)\n        this.reRequestResourcesInterval = setInterval(\n            this.reRequestResources,\n            3000\n        )\n    }\n\n    render() {\n        return null\n    }\n}\n\nconst mapStateToPropsDo = state => {\n    return {\n        mD: state.mD,\n    }\n}\n\nconst mapDispatchToPropsDo = dispatch => {\n    return {\n        logout: () => dispatch(actions.logout()),\n        addResource: data => dispatch(actions.addResource(data)),\n        updateUser: (data, webSocket) =>\n            dispatch(actions.updateUser(data, webSocket)),\n        updateWebsite: (data, webSocket) =>\n            dispatch(actions.updateWebsite(data, webSocket)),\n        updateResource: (data, webSocket) =>\n            dispatch(actions.updateResource(data, webSocket)),\n        deleteResource: data => dispatch(actions.deleteResource(data)),\n        revertResource: data => dispatch(actions.revertResource(data)),\n        chooseWebsite: currentWebsiteId =>\n            dispatch(actions.chooseWebsite(currentWebsiteId)),\n        confirmSaved: data => dispatch(actions.removeResourceFromUnsaved(data)),\n    }\n}\n\nconst ReserveWebsiteDo = connect(\n    mapStateToPropsDo,\n    mapDispatchToPropsDo\n)(ReserveWebsiteInn)\n\nconst ReserveWebsite = props => {\n    const mainData = getEssentialData(\n        props.userId,\n        props.resourcesObjects,\n        props.tryWebsiter\n    )\n\n    props.saveMainData(mainData)\n    return <ReserveWebsiteDo />\n}\n\nconst mapStateToProps = state => {\n    return {\n        userId: state.userId,\n        resourcesObjects: state.resourcesObjects,\n        tryWebsiter: state.tryWebsiter,\n    }\n}\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        saveMainData: mD => dispatch(actions.saveMainData(mD)),\n    }\n}\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(ReserveWebsite)\n","export default (userId, resourcesObjects, tryWebsiter) => {\n    const userObject = resourcesObjects[userId]\n    let websites,\n        currentWebsiteItem,\n        currentWebsiteId,\n        currentWebsiteObject,\n        pagesStructure = [],\n        templatesStructure = [],\n        pluginsStructure = [],\n        currentPageId = '',\n        currentTemplateId = '',\n        currentPluginId = '',\n        currentPageItem,\n        currentTemplateItem,\n        currentPluginItem,\n        currentPageObject,\n        currentTemplateObject,\n        currentPluginObject,\n        currentPageDraft,\n        currentTemplateDraft,\n        currentPluginDraft,\n        pageTemplateName = '',\n        pageTemplateId = '',\n        pageTemplateItem,\n        pageTemplateObject,\n        pageTemplateDraft,\n        tooltipsOff\n    if (userObject) {\n        websites = userObject.websites\n        if (websites) {\n            if (websites.length > 0 && userObject.settings) {\n                tooltipsOff = userObject.settings.tooltipsOff\n                if (userObject.settings.currentWebsite) {\n                    currentWebsiteItem = websites.find(\n                        item => item.id === userObject.settings.currentWebsite\n                    )\n                }\n                if (currentWebsiteItem) {\n                    currentWebsiteId = currentWebsiteItem.id\n                    currentWebsiteObject = resourcesObjects[currentWebsiteId]\n                    if (currentWebsiteObject) {\n                        pagesStructure = currentWebsiteObject.pagesStructure\n                        templatesStructure =\n                            currentWebsiteObject.templatesStructure\n                        pluginsStructure = currentWebsiteObject.pluginsStructure\n\n                        const currentWebsiteItemSettings =\n                            userObject.settings.websites[currentWebsiteId]\n                        if (currentWebsiteItemSettings) {\n                            currentPageId =\n                                currentWebsiteItemSettings.currentPageId\n                            currentTemplateId =\n                                currentWebsiteItemSettings.currentTemplateId\n                            currentPluginId =\n                                currentWebsiteItemSettings.currentPluginId\n\n                            currentPageItem = pagesStructure.find(\n                                item => item.id === currentPageId\n                            )\n                            currentTemplateItem = templatesStructure.find(\n                                item => item.id === currentTemplateId\n                            )\n                            currentPluginItem = pluginsStructure.find(\n                                item => item.id === currentPluginId\n                            )\n                            if (currentPageItem) {\n                                currentPageObject =\n                                    resourcesObjects[currentPageId]\n                                if (currentPageObject) {\n                                    currentPageDraft = !currentPageObject\n                                        .present.structure\n                                        ? currentPageObject.draft\n                                        : currentPageObject.present\n                                }\n                                pageTemplateName =\n                                    currentPageItem.template || ''\n                                if (pageTemplateName) {\n                                    pageTemplateItem = templatesStructure.find(\n                                        item => item.name === pageTemplateName\n                                    )\n                                    if (pageTemplateItem) {\n                                        pageTemplateId = pageTemplateItem.id\n                                        pageTemplateObject =\n                                            resourcesObjects[pageTemplateId]\n                                        if (pageTemplateObject) {\n                                            pageTemplateDraft = !pageTemplateObject\n                                                .present.structure\n                                                ? pageTemplateObject.draft\n                                                : pageTemplateObject.present\n                                        }\n                                    }\n                                }\n                            }\n                            if (currentTemplateItem) {\n                                currentTemplateObject =\n                                    resourcesObjects[currentTemplateId]\n                                if (currentTemplateObject) {\n                                    currentTemplateDraft = !currentTemplateObject\n                                        .present.structure\n                                        ? currentTemplateObject.draft\n                                        : currentTemplateObject.present\n                                }\n                            }\n                            if (currentPluginItem) {\n                                currentPluginObject =\n                                    resourcesObjects[currentPluginId]\n                                if (currentPluginObject) {\n                                    currentPluginDraft = !currentPluginObject\n                                        .present.structure\n                                        ? currentPluginObject.draft\n                                        : currentPluginObject.present\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n    return {\n        userObject,\n        websites,\n        currentWebsiteItem,\n        currentWebsiteId,\n        currentWebsiteObject,\n        pagesStructure,\n        templatesStructure,\n        pluginsStructure,\n        currentPageId,\n        currentTemplateId,\n        currentPluginId,\n        currentPageItem,\n        currentTemplateItem,\n        currentPluginItem,\n        currentPageObject,\n        currentTemplateObject,\n        currentPluginObject,\n        currentPageDraft,\n        currentTemplateDraft,\n        currentPluginDraft,\n        pageTemplateName,\n        pageTemplateId,\n        pageTemplateItem,\n        pageTemplateObject,\n        pageTemplateDraft,\n        resourcesObjects,\n        userId,\n        tryWebsiter,\n        tooltipsOff,\n    }\n}\n","export const structure = {\n    page: 'pagesStructure',\n    plugin: 'pluginsStructure',\n    template: 'templatesStructure',\n}\n\nexport const current = {\n    page: 'currentPageId',\n    plugin: 'currentPluginId',\n    template: 'currentTemplateId',\n}\n\nexport const resourceDraftIndex = {\n    page: 'currentPageDraft',\n    plugin: 'currentPluginDraft',\n    template: 'currentTemplateDraft',\n}\n\nexport const resourceItemIndex = {\n    page: 'currentPageItem',\n    plugin: 'currentPluginItem',\n    template: 'currentTemplateItem',\n}\n\nexport const resourceObjectIndex = {\n    page: 'currentPageObject',\n    plugin: 'currentPluginObject',\n    template: 'currentTemplateObject',\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Div\":\"Checkbox_Div__2PqSf\",\"Input\":\"Checkbox_Input__1KbTF\",\"StyleControls\":\"Checkbox_StyleControls__cb7Ky\",\"Inline\":\"Checkbox_Inline__3XkB8\"};","import React from 'react'\n\ntype Props = {\n    className?: string,\n    icon: ?string,\n    datatestid?: string,\n}\n\ntype Element = {\n    type: string,\n    children: Array<Element>,\n    fill: string,\n    d: string,\n}\n\nexport const Svg = (props: Props) => {\n    const svgStringToObj = (svg: string): Object => {\n        const obj = []\n\n        const stack = []\n\n        while (svg.length > 0) {\n            svg = svg.trim()\n            if (svg.indexOf('</') === 0) {\n                svg = svg.substring(2)\n                if (svg.indexOf('<') > 0) {\n                    svg = svg.substring(svg.indexOf('<'))\n                    stack.pop()\n                } else {\n                    svg = ''\n                }\n            } else {\n                svg = svg.substring(svg.indexOf('<'))\n                const curObj = {\n                    type: svg.substring(1, svg.indexOf(' ')),\n                    children: [],\n                }\n                svg = svg.substring(svg.indexOf(' '))\n                let attr = svg.substring(0, svg.indexOf('>'))\n                let selfclosing = attr.indexOf('/>') >= 0\n\n                svg = svg.substring(svg.indexOf('>') + 1).trim()\n                while (attr.length > 0) {\n                    let key = attr.substring(0, attr.indexOf('=')).trim()\n                    attr = attr.substring(attr.indexOf('\"') + 1)\n                    let value = attr.substring(0, attr.indexOf('\"')).trim()\n                    attr = attr.substring(attr.indexOf('\"') + 1).trim()\n                    curObj[key] = value\n                }\n                if (stack.length === 0) {\n                    obj.push(curObj)\n                } else {\n                    stack[stack.length - 1].children.push(curObj)\n                }\n                if (!selfclosing) {\n                    stack.push(curObj)\n                }\n            }\n        }\n        return obj[0]\n    }\n\n    const svgChildrenToElements = (element: Element, elementIndex: number) => {\n        switch (element.type) {\n            case 'path':\n                return (\n                    <path key={elementIndex} d={element.d} fill={element.fill}>\n                        {element.children.map((el: Element, index) =>\n                            svgChildrenToElements(el, index)\n                        )}\n                    </path>\n                )\n            case 'g':\n                return (\n                    <g key={elementIndex} fill={element.fill}>\n                        {element.children.map((el: Element, index) =>\n                            svgChildrenToElements(el, index)\n                        )}\n                    </g>\n                )\n            default:\n                return\n        }\n    }\n\n    let result = null\n    if (props.icon) {\n        const objectSvg = svgStringToObj(props.icon)\n\n        result = (\n            <svg\n                data-testid={props.datatestid || 'svg'}\n                height={objectSvg.height}\n                width={objectSvg.width}\n                viewBox={objectSvg.viewBox}\n                className={props.className}\n            >\n                {objectSvg.children.map((element, index) =>\n                    svgChildrenToElements(element, index)\n                )}\n            </svg>\n        )\n    }\n    return result\n}\n\nexport default Svg\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Loader\":\"Spinner_Loader__2Sex0\",\"load3\":\"Spinner_load3__jNmcI\",\"Cover\":\"Spinner_Cover__3iRbu\"};"],"sourceRoot":""}