{"version":3,"sources":["store/actions/builder.js","store/actions/auth.js","store/actions/website.js","store/actions/images.js","store/actions/resources.js","store/actions/webSocket.js","store/actions/index.js","components/UI/LoginButton/LoginButton.module.css","containers/Auth/Auth.module.css","utils/basic.js","websocketActions/sendUpdate.js","websocketActions/resources.js","websocketActions/websites.js","websocketActions/images.js","websocketActions/index.js","components/UI/Checkbox/Checkbox.js","store/middleware/throttle.js","containers/Auth/Logout/Logout.js","hoc/asyncComponent.js","components/UI/LoginButton/LoginButton.js","containers/Auth/Auth.js","components/UI/Spinner/Spinner.js","utils/resourcesAreEqual.js","store/reducer/resources.js","store/reducer/reducer.js","store/reducer/images.js","store/reducer/auth.js","App.js","index.js","components/ReserveWebsite/methods/getListOfNeededResources.js","components/ReserveWebsite/ReserveWebsite.js","utils/getEssentialData.js","utils/resourceTypeIndex.js","components/UI/Checkbox/Checkbox.module.css","components/Svg/Svg.js","components/UI/Spinner/Spinner.module.css"],"names":["htmlparser","require","findElementIndex","draft","currentBox","length","structure","findIndex","item","id","findRouteElements","mode","result","push","forEach","index","path","isEqual","saveElementsStructure","type","dispatch","getState","mD","resourceDraft","resourceDraftIndex","newStructure","map","oldItem","find","itemInn","Object","objectSpread","expanded","isNotForHistory","omit","actions","saveElementsStructureFromBuilder","pageTemplateDraft","newValues","newItem","values","value","menuItems","currentMenuItem","currentMenuId","chooseBox","unhoverBox","changeBoxPropertyInStructure","key","boxId","elementIndex","deleteFromHoveredSizes","current","changes","isObject","String","toString","concat","toConsumableArray","slice","throttle","changeBoxPropertyInValues","defineProperty","saveHoveredElementRect","size","currentResource","removedElements","hoverBox","fromFrame","toggleFindMode","addBox","putInside","routeElements","element","isChildren","childrenTo","newId","currentId","newCurrentId","isCMSVariable","tag","textMode","text","isElementFromCMSVariable","textContent","properties","propertiesString","CMSVariableType","CMSVariableSystemName","CMSVariableDescription","CMSVariableDefaultValue","deleteBox","withChildren","includes","elementId","filter","notRemove","newPageStructure","pathItem","_i","_removedElements","duplicateBox","sourceChildren","idMatch","newValuesElements","newChildren","newItemId","splitText","start","end","textContent0","substr","textContent1","textContent2","newElements","textToSpan","spanId","style","changeMenuItemProperty","itemId","resource","newMenuItems","markRefreshing","refreshing","markShouldRefreshing","mergeBoxToPlugin","onlyChildren","newResourcesIds","oldResourcesIds","resourceDataValues","resourceDataStructure","indexOf","resourceData","element_0","newPluginName","prompt","wsActions","i","dissolvePluginToBox","plugin","pluginsStructure","name","resourcesObjects","pluginResource","present","pluginDataValues","pluginDataStructure","parseHTML","htmlArray","parseDOM","newElementsValues","parseToWebsiter","curArray","data","trim","attribs","newElement","newElementValues","JSON","stringify","children","cookies","Cookies","authSuccess","deleteUser","sessionStorage","getItem","alert","window","confirm","webSocket","send","messageCode","logout","all","remove","axios","defaults","headers","common","logoutDo","authCheckState","setItem","get","_id","token","rememberMe","userId","jwt","decode","post","put","delete","Accept","then","response","removeItem","catch","err","error","message","changeBarSizeDo","savePropertiesOnLeave","_getState","barSizes","settings","userObject","changeBarSize","initiator","dif","dif2","value2","value3","width","Math","max","innerWidth","height","innerHeight","width2","width3","switchTooltips","cloneDeep","tooltipsOff","chooseWebsite","currentWebsite","saveObject","chooseUserInWebsiteSharing","setSizeIsChanging","isChanging","setCurrentTopTab","currentTopTab","saveMainData","actionFailImageUpload","uploadFile","fileDetails","signedRequest","url","websiteId","file","Content-Type","label","chooseImage","image","imageUpload","files","split","currentWebsiteId","replace","namePrefix","k","currentWebsiteObject","images","fileName","fileType","fileSize","status","getSignedRequest","chooseResource","resourceType","websites","addResourceVersion","meta","undoResourceVersion","redoResourceVersion","removeResourceFromUnsaved","diffpatcher","create","objectHash","obj","propertyFilter","context","addResource","addResourceDo","deleteResource","revertResource","updateUser","currentUser","resourceId","__v","patch","__patch__","requestResource","updateWebsite","newWebsite","updateResource","isEmpty","readyState","__webpack_require__","d","__webpack_exports__","builder_chooseBox","builder_addBox","builder_deleteBox","builder_duplicateBox","builder_saveElementsStructure","builder_saveElementsStructureFromBuilder","builder_changeBoxPropertyInStructure","builder_changeBoxPropertyInValues","builder_splitText","builder_textToSpan","builder_changeMenuItemProperty","builder_mergeBoxToPlugin","builder_dissolvePluginToBox","builder_parseHTML","auth_logout","auth_authCheckState","auth_deleteUser","auth_changeBarSize","auth_savePropertiesOnLeave","auth_switchTooltips","website_chooseWebsite","resources_chooseResource","webSocket_updateUser","webSocket_updateWebsite","webSocket_updateResource","module","exports","Button","Success","Danger","Auth","Form","Title","Subtitle","ActionBlock","Middle","RememberForgot","ForgotPassword","Link","RememberMe","RememberMeLabel","Container","socialButtons","checkIfCapital","getCurrentResourceValue","buildTree","getInheritedPropertyName","lodash_isEmpty__WEBPACK_IMPORTED_MODULE_0__","lodash_isEmpty__WEBPACK_IMPORTED_MODULE_0___default","n","char","toUpperCase","toLowerCase","_defineProperty","enumerable","configurable","writable","_objectWithoutProperties","source","excluded","target","sourceKeys","keys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","prototype","propertyIsEnumerable","call","items","buildItem","arguments","ownKeys","sym","getOwnPropertyDescriptor","_objectSpread","child","charAt","sendUpdate","currentDraft","oldResource","newResource","diff","markPublish","resourceItemIndex","notPublished","duplicate","newResourceName","publishResource","to","resourceObjectIndex","changeWebsiteProperty","addWebsite","deleteWebsite","verifyCustomDomain","sharingRightsChange","right","newSharing","sharing","account","newRights","rights","addUserInWebsiteSharing","deleteUserInWebsiteSharing","transferWebsite","userTo","saveDomainName","deleteImage","renameImage","sendUpdate_sendUpdate","resources_addResource","resources_deleteResource","resources_publishResource","resources_revertResource","websites_addWebsite","websites_deleteWebsite","websites_changeWebsiteProperty","websites_verifyCustomDomain","websites_sharingRightsChange","websites_addUserInWebsiteSharing","websites_deleteUserInWebsiteSharing","websites_transferWebsite","websites_saveDomainName","images_renameImage","images_deleteImage","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","_Checkbox_module_css__WEBPACK_IMPORTED_MODULE_1__","_Checkbox_module_css__WEBPACK_IMPORTED_MODULE_1___default","Checkbox","props","a","createElement","className","inline","classes","Div","Inline","join","data-testid","datatestid","radio","Input","checked","onChange","e","title","CANCEL","FLUSH","throttled","action","method","payload","types","Array","isArray","t","Logout","this","onLogout","react_default","Redirect","Component","connect","asyncComponent","importComponent","_Component","_temp","_getPrototypeOf2","_this","classCallCheck","_len","args","_key","possibleConstructorReturn","getPrototypeOf","apply","state","component","inherits","createClass","_this2","cmp","setState","default","C","LoginButton","disabled","btnType","onClick","clicked","_useState","useState","_useState2","slicedToArray","_useState3","_useState4","cookieConsent","setCookieConsent","useEffect","checkCookieConsent","remeberMeParam","basicURL","Fragment","href","Svg","icon","UI_LoginButton_LoginButton","set","maxAge","open","spinner","cover","Cover","Loader","resourcesAreEqual","draft1","draft2","notSavedResources","removeResourceFromNewVersions","newVersionResources","initialState","loading","domainNotOk","customDomainNotOk","maxStorage","uploadingImage","currentBoxInPlugin","currentImage","sizeIsChanging","pageZoom","hoveredElementId","hoveredElementSize","isRefreshing","findMode","hoverMode","search","shouldRefresh","tryWebsiter","currentUserInWebsiteSharing","reducer","createReducer","REMOVE_RESOURCE_FROM_UNSAVED","resources","ACTION_START_IMAGE_UPLOAD","ACTION_FAIL_IMAGE_UPLOAD","ACTION_SUCCESS_IMAGE_UPLOAD","CHOOSE_IMAGE","undefined","SIZE_IS_CHANGING","ACTION_START","pagesLoading","ACTION_FAIL","ACTION_SUCCESS","ADD_RESOURCE_VERSION","newDraft","connectedResources","currentResourceId","past","shift","future","UNDO_RESOURCE_VERSION","delta","pop","unshift","unpatch","REDO_RESOURCE_VERSION","AUTH_START","auth","AUTH_SUCCESS","accountInfo","AUTH_FAIL","AUTH_LOGOUT","CHANGE_BAR_SIZE","SET_CURRENT_TOP_TAB","SAVE_HOVERED_ELEMENT_RECT","checkAndCreatePath","parent","REMOVE_FROM_HOVERED_SIZES","checkAndRemoveElement","removeFromHoveredSizes","HOVER_ELEMENT","UNHOVER_ELEMENT","TOGGLE_FIND_MODE","MARK_REFRESHING","MARK_SHOULD_REFRESHING","CHOOSE_USER_IN_WEBSITE_SHARING","SET_CURRENT_SITEBUILDER_MODE","currentSiteBuilderMode","SAVE_MAIN_DATA","ADD_RESOURCE","DELETE_RESOURCE","REVERT_RESOURCE","SAVE_OBJECT","asyncSiteBuilderLayout","Promise","bind","App","onTryAutoSignup","routes","Switch","Route","isAuthenticated","Spinner","withRouter","src_store","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","baseURL","throttleMiddleware","defaultWait","defaultThrottleOption","store","next","shouldThrottle","wait","options","isNaN","leading","trailing","createStore","applyMiddleware","thunk","app","es","BrowserRouter","src_App","inIframe","self","top","root","document","getElementById","ReactDOM","render","addConnectedResources","newRequestedResourcesList","connectedResource","nextResourceItem","nextResourceObject","nextResourceDraft","ReserveWebsiteInn","requestedResources","taskId","pingTimeout","authInterval","WebSocket","heartbeat","clearTimeout","setTimeout","close","versions","pagesStructure","onopen","event","user","setInterval","noRequest","onmessage","parse","confirmSaved","markNotFoundResource","onclose","clearInterval","checkInterval","check","reRequestResourcesInterval","reRequestResources","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","requestedResource","return","nextProps","currentPageId","currentPageDraft","pageTemplateId","currentTemplateId","currentTemplateDraft","currentPluginId","currentPluginDraft","from","Set","getListOfNeededResources","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_loop","requestItem","requestedResourceItem","_iterator2","ReserveWebsiteDo","mainData","currentWebsiteItem","currentPageItem","currentTemplateItem","currentPluginItem","currentPageObject","currentTemplateObject","currentPluginObject","pageTemplateItem","pageTemplateObject","templatesStructure","pageTemplateName","currentWebsiteItemSettings","template","getEssentialData","page","StyleControls","objectSvg","svg","stack","substring","curObj","attr","selfclosing","svgStringToObj","viewBox","svgChildrenToElements","fill","el","load3"],"mappings":"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","file":"static/js/main.5986c074.chunk.js","sourcesContent":["import * as actions from './index'\nimport * as wsActions from '../../websocketActions'\nimport isEqual from 'lodash/isEqual'\nimport omit from 'lodash/omit'\nimport isObject from 'lodash/isObject'\nimport { current, resourceDraftIndex } from '../../utils/resourceTypeIndex'\n\nimport type { resourceType } from '../../store/reducer/reducer'\nvar htmlparser = require('htmlparser2')\n\nconst findElementIndex = (draft: resourceType): number => {\n    if (!draft.currentBox) return -1\n    if (draft.currentBox.length < 1) return -1\n    return draft.structure.findIndex(item => item.id === draft.currentBox)\n}\n\nconst findRouteElements = (\n    draft: resourceType,\n    mode: 'plugin' | 'template' | 'page'\n): Array<number> => {\n    const result = []\n    if (mode === 'plugin') {\n        result.push(0)\n    } else if (mode === 'template') {\n        draft.structure.forEach((item, index) => {\n            if (item.path.length === 0 || isEqual(item.path, ['element_01']))\n                result.push(index)\n        })\n    }\n    return result\n}\n\nexport const saveElementsStructure = (\n    type,\n    structure: $PropertyType<resourceType, 'structure'>\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!mD || !type || !resourceDraft || !structure) return\n\n    const newStructure = structure.map(item => {\n        const oldItem = resourceDraft.structure.find(\n            itemInn => itemInn.id === item.id\n        )\n        if (oldItem)\n            return {\n                ...item,\n                ...oldItem,\n                expanded: item.expanded,\n                path: item.path,\n            }\n        else return item\n    })\n    const draft = { ...resourceDraft, structure: newStructure }\n\n    const isNotForHistory = isEqual(\n        resourceDraft.structure.map(item =>\n            omit(item, ['expanded', 'children', 'itemPath'])\n        ),\n        newStructure.map(item =>\n            omit(item, ['expanded', 'children', 'itemPath'])\n        )\n    )\n    dispatch(actions.addResourceVersion(mD, type, draft, {}, isNotForHistory))\n}\n\nexport const saveElementsStructureFromBuilder = (\n    type,\n    structure: $PropertyType<resourceType, 'structure'>\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!mD || !type || !resourceDraft || !structure) return\n\n    const pageTemplateDraft = mD.pageTemplateDraft\n    const newValues = {}\n    const newStructure = structure.map(item => {\n        const oldItem = resourceDraft.structure.find(\n            itemInn => itemInn.id === item.id\n        )\n        let newItem = { ...item }\n        if (oldItem) newItem = { ...newItem, expanded: oldItem.expanded }\n\n        newValues[item.id] = {\n            ...pageTemplateDraft.values[item.id],\n            value: '',\n            menuItems: [],\n            currentMenuItem: '',\n            currentMenuId: 0,\n            // properties: {},\n\n            ...(resourceDraft.values[item.id] || {}),\n        }\n\n        return { ...newItem, path: item.path }\n    })\n    const draft = {\n        ...resourceDraft,\n        structure: newStructure,\n        values: newValues,\n    }\n\n    const isNotForHistory =\n        isEqual(\n            resourceDraft.structure.map(item =>\n                omit(item, ['expanded', 'children', 'itemPath'])\n            ),\n            newStructure.map(item =>\n                omit(item, ['expanded', 'children', 'itemPath'])\n            )\n        ) && isEqual(resourceDraft.values, draft.values)\n    dispatch(actions.addResourceVersion(mD, type, draft, {}, isNotForHistory))\n}\n\nexport const chooseBox = (type, item: string) => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!mD || !type || !item || !resourceDraft) return\n    const draft = { ...resourceDraft, currentBox: item }\n    dispatch(actions.addResourceVersion(mD, type, draft, {}, true))\n    dispatch(unhoverBox())\n}\n\nexport const changeBoxPropertyInStructure = (\n    type,\n    key: string | {},\n    value: any,\n    isNotForHistory?: boolean,\n    boxId?: string\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!mD || !type || !key || !resourceDraft) return\n    let elementIndex\n    if (boxId) {\n        elementIndex = resourceDraft.structure.findIndex(\n            item => item.id === boxId\n        )\n    } else {\n        elementIndex = findElementIndex(resourceDraft)\n    }\n    if (elementIndex < 0) return\n    if (key === 'tag') {\n        dispatch(\n            deleteFromHoveredSizes(mD[current[type]], [\n                resourceDraft.structure[elementIndex].id,\n            ])\n        )\n    }\n\n    let changes = {}\n    if (isObject(key) && !(typeof key === 'string' || key instanceof String))\n        changes = key\n    else changes[key.toString()] = value\n    const draft = {\n        ...resourceDraft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            {\n                ...resourceDraft.structure[elementIndex],\n                ...changes,\n            },\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n    }\n\n    dispatch(\n        actions.addResourceVersion(\n            mD,\n            type,\n            draft,\n            {\n                throttle: 100,\n            },\n            isNotForHistory\n        )\n    )\n}\n\nexport const changeBoxPropertyInValues = (\n    type,\n    key: string | {},\n    value: any,\n    isNotForHistory?: boolean,\n    boxId?: string\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!mD || !type || !key || !resourceDraft) return\n    let elementIndex\n    if (boxId) {\n        elementIndex = resourceDraft.structure.findIndex(\n            item => item.id === boxId\n        )\n    } else {\n        elementIndex = findElementIndex(resourceDraft)\n    }\n    if (elementIndex < 0) return\n    if (key === 'tag') {\n        dispatch(\n            deleteFromHoveredSizes(mD[current[type]], [\n                resourceDraft.structure[elementIndex].id,\n            ])\n        )\n    }\n\n    let changes = {}\n    if (isObject(key) && !(typeof key === 'string' || key instanceof String))\n        changes = key\n    else changes[key.toString()] = value\n    const draft = {\n        ...resourceDraft,\n        values: {\n            ...resourceDraft.values,\n            [resourceDraft.structure[elementIndex].id]: {\n                ...resourceDraft.values[\n                    resourceDraft.structure[elementIndex].id\n                ],\n                ...changes,\n            },\n        },\n    }\n\n    dispatch(\n        actions.addResourceVersion(\n            mD,\n            type,\n            draft,\n            {\n                throttle: 1000,\n            },\n            isNotForHistory\n        )\n    )\n}\n\nexport const saveHoveredElementRect = (path: Array<string>, size: Object) => ({\n    type: 'SAVE_HOVERED_ELEMENT_RECT',\n    path,\n    size,\n})\n\nconst deleteFromHoveredSizes = (currentResource, removedElements) => ({\n    type: 'REMOVE_FROM_HOVERED_SIZES',\n    currentResource,\n    removedElements,\n})\n\nexport const hoverBox = (id: string, mode: string, fromFrame?: boolean) => ({\n    type: 'HOVER_ELEMENT',\n    id,\n    mode,\n    fromFrame,\n})\n\nexport const unhoverBox = () => ({\n    type: 'UNHOVER_ELEMENT',\n})\n\nexport const toggleFindMode = (value?: string) => ({\n    type: 'TOGGLE_FIND_MODE',\n    value,\n})\n\nexport const addBox = (\n    mode: 'plugin' | 'template' | 'page',\n    type?: 'children' | 'inside' | 'text' | 'cmsVariable'\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[mode]]\n    if (!resourceDraft) return\n    const routeElements = findRouteElements(resourceDraft, mode)\n    let elementIndex = findElementIndex(resourceDraft)\n\n    let putInside\n    if (mode === 'plugin') {\n        if (elementIndex <= 0) {\n            elementIndex = 0\n            putInside = true\n        }\n    } else if (mode === 'template') {\n        if (elementIndex < 0)\n            elementIndex = routeElements[routeElements.length - 1]\n\n        if (resourceDraft.structure[elementIndex].id === 'element_01')\n            elementIndex = routeElements[routeElements.length - 1]\n\n        if (\n            resourceDraft.structure[elementIndex].path.length < 2 &&\n            !isEqual(resourceDraft.structure[elementIndex].path, ['element_02'])\n        )\n            putInside = true\n    }\n\n    const element = resourceDraft.structure[elementIndex]\n    if (element.isChildren) {\n        putInside = false\n    } else if (element.childrenTo) {\n        putInside = true\n    } else {\n        if (type === 'inside') putInside = true\n    }\n\n    if (type === 'inside') putInside = true\n\n    const newId = `element_${resourceDraft.currentId}`\n    const newCurrentId = resourceDraft.currentId + 1\n\n    const isCMSVariable =\n        resourceDraft.structure[elementIndex].id === 'element_02' ||\n        isEqual(resourceDraft.structure[elementIndex].path, ['element_02'])\n\n    const draft = {\n        ...resourceDraft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex + 1),\n            {\n                id: newId,\n                path: putInside\n                    ? [\n                          ...resourceDraft.structure[elementIndex].path,\n                          resourceDraft.structure[elementIndex].id,\n                      ]\n                    : [...resourceDraft.structure[elementIndex].path],\n                tag:\n                    type === 'text'\n                        ? 'text'\n                        : type === 'children'\n                        ? 'New children'\n                        : isCMSVariable\n                        ? 'New CMS variable'\n                        : 'div',\n                textMode: 'text',\n                text: type === 'text',\n                isChildren: type === 'children',\n                isCMSVariable: isCMSVariable,\n                isElementFromCMSVariable: type === 'cmsVariable',\n            },\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            [newId]: {\n                textContent: '',\n                properties: {},\n                propertiesString: '',\n                CMSVariableType: 'text',\n                CMSVariableSystemName: 'newCmsVariable',\n                CMSVariableDescription: 'New CMS variable description',\n                CMSVariableDefaultValue: 'New CMS variable default value',\n            },\n        },\n        currentId: newCurrentId,\n        currentBox: newId,\n    }\n    dispatch(actions.addResourceVersion(mD, mode, draft))\n}\n\nexport const deleteBox = (\n    type: 'page' | 'plugin' | 'template',\n    withChildren?: boolean\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const routeElements = findRouteElements(resourceDraft, type)\n    let elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0 || routeElements.includes(elementIndex)) return\n\n    const elementId = resourceDraft.structure[elementIndex].id\n\n    let draft = {}\n    const removedElements = [elementId]\n    if (withChildren) {\n        draft = {\n            ...resourceDraft,\n            structure: resourceDraft.structure.filter(item => {\n                const notRemove =\n                    elementId !== item.id && !item.path.includes(elementId)\n                if (!notRemove) removedElements.push(item.id)\n                return notRemove\n            }),\n        }\n    } else {\n        const newPageStructure = resourceDraft.structure.map(item => ({\n            ...item,\n            path: item.path.filter(pathItem => pathItem !== elementId),\n        }))\n\n        draft = {\n            ...resourceDraft,\n            structure: [\n                ...newPageStructure.slice(0, elementIndex),\n                ...newPageStructure.slice(elementIndex + 1),\n            ],\n        }\n    }\n    for (let item of removedElements) {\n        delete draft.values[item.id]\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n    dispatch(deleteFromHoveredSizes(mD[current[type]], removedElements))\n}\n\nexport const duplicateBox = (\n    type: 'page' | 'plugin' | 'template',\n    withChildren?: boolean\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const routeElements = findRouteElements(resourceDraft, type)\n    let elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0 || routeElements.includes(elementIndex)) return\n\n    const elementId = resourceDraft.structure[elementIndex].id\n\n    const sourceChildren = resourceDraft.structure.filter(item =>\n        item.path.includes(elementId)\n    )\n\n    const newId = `element_${resourceDraft.currentId}`\n    let draft = { currentId: resourceDraft.currentId + 1 }\n\n    if (withChildren) {\n        const idMatch = { [elementId]: newId }\n        const newValuesElements = { [newId]: resourceDraft.values[elementId] }\n        const newChildren = sourceChildren\n            .map(item => {\n                let newItemId = `element_${draft.currentId}`\n                draft.currentId += 1\n                idMatch[item.id] = newItemId\n                newValuesElements[newItemId] = resourceDraft.values[item.id]\n                return {\n                    ...item,\n                    id: newItemId,\n                }\n            })\n            .map(item => {\n                return {\n                    ...item,\n                    // $FlowFixMe\n                    path: item.path.map(pathItem => {\n                        if (idMatch[pathItem]) {\n                            return idMatch[pathItem]\n                        } else {\n                            return pathItem\n                        }\n                    }),\n                }\n            })\n\n        draft = {\n            ...resourceDraft,\n            ...draft,\n            structure: [\n                ...resourceDraft.structure.slice(\n                    0,\n                    elementIndex + sourceChildren.length\n                ),\n                {\n                    ...resourceDraft.structure[elementIndex],\n                    id: newId,\n                },\n                ...newChildren,\n                ...resourceDraft.structure.slice(\n                    elementIndex + sourceChildren.length\n                ),\n            ],\n            values: {\n                ...resourceDraft.values,\n                ...newValuesElements,\n            },\n        }\n    } else {\n        draft = {\n            ...resourceDraft,\n            ...draft,\n            structure: [\n                ...resourceDraft.structure.slice(\n                    0,\n                    elementIndex + sourceChildren.length\n                ),\n                {\n                    ...resourceDraft.structure[elementIndex],\n                    id: newId,\n                },\n                ...resourceDraft.structure.slice(\n                    elementIndex + sourceChildren.length\n                ),\n            ],\n            values: {\n                ...resourceDraft.values,\n                [newId]: resourceDraft.values[elementId],\n            },\n        }\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n\nexport const splitText = (type, start: number, end: number) => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0) return\n\n    let draft = { currentId: resourceDraft.currentId }\n\n    let newId\n\n    const text = resourceDraft.structure[elementIndex].textContent\n    if (!text) return\n    const textContent0 = text.substr(0, start)\n    const textContent1 = text.substr(start, end - start)\n    const textContent2 = text.substr(end)\n\n    const newElements = [\n        {\n            ...resourceDraft.structure[elementIndex],\n        },\n    ]\n\n    const newValues = {\n        [elementIndex]: {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent0,\n        },\n    }\n\n    if (textContent1.length > 0) {\n        newId = `element_${draft.currentId}`\n        draft.currentId = draft.currentId + 1\n        newElements.push({\n            ...resourceDraft.structure[elementIndex],\n            id: newId,\n        })\n        newValues[newId] = {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent1,\n        }\n    }\n\n    if (textContent2.length > 0 || textContent1.length === 0) {\n        newId = `element_${draft.currentId}`\n        draft.currentId = draft.currentId + 1\n        newElements.push({\n            ...resourceDraft.structure[elementIndex],\n            id: newId,\n        })\n        newValues[newId] = {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent2,\n        }\n    }\n\n    draft = {\n        ...resourceDraft,\n        ...draft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            ...newElements,\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            ...newValues,\n        },\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n\nexport const textToSpan = (type, start: number, end: number) => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0) return\n\n    let newId\n    let draft = { currentId: resourceDraft.currentId }\n\n    const text = resourceDraft.structure[elementIndex].textContent\n    if (!text) return\n    const textContent0 = text.substr(0, start)\n    const textContent1 = text.substr(start, end - start)\n    const textContent2 = text.substr(end)\n\n    const newElements = [\n        {\n            ...resourceDraft.structure[elementIndex],\n        },\n    ]\n\n    const newValues = {\n        [elementIndex]: {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent0,\n        },\n    }\n\n    const spanId = `element_${draft.currentId}`\n    draft.currentId = draft.currentId + 1\n    newElements.push({\n        id: spanId,\n        path: [...resourceDraft.structure[elementIndex].path],\n        tag: 'span',\n        text: false,\n    })\n\n    newValues[spanId] = {\n        textContent: '',\n        style: '',\n        properties: {},\n    }\n\n    newId = `element_${draft.currentId}`\n    draft.currentId = draft.currentId + 1\n    newElements.push({\n        ...resourceDraft.structure[elementIndex],\n        path: [...resourceDraft.structure[elementIndex].path, spanId],\n        textContent: textContent1,\n        id: newId,\n    })\n\n    newValues[newId] = {\n        ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n        textContent: textContent1,\n    }\n\n    if (textContent2.length > 0) {\n        newId = `element_${draft.currentId}`\n        draft.currentId = draft.currentId + 1\n        newElements.push({\n            ...resourceDraft.structure[elementIndex],\n            textContent: textContent2,\n            id: newId,\n        })\n        newValues[newId] = {\n            ...resourceDraft.values[resourceDraft.structure[elementIndex].id],\n            textContent: textContent2,\n        }\n    }\n\n    draft = {\n        ...resourceDraft,\n        ...draft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            ...newElements,\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            ...newValues,\n        },\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n//Menu\n\nexport const changeMenuItemProperty = (\n    type,\n    key: string,\n    value: string,\n    itemId?: string\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resource = mD[resourceDraftIndex[type]]\n\n    if (!resource) return\n\n    const elementIndex = findElementIndex(resource)\n    if (elementIndex < 0) return\n    const elementId = resource.structure[elementIndex].id\n\n    if (!resource.values[elementId].menuItems) return\n    const newMenuItems = resource.values[elementId].menuItems.map(item => {\n        if (\n            item.id ===\n            (itemId ? itemId : resource.values[elementId].currentMenuItem)\n        ) {\n            return { ...item, [key]: value }\n        } else {\n            return item\n        }\n    })\n    if (!isEqual(newMenuItems, resource.values[elementId].menuItems)) {\n        dispatch(changeBoxPropertyInValues(type, 'menuItems', newMenuItems))\n    }\n}\nexport const markRefreshing = (refreshing: boolean) => ({\n    type: 'MARK_REFRESHING',\n    refreshing,\n})\n\nexport const markShouldRefreshing = (value?: boolean) => ({\n    type: 'MARK_SHOULD_REFRESHING',\n    value,\n})\n\nexport const mergeBoxToPlugin = (\n    type: 'page' | 'plugin' | 'template',\n    onlyChildren?: boolean\n) => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n\n    if (!resourceDraft) return\n    const routeElements = findRouteElements(resourceDraft, type)\n    let elementIndex = findElementIndex(resourceDraft)\n    if (\n        elementIndex <= 0 ||\n        (!onlyChildren && routeElements.includes(elementIndex))\n    )\n        return\n\n    const elementId = resourceDraft.structure[elementIndex].id\n    let currentId = 1\n    const newResourcesIds = ['element_0']\n    const oldResourcesIds = ['element_0']\n    const resourceDataValues = {}\n\n    const resourceDataStructure = resourceDraft.structure\n        .filter(\n            item =>\n                (!onlyChildren && item.id === elementId) ||\n                item.path.includes(elementId)\n        )\n        .map(item => {\n            oldResourcesIds.push(item.id)\n            const newItem = { ...item, id: `element_${currentId}` }\n            resourceDataValues[newItem.id] = {\n                ...resourceDraft.values[item.id],\n            }\n            if (item.id === elementId) {\n                newItem.path = ['element_0']\n            } else {\n                newItem.path = [\n                    'element_0',\n                    ...newItem.path.slice(\n                        newItem.path.indexOf(elementId) + (onlyChildren ? 1 : 0)\n                    ),\n                ]\n            }\n            newResourcesIds.push(newItem.id)\n            currentId++\n            return newItem\n        })\n        .map(item => ({\n            ...item,\n            path: item.path.map(\n                id => newResourcesIds[oldResourcesIds.indexOf(id)]\n            ),\n        }))\n    if (resourceDataStructure.length === 0) return\n    const resourceData = {\n        structure: [\n            {\n                id: 'element_0',\n                path: [],\n                tag: 'Main element',\n                textMode: '',\n            },\n            ...resourceDataStructure,\n        ],\n        values: {\n            ...resourceDataValues,\n            element_0: {\n                properties: {},\n                propertiesString: '',\n                textContent: '',\n            },\n        },\n        currentId,\n    }\n\n    const newPluginName =\n        prompt('Name the new plugin', 'New plugin') || 'New plugin'\n\n    dispatch(\n        wsActions.addResource('plugin', false, newPluginName, resourceData)\n    )\n\n    const draft = {\n        ...resourceDraft,\n        structure: [\n            ...resourceDraft.structure.slice(\n                0,\n                elementIndex + (onlyChildren ? 1 : 0)\n            ),\n            {\n                ...resourceDraft.structure[elementIndex],\n                path: [\n                    ...resourceDraft.structure[elementIndex].path,\n                    ...(onlyChildren\n                        ? [resourceDraft.structure[elementIndex].id]\n                        : []),\n                ],\n                tag: newPluginName,\n                text: false,\n                id: oldResourcesIds[1],\n            },\n            ...resourceDraft.structure.slice(\n                elementIndex +\n                    (onlyChildren ? 1 : 0) +\n                    resourceDataStructure.length\n            ),\n        ],\n        values: {\n            ...resourceDraft.values,\n            [oldResourcesIds[1]]: {\n                textContent: '',\n                propertiesString: '',\n                properties: {},\n            },\n        },\n    }\n    for (let i = 2; i < oldResourcesIds.length; i++) {\n        delete draft.values[oldResourcesIds[i]]\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft, { throttle: 1000 }))\n}\n\nexport const dissolvePluginToBox = type => (dispatch: Object, getState) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    let elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0) return\n\n    // const elementId = resourceDraft.structure[elementIndex].id\n\n    const plugin = mD.pluginsStructure.find(\n        item => item.name === resourceDraft.structure[elementIndex].tag\n    )\n    if (!plugin) return\n    if (!mD.resourcesObjects[plugin.id]) return\n\n    const pluginResource = !mD.resourcesObjects[plugin.id].present.structure\n        ? mD.resourcesObjects[plugin.id].draft\n        : mD.resourcesObjects[plugin.id].present\n\n    let currentId = resourceDraft.currentId\n    const newResourcesIds = []\n    const oldResourcesIds = []\n    const pluginDataValues = {}\n\n    const pluginDataStructure = pluginResource.structure\n        .filter(item => item.path.length > 0)\n        .map(item => {\n            oldResourcesIds.push(item.id)\n            const newItem = {\n                ...item,\n                id: `element_${currentId}`,\n                path: [...item.path.slice(1)],\n            }\n            pluginDataValues[newItem.id] = resourceDraft.values[item.id]\n\n            newResourcesIds.push(newItem.id)\n            currentId++\n            return newItem\n        })\n        .map(item => ({\n            ...item,\n            path: [\n                ...resourceDraft.structure[elementIndex].path,\n                ...item.path.map(\n                    id => newResourcesIds[oldResourcesIds.indexOf(id)]\n                ),\n            ],\n        }))\n\n    const draft = {\n        ...resourceDraft,\n        currentId,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            ...pluginDataStructure,\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            ...pluginDataValues,\n        },\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n\nexport const setCurrentSiteBuilderMode = (mode: string) => ({\n    type: 'SET_CURRENT_SITEBUILDER_MODE',\n    mode,\n})\n\nexport const parseHTML = (type, value: string) => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    const resourceDraft = mD[resourceDraftIndex[type]]\n    if (!resourceDraft) return\n    const elementIndex = findElementIndex(resourceDraft)\n    if (elementIndex < 0) return\n    let draft = { currentId: resourceDraft.currentId }\n\n    const htmlArray = htmlparser.parseDOM(value)\n    const newElements = []\n    const newElementsValues = {}\n    const parseToWebsiter = (curArray, path) => {\n        curArray.forEach(item => {\n            if (!(item.type === 'text' && item.data.trim() === '')) {\n                if (item.type === 'text' || item.type === 'tag') {\n                    const newId = `element_${draft.currentId}`\n                    draft.currentId = draft.currentId + 1\n                    const properties = item.attribs\n                        ? omit(item.attribs, 'style')\n                        : {}\n                    const newElement = {\n                        id: newId,\n                        path,\n                        tag: item.name || 'div',\n                        text: false,\n                    }\n                    const newElementValues = {\n                        textContent: '',\n                        style: item.attribs ? item.attribs.style || '' : '',\n                        properties,\n                        propertiesString: JSON.stringify(properties),\n                    }\n                    if (item.type === 'text') {\n                        newElement.tag = 'text'\n                        newElement.text = true\n                        newElementValues.textMode = 'text'\n                        newElementValues.textContent = item.data\n                    }\n                    newElements.push(newElement)\n                    newElementsValues[newId] = newElementValues\n                    if (item.children)\n                        parseToWebsiter(item.children, [...path, newId])\n                }\n            }\n        })\n    }\n    parseToWebsiter(htmlArray, resourceDraft.structure[elementIndex].path)\n    draft = {\n        ...resourceDraft,\n        ...draft,\n        structure: [\n            ...resourceDraft.structure.slice(0, elementIndex),\n            ...newElements,\n            ...resourceDraft.structure.slice(elementIndex + 1),\n        ],\n        values: {\n            ...resourceDraft.values,\n            ...newElementsValues,\n        },\n    }\n    dispatch(actions.addResourceVersion(mD, type, draft))\n}\n\n/////////////////////OLDOLDOLDOLDOLD\n// export const changeElementStyleValue = (\n//     index: number,\n//     key: string,\n//     value: any,\n//     elementId: string\n// ) => ({\n//     type: actionTypes.CHANGE_ELEMENT_STYLE_VALUE,\n//     index,\n//     key,\n//     value,\n//     elementId,\n// })\n\n// export const addElementStyleValue = (index: number, elementId: string) => ({\n//     type: actionTypes.ADD_ELEMENT_STYLE_VALUE,\n//     index,\n//     elementId,\n// })\n\n// export const deleteElementStyleValue = (index: number, elementId: string) => ({\n//     type: actionTypes.DELETE_ELEMENT_STYLE_VALUE,\n//     index,\n//     elementId,\n// })\n\n// export const changeElementPropertyValue = (\n//     value: any,\n//     key: string,\n//     isSection?: boolean,\n//     isNotForHistory?: boolean\n// ) => ({\n//     type: actionTypes.CHANGE_ELEMENT_PROPERTY_VALUE,\n//     value,\n//     key,\n//     isSection,\n//     isNotForHistory,\n// })\n\n// export const builderZoomOut = () => ({ type: actionTypes.BUILDER_ZOOM_OUT })\n// export const builderZoomIn = () => ({ type: actionTypes.BUILDER_ZOOM_IN })\n// export const builderZoomReset = () => ({ type: actionTypes.BUILDER_ZOOM_RESET })\n\n// export const saveToHistory = () => ({ type: actionTypes.SAVE_TO_HISTORY })\n\n// export const loadCurrentPageToBuilder = (\n//     _id: ?string,\n//     resourcesObjects?: Object,\n//     pageObject?: Object\n// ) => ({\n//     type: actionTypes.LOAD_CURRENT_PAGE_TO_BUILDER,\n//     _id,\n//     resourcesObjects,\n//     pageObject,\n// })\n","import axios from 'axios'\nimport Cookies from 'universal-cookie'\nimport jwt from 'jsonwebtoken'\n\nimport * as actions from './index'\n\nimport cloneDeep from 'lodash/cloneDeep'\nimport { webSocket } from '../../components/ReserveWebsite/ReserveWebsite'\n\nconst cookies = new Cookies()\n\nexport const authStart = () => ({\n    type: 'AUTH_START',\n})\n\nexport const authSuccess = (data: Object) => ({\n    type: 'AUTH_SUCCESS',\n    data,\n})\n\nexport const authFail = (error: string) => ({\n    type: 'AUTH_FAIL',\n    error,\n})\n\nexport const deleteStart = () => ({\n    type: 'ACTION_START',\n})\n\nexport const deleteSuccess = () => ({\n    type: 'ACTION_SUCCESS',\n})\n\nexport const deleteFail = (error: string) => ({\n    type: 'ACTION_FAIL',\n    error,\n})\n\nexport const deleteUser = () => (dispatch: Object) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (window.confirm('Are you sure you would like to delete your account?'))\n        if (\n            window.confirm(\n                'This action cannot be reverted. All your websites will be deleted.'\n            )\n        )\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'deleteUser',\n                })\n            )\n}\n\nexport const logout = (all?: boolean) => (dispatch: Object) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (!all) {\n        cookies.remove('auth_token')\n        axios.defaults.headers.common['x-auth-token'] = null\n        dispatch(logoutDo())\n    } else {\n        if (webSocket) {\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'logoutAll',\n                })\n            )\n        }\n    }\n}\n\nconst logoutDo = () => ({\n    type: 'AUTH_LOGOUT',\n})\n\nexport const authCheckState = () => (dispatch: Object) => {\n    sessionStorage.setItem('systemRefresh', '0')\n    const tryWebsiter = cookies.get('try_websiter')\n    if (tryWebsiter) {\n        cookies.remove('try_websiter', {\n            path: '/',\n        })\n        sessionStorage.setItem('tryWebsiter', '1')\n        dispatch(\n            authSuccess({\n                _id: 'try',\n            })\n        )\n        return\n    }\n    const token = cookies.get('auth_token')\n    const rememberMe = cookies.get('rememberme')\n    if (rememberMe) {\n        cookies.remove('rememberme', {\n            path: '/',\n        })\n        if (rememberMe === 'false') {\n            cookies.remove('auth_token', {\n                path: '/',\n            })\n        }\n    }\n    const userId = jwt.decode(token)\n    axios.defaults.headers.post['Content-Type'] = 'application/json'\n    axios.defaults.headers.put['Content-Type'] = 'application/json'\n    axios.defaults.headers.delete['Content-Type'] = 'application/json'\n    axios.defaults.headers.common.Accept = 'application/json'\n\n    if (!token || !userId) {\n        dispatch(logout())\n    } else {\n        axios.defaults.headers.common['x-auth-token'] = token\n        axios.defaults.headers.post['x-auth-token'] = token\n        axios.defaults.headers.get['x-auth-token'] = token\n        axios.defaults.headers.delete['x-auth-token'] = token\n        axios.defaults.headers.put['x-auth-token'] = token\n        dispatch(authStart())\n        return axios\n            .get('/api/users')\n            .then(response => {\n                sessionStorage.removeItem('tryWebsiter')\n                dispatch(\n                    authSuccess({\n                        _id: userId._id,\n                    })\n                )\n            })\n            .catch(err => {\n                cookies.remove('auth_token', {\n                    path: '/',\n                })\n                dispatch(authFail(err.message))\n            })\n    }\n}\n\nexport const changeBarSizeDo = (key: string, value: number) => ({\n    type: 'CHANGE_BAR_SIZE',\n    key,\n    value,\n})\n\nexport const savePropertiesOnLeave = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter')) return\n    const { mD, barSizes } = getState()\n    webSocket.send(\n        JSON.stringify({\n            messageCode: 'saveSettings',\n            settings: {\n                ...mD.userObject.settings,\n                barSizes,\n            },\n        })\n    )\n}\n\nexport const changeBarSize = (initiator?: { key: string, value: number }) => (\n    dispatch: Object,\n    getState\n) => {\n    const { barSizes } = getState()\n    const width = Math.max(window.innerWidth, 700),\n        height = window.innerHeight\n    let value, dif, dif2, value2, value3\n\n    if (!initiator) {\n        if (barSizes.height > height - 50) {\n            dispatch(actions.changeBarSizeDo('height', height - 50))\n        }\n        if (barSizes.width > width - 100) {\n            dispatch(actions.changeBarSizeDo('width', width - 100))\n        }\n        if (barSizes.width + barSizes.width2 > width - 50) {\n            dispatch(\n                actions.changeBarSizeDo('width2', width - barSizes.width - 50)\n            )\n        }\n    } else {\n        switch (initiator.key) {\n            case 'height':\n                value = initiator.value\n                if (value < 50) value = 50\n                if (value > height - 50) value = height - 50\n                dispatch(actions.changeBarSizeDo('height', value))\n                break\n            case 'width':\n                value = initiator.value\n                if (value < 50) value = 50\n                dif = value - barSizes.width\n                value2 = barSizes.width2 - dif\n                value3 = barSizes.width3\n                if (value2 < 50) {\n                    dif2 = value2 - 50\n                    value2 = 50\n                    value3 = barSizes.width3 + dif2\n                    if (value3 < 50) value3 = 50\n                }\n                if (value + value2 + value3 + 50 > width) {\n                    value = width - 150\n                    value2 = 50\n                    value3 = 50\n                }\n                dispatch(actions.changeBarSizeDo('width', value))\n                dispatch(actions.changeBarSizeDo('width2', value2))\n                dispatch(actions.changeBarSizeDo('width3', value3))\n                break\n            case 'width2':\n                value2 = initiator.value\n                value = barSizes.width\n                dif = value2 - 50\n                if (dif < 0) {\n                    value = value + dif\n                    if (value < 50) value = 50\n                    dif2 = value - barSizes.width\n                    value3 = barSizes.width3 - dif2\n                    value2 = 50\n                }\n                dif = value + value2 - barSizes.width - barSizes.width2\n                value3 = barSizes.width3 - dif\n                if (value3 < 50) value3 = 50\n                if (value + value2 + value3 + 50 > width) {\n                    value2 = width - value - 100\n                }\n                dispatch(actions.changeBarSizeDo('width', value))\n                dispatch(actions.changeBarSizeDo('width2', value2))\n                dispatch(actions.changeBarSizeDo('width3', value3))\n                break\n            case 'width3':\n                value3 = initiator.value\n                value = barSizes.width\n                value2 = barSizes.width2\n                dif = value3 - 50\n                if (dif < 0) {\n                    value2 = value2 + dif\n                    dif2 = value2 - 50\n                    if (dif2 < 0) {\n                        value = value + dif2\n                        if (value < 50) value = 50\n                        value2 = 50\n                    }\n                    value3 = 50\n                }\n                if (value + value2 + value3 + 50 > width) {\n                    value3 = width - value - value2 - 50\n                }\n                dispatch(actions.changeBarSizeDo('width', value))\n                dispatch(actions.changeBarSizeDo('width2', value2))\n                dispatch(actions.changeBarSizeDo('width3', value3))\n                break\n            default:\n                break\n        }\n    }\n}\n\nexport const switchTooltips = () => (dispatch, getState) => {\n    const { mD } = getState()\n    const userObject = cloneDeep(mD.userObject)\n    userObject.settings.tooltipsOff = !userObject.settings.tooltipsOff\n    dispatch(actions.saveObject(userObject))\n}\n","import cloneDeep from 'lodash/cloneDeep'\n\nexport const chooseWebsite = id => (dispatch, getState) => {\n    const { mD } = getState()\n    const userObject = cloneDeep(mD.userObject)\n    userObject.settings.currentWebsite = id\n    dispatch(saveObject(userObject))\n}\n\nexport const saveObject = data => ({\n    type: 'SAVE_OBJECT',\n    data,\n})\n\nexport const chooseUserInWebsiteSharing = (id: string) => ({\n    type: 'CHOOSE_USER_IN_WEBSITE_SHARING',\n    id,\n})\n\nexport const setSizeIsChanging = (isChanging: boolean) => ({\n    type: 'SIZE_IS_CHANGING',\n    isChanging,\n})\n\nexport const setCurrentTopTab = (currentTopTab: string) => ({\n    type: 'SET_CURRENT_TOP_TAB',\n    currentTopTab,\n})\n\nexport const saveMainData = mD => ({\n    type: 'SAVE_MAIN_DATA',\n    mD,\n})\n","import axios from 'axios'\nimport { webSocket } from '../../components/ReserveWebsite/ReserveWebsite'\n\nconst actionStartImageUpload = () => ({\n    type: 'ACTION_START_IMAGE_UPLOAD',\n})\n\nconst actionSuccessImageUpload = () => ({\n    type: 'ACTION_SUCCESS_IMAGE_UPLOAD',\n})\n\nconst actionFailImageUpload = (error: string) => ({\n    type: 'ACTION_FAIL_IMAGE_UPLOAD',\n    error,\n})\n\nconst getSignedRequest = file => (dispatch: Object, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (!mD.currentWebsiteId) return\n    let name =\n        mD.currentWebsiteId +\n        '/' +\n        file.name.replace(/([^a-zA-Z0-9\\\\.\\\\-])/g, '_')\n\n    let namePrefix = ''\n    let k = 0\n\n    const checkName = () =>\n        mD.currentWebsiteObject.images.findIndex(\n            image => name + namePrefix === image.name\n        )\n    while (checkName() >= 0) {\n        k++\n        namePrefix = '_' + k\n    }\n\n    const fileDetails = {\n        size: file.size,\n        name: name + namePrefix,\n        label: file.name + namePrefix,\n        type: file.type,\n        file,\n    }\n\n    return axios\n        .post('/api/sign-s3', {\n            fileName: fileDetails.name,\n            fileType: file.type,\n            fileSize: fileDetails.size,\n            websiteId: mD.currentWebsiteId,\n        })\n        .then(response => {\n            dispatch(\n                uploadFile(\n                    fileDetails,\n                    response.data.signedRequest,\n                    response.data.url,\n                    mD.currentWebsiteId\n                )\n            )\n        })\n        .catch(err => {\n            dispatch(actionFailImageUpload(err.message))\n            if (err.response.status === 400) alert(err.response.data)\n        })\n}\n\nconst uploadFile = (fileDetails, signedRequest, url, websiteId) => (\n    dispatch: Object\n) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    return axios\n        .put(signedRequest, fileDetails.file, {\n            headers: {\n                'Content-Type': 'multipart/form-data',\n            },\n        })\n        .then(response => {\n            if (webSocket)\n                webSocket.send(\n                    JSON.stringify({\n                        messageCode: 'addImage',\n                        _id: websiteId,\n                        size: fileDetails.size,\n                        name: fileDetails.name,\n                        label: fileDetails.label,\n                        type: fileDetails.type,\n                        url,\n                    })\n                )\n            dispatch(actionSuccessImageUpload())\n        })\n        .catch(err => {\n            dispatch(actionFailImageUpload(err.message))\n        })\n}\n\nexport const chooseImage = (image: string) => ({\n    type: 'CHOOSE_IMAGE',\n    image,\n})\n\nexport const imageUpload = (\n    files: Array<{ type: string, size: number, name: string }>\n) => (dispatch: Object) => {\n    const file = files[0]\n\n    if (file == null) {\n        return alert('No file selected.')\n    }\n    if (file.type.split('/')[0] !== 'image') {\n        return alert('File is not an image.')\n    }\n    dispatch(actionStartImageUpload())\n    dispatch(getSignedRequest(file))\n}\n","import * as actions from './'\nimport { current } from '../../utils/resourceTypeIndex'\nimport cloneDeep from 'lodash/cloneDeep'\n\nexport const chooseResource = (\n    id: string,\n    resourceType: 'plugin' | 'page' | 'template'\n) => (dispatch, getState) => {\n    const { mD } = getState()\n    const userObject = cloneDeep(mD.userObject)\n    if (!userObject.settings.websites[userObject.settings.currentWebsite])\n        userObject.settings.websites[userObject.settings.currentWebsite] = {}\n    userObject.settings.websites[userObject.settings.currentWebsite][\n        current[resourceType]\n    ] = id\n    dispatch(actions.saveObject(userObject))\n}\n\nexport const addResourceVersion = (\n    mD,\n    resourceType,\n    draft,\n    meta,\n    isNotForHistory?: boolean\n) => ({\n    type: 'ADD_RESOURCE_VERSION',\n    mD,\n    resourceType,\n    draft,\n    meta,\n    isNotForHistory,\n})\n\nexport const undoResourceVersion = () => ({\n    type: 'UNDO_RESOURCE_VERSION',\n})\n\nexport const redoResourceVersion = () => ({\n    type: 'REDO_RESOURCE_VERSION',\n})\n\nexport const removeResourceFromUnsaved = data => ({\n    type: 'REMOVE_RESOURCE_FROM_UNSAVED',\n    _id: data._id,\n})\n","import cloneDeep from 'lodash/cloneDeep'\nimport omit from 'lodash/omit'\nimport isEmpty from 'lodash/isEmpty'\n\nconst diffpatcher = require('jsondiffpatch/dist/jsondiffpatch.umd.js').create({\n    objectHash: obj => obj.id,\n    propertyFilter: (name, context) => name !== '__patch__',\n})\n\nexport const addResource = (data: Object) => (dispatch, getState) => {\n    dispatch(addResourceDo(data))\n}\n\nexport const addResourceDo = (data: Object) => ({\n    type: 'ADD_RESOURCE',\n    data,\n})\n\nexport const deleteResource = (data: Object) => ({\n    type: 'DELETE_RESOURCE',\n    data,\n})\n\nexport const revertResource = (data: Object) => ({\n    type: 'REVERT_RESOURCE',\n    data,\n})\n\nexport const updateUser = (data: Object, webSocket) => (dispatch, getState) => {\n    if (data) {\n        const { mD } = getState()\n        const currentUser = omit(\n            cloneDeep(mD.resourcesObjects[data.resourceId]),\n            ['settings']\n        )\n        if (currentUser) {\n            if (currentUser.__v === data.resource.__v - 1) {\n                currentUser.websites = diffpatcher.patch(\n                    currentUser.websites,\n                    data.resource.__patch__\n                )\n                currentUser.__v = data.resource.__v\n                dispatch(addResource(currentUser, mD))\n                return\n            }\n        }\n        requestResource(data.resource._id, data.type, webSocket)\n    }\n}\n\nexport const updateWebsite = (data: Object, webSocket) => (\n    dispatch,\n    getState\n) => {\n    if (data) {\n        const { mD } = getState()\n        const currentWebsite = cloneDeep(mD.resourcesObjects[data.resourceId])\n        if (currentWebsite) {\n            if (currentWebsite.__v === data.resource.__v - 1) {\n                const newWebsite = diffpatcher.patch(\n                    currentWebsite,\n                    data.resource.__patch__\n                )\n                newWebsite.__v = data.resource.__v\n                dispatch(addResource(newWebsite, mD))\n                return\n            }\n        }\n        requestResource(data.resource._id, data.type, webSocket)\n    }\n}\n\nexport const updateResource = (data: Object, webSocket) => (\n    dispatch,\n    getState\n) => {\n    if (data) {\n        const { mD } = getState()\n        const currentResource = cloneDeep(mD.resourcesObjects[data.resourceId])\n        if (currentResource) {\n            if (currentResource.__v === data.resource.__v - 1) {\n                if (!isEmpty(data.resource.__patch__)) {\n                    currentResource.draft = diffpatcher.patch(\n                        currentResource.draft,\n                        data.resource.__patch__\n                    )\n                }\n                currentResource.__v = data.resource.__v\n                dispatch(addResource(currentResource, mD))\n                return\n            }\n        }\n        requestResource(data.resource._id, data.type, webSocket)\n    }\n}\n\nconst requestResource = (id, type, webSocket) => {\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'requestResource',\n                id,\n                type,\n            })\n        )\n    }\n}\n","export {\n    chooseBox,\n    addBox,\n    deleteBox,\n    duplicateBox,\n    saveElementsStructure,\n    saveElementsStructureFromBuilder,\n    changeBoxPropertyInStructure,\n    changeBoxPropertyInValues,\n    hoverBox,\n    unhoverBox,\n    saveHoveredElementRect,\n    splitText,\n    textToSpan,\n    changeMenuItemProperty,\n    markRefreshing,\n    mergeBoxToPlugin,\n    dissolvePluginToBox,\n    toggleFindMode,\n    markShouldRefreshing,\n    setCurrentSiteBuilderMode,\n    parseHTML,\n} from './builder'\n\nexport {\n    logout,\n    authCheckState,\n    deleteUser,\n    changeBarSize,\n    changeBarSizeDo,\n    savePropertiesOnLeave,\n    switchTooltips,\n} from './auth'\n\nexport {\n    setSizeIsChanging,\n    chooseWebsite,\n    setCurrentTopTab,\n    chooseUserInWebsiteSharing,\n    saveObject,\n    saveMainData,\n} from './website'\n\nexport { imageUpload, chooseImage } from './images'\n\nexport {\n    chooseResource,\n    addResourceVersion,\n    undoResourceVersion,\n    redoResourceVersion,\n    removeResourceFromUnsaved,\n} from './resources'\n\nexport {\n    addResource,\n    updateUser,\n    updateWebsite,\n    updateResource,\n    deleteResource,\n    revertResource,\n} from './webSocket'\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Button\":\"LoginButton_Button__2dj44\",\"Success\":\"LoginButton_Success__21MoZ\",\"Danger\":\"LoginButton_Danger__2V7Lr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Auth\":\"Auth_Auth__3LJcp\",\"Form\":\"Auth_Form__2cblE\",\"Title\":\"Auth_Title__akRbA\",\"Subtitle\":\"Auth_Subtitle__2ymfd\",\"ActionBlock\":\"Auth_ActionBlock__3jKGi\",\"Middle\":\"Auth_Middle__J8yom\",\"RememberForgot\":\"Auth_RememberForgot__vAgsm\",\"ForgotPassword\":\"Auth_ForgotPassword__2P2hF\",\"Link\":\"Auth_Link__1O5md\",\"RememberMe\":\"Auth_RememberMe__3xI2n\",\"RememberMeLabel\":\"Auth_RememberMeLabel__2SEKu\",\"Container\":\"Auth_Container__KMvOh\",\"socialButtons\":\"Auth_socialButtons__37I7_\"};","import isEmpty from 'lodash/isEmpty'\n\nexport const checkIfCapital = (char: string) => {\n    if (char === char.toUpperCase() && char !== char.toLowerCase()) {\n        return true\n    }\n}\n\nexport const getCurrentResourceValue = (id: string, resourcesObjects: {}) =>\n    id\n        ? resourcesObjects[id]\n            ? isEmpty(resourcesObjects[id].present)\n                ? resourcesObjects[id].draft\n                : resourcesObjects[id].present\n            : null\n        : null\n\nfunction _objectSpread(target) {\n    for (var i = 1; i < arguments.length; i++) {\n        var source = arguments[i] != null ? arguments[i] : {}\n        var ownKeys = Object.keys(source)\n        if (typeof Object.getOwnPropertySymbols === 'function') {\n            ownKeys = ownKeys.concat(\n                //eslint-disable-next-line\n                Object.getOwnPropertySymbols(source).filter(function(sym) {\n                    return Object.getOwnPropertyDescriptor(\n                        source,\n                        sym\n                        // $FlowFixMe\n                    ).enumerable\n                })\n            )\n        }\n        //eslint-disable-next-line\n        ownKeys.forEach(function(key) {\n            // $FlowFixMe\n            _defineProperty(target, key, source[key])\n        })\n    }\n    return target\n}\n\nfunction _defineProperty(obj, key, value) {\n    // $FlowFixMe\n    if (key in obj) {\n        Object.defineProperty(obj, key, {\n            value: value,\n            enumerable: true,\n            configurable: true,\n            writable: true,\n        })\n    } else {\n        // $FlowFixMe\n        obj[key] = value\n    }\n    return obj\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n    if (source == null) return {}\n    var target = _objectWithoutPropertiesLoose(source, excluded)\n    var key, i\n    if (Object.getOwnPropertySymbols) {\n        var sourceSymbolKeys = Object.getOwnPropertySymbols(source)\n        for (i = 0; i < sourceSymbolKeys.length; i++) {\n            key = sourceSymbolKeys[i]\n            if (excluded.indexOf(key) >= 0) continue\n            if (!Object.prototype.propertyIsEnumerable.call(source, key))\n                continue\n            // $FlowFixMe\n            target[key] = source[key]\n        }\n    }\n    return target\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {}\n    var target = {}\n    var sourceKeys = Object.keys(source)\n    var key, i\n    for (i = 0; i < sourceKeys.length; i++) {\n        key = sourceKeys[i]\n        if (excluded.indexOf(key) >= 0) continue\n        target[key] = source[key]\n    }\n    return target\n}\n// $FlowFixMe\nexport function buildTree(items) {\n    var buildItem = function buildItem(item) {\n        // var path = item.path,\n        var data = _objectWithoutProperties(item, ['path'])\n        // $FlowFixMe\n        return _objectSpread({}, data, {\n            children: items\n                .filter(function(child) {\n                    return child.path[child.path.length - 1] === item.id\n                })\n                .map(function(child) {\n                    return buildItem(child)\n                }),\n        })\n    }\n\n    var tree = items\n        .filter(function(item) {\n            return item.path.length === 0\n        })\n        .map(function(item) {\n            return buildItem(item)\n        })\n    return tree\n}\n\nexport const getInheritedPropertyName = (value: string) => {\n    const length = value.length\n    if (length > 2) {\n        if (value.charAt(0) === '$' && value.charAt(length - 1) === '$') {\n            return value.substr(1, length - 2)\n        }\n    }\n    return false\n}\n","import { webSocket } from '../components/ReserveWebsite/ReserveWebsite'\nimport {\n    resourceItemIndex,\n    resourceDraftIndex,\n} from '../utils/resourceTypeIndex'\n\nconst diffpatcher = require('jsondiffpatch/dist/jsondiffpatch.umd.js').create({\n    objectHash: obj => obj.id,\n    propertyFilter: (name, context) => name !== '__patch__',\n})\n\nexport const sendUpdate = (\n    type: 'user' | 'website' | 'page' | 'template' | 'plugin',\n    changes: {},\n    id: string\n) => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    const oldResource = mD.resourcesObjects[id]\n    if (oldResource) {\n        let draft, currentDraft\n        if (['page', 'template', 'plugin'].includes(type)) {\n            draft = oldResource.draft\n            currentDraft = mD[resourceDraftIndex[type]]\n        } else {\n            draft = oldResource\n            currentDraft = oldResource\n        }\n        if (draft && changes) {\n            const newResource = { ...currentDraft, ...changes }\n            const patch = diffpatcher.diff(draft, newResource)\n            if (patch) {\n                if (webSocket && webSocket.readyState !== 3) {\n                    webSocket.send(\n                        JSON.stringify({\n                            messageCode: 'updateResource',\n                            type,\n                            _id: id,\n                            __patch__: patch,\n                            __v: oldResource.__v,\n                            markPublish: [\n                                'page',\n                                'template',\n                                'plugin',\n                            ].includes(type)\n                                ? !mD[resourceItemIndex[type]].notPublished\n                                : false,\n                        })\n                    )\n                }\n            }\n        }\n    }\n}\n","import { webSocket } from '../components/ReserveWebsite/ReserveWebsite'\nimport { current, resourceObjectIndex } from '../utils/resourceTypeIndex'\nimport * as actions from '../store/actions'\n\nexport const addResource = (\n    type: 'page' | 'plugin' | 'template',\n    duplicate?: boolean,\n    newResourceName?: string,\n    resourceData?: {}\n) => (dispatch: Object, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'addResource',\n                type,\n                websiteId: mD.currentWebsiteId,\n                duplicate,\n                _id: mD[current[type]],\n                name: newResourceName,\n                resourceData,\n            })\n        )\n    }\n}\n\nexport const deleteResource = (type: 'page' | 'plugin' | 'template') => (\n    dispatch: Object,\n    getState\n) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (!window.confirm('Are you sure you want to delete this resource?'))\n        return\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'deleteResource',\n                type,\n                _id: mD[current[type]],\n            })\n        )\n    }\n}\n\nexport const publishResource = (type: 'page' | 'plugin' | 'template') => (\n    dispatch: Object,\n    getState\n) => {\n    const { mD } = getState()\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'publishResource',\n                type,\n                _id: mD[current[type]],\n            })\n        )\n    }\n}\n\nexport const revertResource = (type, to) => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (to === 'draft') {\n        dispatch(\n            actions.revertResource({\n                _id: mD[current[type]],\n                draft: mD[resourceObjectIndex[type]].draft,\n                to,\n            })\n        )\n    } else {\n        if (webSocket && webSocket.readyState !== 3) {\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'revertResource',\n                    type,\n                    _id: mD[current[type]],\n                    to,\n                })\n            )\n        }\n    }\n}\n","import { webSocket } from '../components/ReserveWebsite/ReserveWebsite'\nimport { sendUpdate } from './sendUpdate'\nimport cloneDeep from 'lodash/cloneDeep'\n\nexport const changeWebsiteProperty = (key, value, id) => (\n    dispatch,\n    getState\n) => {\n    const { mD } = getState()\n    if (!mD.currentWebsiteObject || !mD.currentWebsiteId) return\n    const newResource = cloneDeep(\n        id ? mD.resourcesObjects[id] : mD.currentWebsiteObject\n    )\n    if (!newResource) return\n    newResource[key] = value\n    dispatch(sendUpdate('website', newResource, mD.currentWebsiteId))\n}\n\nexport const addWebsite = (duplicate?: boolean) => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'addWebsite',\n                _id: mD.currentWebsiteId,\n                duplicate,\n            })\n        )\n    }\n}\n\nexport const deleteWebsite = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'deleteWebsite',\n                _id: mD.currentWebsiteId,\n            })\n        )\n    }\n}\n\nexport const verifyCustomDomain = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (webSocket && webSocket.readyState !== 3) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'verifyCustomDomain',\n                _id: mD.currentWebsiteId,\n            })\n        )\n    }\n}\n\nexport const sharingRightsChange = (userId, right, value) => (\n    dispatch,\n    getState\n) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (mD.currentWebsiteObject) {\n        const newSharing = cloneDeep(mD.currentWebsiteObject.sharing)\n        const account = newSharing.find(item => item.userId === userId)\n        if (account) {\n            let newRights = []\n            if (value) {\n                newRights = [...account.rights, right]\n            } else {\n                newRights = account.rights.filter(item => item !== right)\n            }\n            // const updatedSharing = mD.currentWebsiteObject.sharing.filter(\n            //     item => item.userId !== userId\n            // )\n            // updatedSharing.push({\n            //     ...account,\n            //     rights: newRights,\n            // })\n            account.rights = newRights\n            dispatch(\n                changeWebsiteProperty(\n                    'sharing',\n                    newSharing,\n                    mD.currentWebsiteId\n                )\n            )\n        }\n    }\n}\n\nexport const addUserInWebsiteSharing = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (mD.currentWebsiteObject) {\n        const id = window.prompt('Paste the user id to share the website.')\n        if (!id) return\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'addUserInSharing',\n                _id: mD.currentWebsiteId,\n                userId: id,\n                type: 'add',\n            })\n        )\n    }\n}\n\nexport const deleteUserInWebsiteSharing = userId => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (userId && userId !== mD.userId) {\n        if (\n            !window.confirm(\n                'Are you sure you want to remove this user from sharing?'\n            )\n        )\n            return\n    }\n\n    webSocket.send(\n        JSON.stringify({\n            messageCode: 'addUserInSharing',\n            _id: mD.currentWebsiteId,\n            userId,\n            type: 'delete',\n        })\n    )\n}\n\nexport const transferWebsite = () => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (mD.currentWebsiteObject) {\n        const userTo = window.prompt(\n            'Enter the user id to whom you would like to transfer the website. It can be found in the user account menu tab.'\n        )\n        if (\n            !userTo ||\n            !window.confirm(\n                'Are you sure you want to transfer this website to user - ' +\n                    userTo +\n                    '?'\n            )\n        )\n            return\n\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'transferWebsite',\n                _id: mD.currentWebsiteId,\n                userTo,\n            })\n        )\n    }\n}\n\nexport const saveDomainName = (name, type) => (dispatch, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (mD.currentWebsiteObject) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'saveDomainName',\n                _id: mD.currentWebsiteId,\n                name,\n                type,\n            })\n        )\n    }\n}\n","import { webSocket } from '../components/ReserveWebsite/ReserveWebsite'\n\nexport const deleteImage = (url: string) => (dispatch: Object, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    if (\n        window.confirm(\n            'Are you sure you want to delete this image? The image will be unavailable after the deletion and will not be visible in all elements and on all pages of your websites.'\n        )\n    ) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'deleteImage',\n                url,\n                _id: mD.currentWebsiteId,\n            })\n        )\n    }\n}\n\nexport const renameImage = (url: string) => (dispatch: Object, getState) => {\n    if (sessionStorage.getItem('tryWebsiter'))\n        return alert(\n            'This function is not available in test mode. Please create your free account at https://my.websiter.dev/login'\n        )\n    const { mD } = getState()\n    const label = window.prompt('Type a new name for the image.')\n    if (label !== null) {\n        webSocket.send(\n            JSON.stringify({\n                messageCode: 'renameImage',\n                url,\n                _id: mD.currentWebsiteId,\n                label,\n            })\n        )\n    }\n}\n","export { sendUpdate } from './sendUpdate'\n\nexport {\n    addResource,\n    deleteResource,\n    publishResource,\n    revertResource,\n} from './resources'\n\nexport {\n    addWebsite,\n    deleteWebsite,\n    changeWebsiteProperty,\n    verifyCustomDomain,\n    sharingRightsChange,\n    addUserInWebsiteSharing,\n    deleteUserInWebsiteSharing,\n    transferWebsite,\n    saveDomainName,\n} from './websites'\n\nexport { renameImage, deleteImage } from './images'\n","import React from 'react'\n//import { connect } from 'react-redux';\nimport type { Node } from 'react'\n\n//import * as actions from '../../../store/actions/index';\nimport classes from './Checkbox.module.css'\n//import SmallButton from '../Buttons/SmallButton/SmallButton';\n\ntype Props = {\n    checked?: boolean,\n    title?: string,\n    onChange: Function,\n    datatestid?: string,\n    radio?: boolean,\n    children?: Node,\n    inline?: boolean,\n}\n\nconst Checkbox = (props: Props) => {\n    return (\n        <div\n            className={\n                props.inline\n                    ? [classes.Div, classes.Inline].join(' ')\n                    : classes.Div\n            }\n        >\n            <label>\n                <input\n                    data-testid={props.datatestid}\n                    type={props.radio ? 'radio' : 'checkbox'}\n                    className={classes.Input}\n                    checked={props.checked || false}\n                    onChange={e => props.onChange(e.target.checked)}\n                />\n                {props.title}\n                {props.children}\n            </label>\n        </div>\n    )\n}\n\nexport default Checkbox\n","import throttle from 'lodash.throttle'\n\nexport const CANCEL = 'redux-throttle/CANCEL'\nexport const FLUSH = 'redux-throttle/FLUSH'\n\nfunction map(throttled, action, method) {\n    if (action.payload && action.payload.type) {\n        let types = action.payload.type\n        if (!Array.isArray(types)) {\n            types = [types]\n        }\n        Object.keys(throttled)\n            .filter(t => types.includes(t))\n            .forEach(t => throttled[t][method]())\n        return\n    }\n    Object.keys(throttled).forEach(t => throttled[t][method]())\n    return\n}\n\nexport default function middleware(\n    defaultWait = 300,\n    defaultThrottleOption = {}\n) {\n    const throttled = {}\n    return store => next => action => {\n        if (action.type === CANCEL) {\n            map(throttled, action, 'cancel')\n            return next(action)\n        }\n\n        if (action.type === FLUSH) {\n            map(throttled, action, 'flush')\n            return next(action)\n        }\n\n        const shouldThrottle = (action.meta || {}).throttle\n\n        if (!shouldThrottle) {\n            return next(action)\n        }\n\n        if (throttled[action.type]) {\n            return throttled[action.type](action)\n        }\n\n        let wait = defaultWait\n        let options = defaultThrottleOption\n\n        if (!isNaN(shouldThrottle) && shouldThrottle !== true) {\n            wait = shouldThrottle\n        } else if (typeof shouldThrottle === 'object') {\n            wait = shouldThrottle.wait || defaultWait\n            options = { ...defaultThrottleOption, ...shouldThrottle }\n        }\n\n        throttled[action.type] = throttle(next, wait, options)\n\n        return throttled[action.type](action)\n    }\n}\n","import React, { Component } from 'react'\nimport { Redirect } from 'react-router-dom'\nimport { connect } from 'react-redux'\n\nimport * as actions from '../../../store/actions/index'\n\ntype Props = {\n    onLogout: () => {},\n}\n\nclass Logout extends Component<Props> {\n    componentDidMount() {\n        this.props.onLogout()\n    }\n\n    render() {\n        return <Redirect to=\"/login\" />\n    }\n}\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        onLogout: () => dispatch(actions.logout()),\n    }\n}\n\nexport default connect(\n    null,\n    mapDispatchToProps\n)(Logout)\n","import React, { Component } from 'react'\n\ntype Props = {}\n\ntype State = {\n    component: Object | null,\n}\n\nconst asyncComponent = (importComponent: Object) => {\n    return class extends Component<Props, State> {\n        state = {\n            component: null,\n        }\n\n        componentDidMount() {\n            importComponent().then(cmp => {\n                this.setState({ component: cmp.default })\n            })\n        }\n\n        render() {\n            const C = this.state.component\n            return C ? <C {...this.props} /> : <div>Loading...</div>\n        }\n    }\n}\n\nexport default asyncComponent\n","import React from 'react'\nimport type { Node } from 'react'\nimport classes from './LoginButton.module.css'\n\ntype Props = {\n    clicked?: Function,\n    disabled?: boolean,\n    btnType?: 'Success' | 'Danger',\n    children?: Node,\n    datatestid?: string,\n}\n\nconst LoginButton = (props: Props) => (\n    <button\n        data-testid={props.datatestid || 'LoginButton'}\n        disabled={props.disabled}\n        className={[classes.Button, classes[props.btnType]].join(' ')}\n        onClick={props.clicked}\n    >\n        {props.children}\n    </button>\n)\n\nexport default LoginButton\n","import React, { useState, useEffect } from 'react'\n\nimport Checkbox from '../../components/UI/Checkbox/Checkbox'\nimport Cookies from 'universal-cookie'\nimport LoginButton from '../../components/UI/LoginButton/LoginButton'\nimport classes from './Auth.module.css'\nimport Svg from '../../components/Svg/Svg'\n\nconst cookies = new Cookies()\n\ntype Props = {\n    test?: boolean,\n}\n\nconst Auth = (props: Props) => {\n    const [state: boolean, setState] = useState(false)\n    const [cookieConsent: boolean, setCookieConsent] = useState(false)\n\n    useEffect(() => {\n        checkCookieConsent()\n    })\n\n    let remeberMeParam = '?rememberme=false'\n    if (state) {\n        remeberMeParam = '?rememberme=true'\n    }\n\n    const checkCookieConsent = () => {\n        const cookiesConsent = cookies.get('cookies_consent')\n        if (cookiesConsent) {\n            setCookieConsent(true)\n        }\n    }\n\n    const agreeWithCookies = () => {\n        cookies.set('cookies_consent', 'true', {\n            path: '/',\n            maxAge: 31530000,\n        })\n        checkCookieConsent()\n    }\n    const basicURL =\n        process.env.NODE_ENV !== 'development'\n            ? 'https://my.websiter.dev/api/auth/'\n            : 'http://my.websiter.dev:5000/api/auth/'\n    return (\n        <div className={classes.Container}>\n            {!cookieConsent ? (\n                <>\n                    <div>\n                        We use cookies only for login purposes. In order to\n                        proceed you need to agree with the use of cookies.\n                    </div>\n                    <LoginButton btnType=\"Success\" clicked={agreeWithCookies}>\n                        AGREE\n                    </LoginButton>\n                    <LoginButton\n                        btnType=\"Danger\"\n                        clicked={() => {\n                            window.open('https://websiter.dev', '_self')\n                        }}\n                    >\n                        Return to the homepage\n                    </LoginButton>\n                </>\n            ) : (\n                <>\n                    <h1>Continue with:</h1>\n                    <div className={classes.socialButtons}>\n                        <a href={basicURL + `google/start${remeberMeParam}`}>\n                            <Svg icon='<svg width=\"50\" height=\"50\" viewBox=\"0 0 24 24\"><path fill=\"#4285F4\" d=\"M12.24 10.285V14.4h6.806c-.275 1.765-2.056 5.174-6.806 5.174-4.095 0-7.439-3.389-7.439-7.574s3.345-7.574 7.439-7.574c2.33 0 3.891.989 4.785 1.849l3.254-3.138C18.189 1.186 15.479 0 12.24 0c-6.635 0-12 5.365-12 12s5.365 12 12 12c6.926 0 11.52-4.869 11.52-11.726 0-.788-.085-1.39-.189-1.989H12.24z\"></path></svg>' />\n                            <div>GOOGLE</div>\n                        </a>\n                        <a href={basicURL + `facebook/start${remeberMeParam}`}>\n                            <Svg icon='<svg width=\"50\" height=\"50\" viewBox=\"0 0 24 24\"><path fill=\"#1877F2\" d=\"M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z\"></path></svg>' />\n                            <div>FACEBOOK</div>\n                        </a>\n                        <a href={basicURL + `twitter/start${remeberMeParam}`}>\n                            <Svg icon='<svg width=\"50\" height=\"50\" viewBox=\"0 0 24 24\"><path fill=\"#1DA1F2\" d=\"M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z\"></path></svg>' />\n                            <div>TWITTER</div>\n                        </a>\n                    </div>\n                    <Checkbox\n                        title=\"Remember me\"\n                        checked={state}\n                        onChange={() => setState(!state)}\n                    />\n                </>\n            )}\n        </div>\n    )\n}\nexport default Auth\n","import React from 'react'\nimport classes from './Spinner.module.css'\n\ntype Props = {\n    cover?: boolean,\n    datatestid?: string,\n}\n\nconst spinner = (props: Props) => (\n    <>\n        {props.cover ? (\n            <div\n                className={classes.Cover}\n                data-testid={props.datatestid || 'cover'}\n            >\n                <div className={classes.Loader}>Loading...</div>\n            </div>\n        ) : (\n            <div className={classes.Loader}>Loading...</div>\n        )}\n    </>\n)\n\nexport default spinner\n","import isEqual from 'lodash/isEqual'\nimport omit from 'lodash/omit'\n\nexport default (draft1, draft2) =>\n    isEqual(\n        {\n            structure: draft1.structure.map(item =>\n                omit(item, ['expanded', 'children', 'itemPath', 'itemIndex'])\n            ),\n            values: draft1.values,\n        },\n        {\n            structure: draft2.structure.map(item =>\n                omit(item, ['expanded', 'children', 'itemPath', 'itemIndex'])\n            ),\n            values: draft2.values,\n        }\n    )\n","import {\n    structure,\n    current,\n    resourceObjectIndex,\n} from '../../utils/resourceTypeIndex'\nimport cloneDeep from 'lodash/cloneDeep'\nimport isEqual from 'lodash/isEqual'\nimport { checkIfCapital } from '../../utils/basic'\nimport resourcesAreEqual from '../../utils/resourcesAreEqual'\n\n// $FlowFixMe\nconst diffpatcher = require('jsondiffpatch/dist/jsondiffpatch.umd.js').create({\n    objectHash: obj => obj.id,\n    propertyFilter: (name, context) => name !== '__patch__',\n})\n\nconst patchStructure = (state: Object, action: Object) => {\n    return diffpatcher.patch(\n        state[structure[action.resourceType]],\n        action.structurePatch\n    )\n}\n\nexport const addResourceSuccess = (state: Object, action: Object) => {\n    state[structure[action.resourceType]] = patchStructure(state, action)\n    state.resourcesObjects[action._id] = action.resource\n}\n\nexport const deleteResourceSuccess = (state: Object, action: Object) => {\n    action.deletedResources.forEach(id => delete state.resourcesObjects[id])\n    state[structure[action.resourceType]] = patchStructure(state, action)\n    state[current[action.resourceType]] = action.current || ''\n}\n\nexport const setCurrentResource = (state: Object, action: Object) => {\n    state.resourcesObjects[action.mD.currentWebsiteId][\n        current[action.resourceType]\n    ] = action._id\n    if (action.resourceType === 'page') {\n        state.hoveredElementSize = {}\n    }\n}\n\nexport const saveResourcesStructureSuccess = (\n    state: Object,\n    action: Object\n) => {\n    state[structure[action.resourceType]] = action.structure\n}\n\nexport const removeResourceFromUnsaved = (state: Object, action: Object) => {\n    state.notSavedResources = state.notSavedResources.filter(\n        item => item !== action._id\n    )\n}\n\nexport const addResourceToUnsaved = (state: Object, action: Object) => {\n    if (!state.notSavedResources.includes(action._id))\n        state.notSavedResources.push(action._id)\n}\n\nexport const removeResourceFromNewVersions = (\n    state: Object,\n    action: Object\n) => {\n    state.newVersionResources = state.newVersionResources.filter(\n        item => item !== action._id\n    )\n}\n\nexport const addResourceToNewVersions = (state: Object, action: Object) => {\n    if (!state.newVersionResources.includes(action._id))\n        state.newVersionResources.push(action._id)\n}\n\nexport const savePageInState = (state: Object, action: Object) => ({\n    ...state,\n    resourcesObjects: {\n        ...state.resourcesObjects,\n        [state.currentPage]: {\n            ...state.resourcesObjects[state.currentPage],\n            content: action.value,\n        },\n    },\n})\n\nexport const saveResourceDraftInState = (state: Object, action: Object) => {\n    state.resourcesObjects[action.currentResource].draft = action.draft\n}\n\nexport const saveResourceInState = (state: Object, action: Object) => {\n    state.resourcesObjects[action.currentResource].draft = action.draft\n    state.resourcesObjects[action.currentResource].present = action.draft\n    state.notSavedResources = state.notSavedResources.filter(\n        item => item !== action.currentResource\n    )\n}\n\nexport const addResourceVersion = (state: Object, action: Object) => {\n    const resource = cloneDeep(\n        action.mD[resourceObjectIndex[action.resourceType]]\n    )\n    if (!isEqual(resource.present, action.draft)) {\n        if (action.isNotForHistory) {\n            resource.present = action.draft\n            state.resourcesObjects[resource._id] = resource\n        } else {\n            const newDraft = { ...action.draft }\n            if (\n                action.draft.structure &&\n                ['template', 'plugin'].includes(action.resourceType)\n            ) {\n                const connectedResources = []\n                action.draft.structure.forEach(item => {\n                    if (item.tag.length > 0 && item.path.length > 0) {\n                        if (\n                            checkIfCapital(item.tag.charAt(0)) &&\n                            !item.childrenTo &&\n                            !item.isChildren &&\n                            !item.isElementFromCMSVariable\n                        ) {\n                            connectedResources.push({\n                                name: item.tag,\n                                type: 'plugin',\n                            })\n                        }\n                    }\n                })\n                newDraft.connectedResources = connectedResources\n\n                // let resource =\n                //     state.resourcesObjects[\n                //         state.resourcesObjects[state.userId].loadedWebsite\n                //     ].templatesStructure.find(\n                //         item => item.id === action.currentResource\n                //     ) ||\n                //     state.pluginsStructure.find(\n                //         item => item.id === action.currentResource\n                //     )\n                // if (resource) {\n                //     resource.connectedResources = connectedResources\n                // }\n            }\n            const currentResourceId = action.mD[current[action.resourceType]]\n            if (\n                !resourcesAreEqual(\n                    resource.present.structure\n                        ? resource.present\n                        : resource.draft,\n                    newDraft\n                )\n            ) {\n                if (!state.notSavedResources.includes(currentResourceId))\n                    state.notSavedResources.push(currentResourceId)\n            }\n            if (resource.past.length > 100) resource.past.shift()\n            resource.past.push(diffpatcher.diff(resource.present, newDraft))\n            resource.present = newDraft\n            resource.future = []\n            state.resourcesObjects[resource._id] = resource\n        }\n    }\n}\n\nexport const undoResourceVersion = (state: Object, action: Object) => {\n    const currentResource = state[current[state.currentTopTab]]\n    const resource = state.resourcesObjects[currentResource]\n    if (resource) {\n        if (resource.past.length > 0) {\n            if (\n                !isEqual(\n                    resource.present,\n                    resource.past[resource.past.length - 1]\n                )\n            ) {\n                if (!state.notSavedResources.includes(action.currentResource))\n                    state.notSavedResources.push(action.currentResource)\n            } else {\n                state.notSavedResources = state.notSavedResources.filter(\n                    item => item !== action.currentResource\n                )\n            }\n\n            const delta = resource.past.pop()\n            resource.future.unshift(delta)\n            resource.present = diffpatcher.unpatch(resource.present, delta)\n        }\n    }\n}\n\nexport const redoResourceVersion = (state: Object, action: Object) => {\n    const currentResource = state[current[state.currentTopTab]]\n    const resource = state.resourcesObjects[currentResource]\n    if (resource) {\n        if (resource.future.length > 0) {\n            if (!isEqual(resource.present, resource.future[0])) {\n                if (!state.notSavedResources.includes(action.currentResource))\n                    state.notSavedResources.push(action.currentResource)\n            } else {\n                state.notSavedResources = state.notSavedResources.filter(\n                    item => item !== action.currentResource\n                )\n            }\n\n            const delta = resource.future.shift()\n            resource.past.push(delta)\n            resource.present = diffpatcher.patch(resource.present, delta)\n        }\n    }\n}\n","import * as auth from './auth'\nimport * as images from './images'\nimport * as resources from './resources'\nimport { createReducer } from '@reduxjs/toolkit'\nimport resourcesAreEqual from '../../utils/resourcesAreEqual'\n\nexport type menuItemType = {\n    all: boolean,\n    id: string,\n    generatedFrom: string,\n    sourceItem: boolean,\n    name: string,\n    type: string,\n    path: Array<string>,\n    properties: {\n        url: string,\n        class: string,\n    },\n}\n\nexport type requiredRightsType = Array<string>\n\nexport type elementType = {\n    id: string,\n    path: Array<string>,\n    tag: string,\n    properties: {\n        name?: string,\n        topMenuBlockClasses?: Array<string>,\n        topMenuItemClasses?: Array<string>,\n        topMenuItemActiveClasses?: Array<string>,\n        popupMenuBlockClasses?: Array<string>,\n        popupMenuItemClasses?: Array<string>,\n        popupMenuItemActiveClasses?: Array<string>,\n        mode?: 'horizontal' | 'vertical',\n        trigger?: 'click',\n        id?: string,\n        class?: string,\n    },\n    propertiesString: string,\n    style?: string,\n    expanded?: boolean,\n    textMode: string,\n    cursorPosition?: {\n        row: number,\n        column: number,\n    },\n    text?: boolean,\n    textContent?: string,\n    isChildren?: boolean,\n    childrenTo?: string,\n    forPlugin?: string,\n    sourcePlugin?: string,\n    menuItems?: Array<menuItemType>,\n    currentMenuItem?: string,\n    children?: Array<elementType>,\n    isElementFromCMSVariable?: boolean,\n    isCMSVariable?: boolean,\n    CMSVariableType?: string,\n    CMSVariableSystemName?: string,\n    CMSVariableDescription?: string,\n    CMSVariableDefaultValue?: any,\n    currentMenuId?: string,\n    defaultMenuItems?: Array<menuItemType>,\n    value?: any,\n}\nexport type resourceType = {\n    currentId: number,\n    structure: Array<elementType>,\n    currentBox?: string,\n    cursorPosition?: {\n        row: number,\n        column: number,\n    },\n    value?: string,\n}\n\nexport type pageType = {\n    id: string,\n    path: Array<string>,\n    name: string,\n    url: string,\n    template: string,\n    homepage: boolean,\n    hidden: boolean,\n    notPublished: boolean,\n    connectedResources: {\n        name: string,\n        type: string,\n    },\n}\n\nexport type pluginType = {\n    id: string,\n    path: Array<string>,\n    name: string,\n    url: string,\n    template: string,\n    homepage: boolean,\n    notPublished: boolean,\n    hidden: boolean,\n    connectedResources: {\n        name: string,\n        type: string,\n    },\n}\n\nexport type templateType = {\n    id: string,\n    path: Array<string>,\n    name: string,\n    url: string,\n    template: string,\n    homepage: boolean,\n    notPublished: boolean,\n    hidden: boolean,\n    connectedResources: {\n        name: string,\n        type: string,\n    },\n}\n\nexport type imageType = {\n    name: string,\n    label: string,\n    url: string,\n    size: number,\n}\nexport type websiteType = {\n    _id: string,\n    domain: string,\n    name: string,\n    customDomain?: string,\n    domainHidden?: boolean,\n    customDomainHidden?: boolean,\n    customDomainVerified?: boolean,\n    verifyCode?: string,\n    cname?: string,\n    domainNoIndex?: boolean,\n    sharing: Array<{\n        userId: string,\n        rights: Array<string>,\n    }>,\n    user: string,\n    storage: number,\n    images: Array<imageType>,\n}\n\nexport type initialStateType = {\n    websites: Array<websiteType>,\n    resourcesObjects: {\n        [key: string]: {\n            draft: resourceType,\n            present: resourceType,\n            future: Array<resourceType>,\n            past: Array<resourceType>,\n        },\n    },\n    pagesStructure: Array<pageType>,\n    pluginsStructure: Array<pluginType>,\n    templatesStructure: Array<templateType>,\n    loadedWebsite: string,\n    error: null | {},\n    loading: boolean,\n    currentPage: string,\n    currentPlugin: string,\n    currentTemplate: string,\n    domainNotOk: boolean,\n    customDomainNotOk: boolean,\n    maxStorage: number,\n    uploadingImage: boolean,\n    currentBoxInPlugin: string,\n    currentImage: string,\n    sizeIsChanging: boolean,\n    currentWebsite: string,\n    notSavedResources: Array<string>,\n    pageZoom: number,\n    hoveredElementId: null | string,\n    hoveredElementSize: {\n        [key: string]: {\n            children: {},\n            left: number,\n            top: number,\n            width: number,\n            height: number,\n        },\n    },\n    isRefreshing: boolean,\n    userId: null | string,\n    barSizes: { height: number, width: number, width2: number, width3: number },\n    currentTopTab: string,\n    findMode: null | string,\n    hoverMode: string,\n    fromFrame: boolean,\n    search: {},\n    tryWebsiter: boolean,\n    currentUserInWebsiteSharing: string,\n    currentSiteBuilderMode: 'template' | 'page' | '',\n    accountInfo: {\n        displayName?: string,\n        emails?: Array<string>,\n        photos?: Array<string>,\n    },\n}\n\nexport const initialState: initialStateType = {\n    resourcesObjects: {},\n    error: null,\n    loading: false,\n    domainNotOk: false,\n    customDomainNotOk: false,\n    maxStorage: 0,\n    uploadingImage: false,\n    currentBoxInPlugin: '',\n    currentImage: '',\n    sizeIsChanging: false,\n    notSavedResources: [],\n    newVersionResources: [],\n    pageZoom: 100,\n    hoveredElementId: null,\n    hoveredElementSize: {},\n    isRefreshing: false,\n    userId: null,\n    barSizes: {\n        height: 200,\n        width: 400,\n        width2: 200,\n        width3: 200,\n    },\n    currentTopTab: 'page',\n    findMode: null,\n    hoverMode: '',\n    fromFrame: false,\n    search: {},\n    shouldRefresh: false,\n    tryWebsiter: false,\n    currentUserInWebsiteSharing: '',\n    // currentSiteBuilderMode: '',\n    mD: {},\n}\n\nconst saveHoveredElementRect = (state, action) => {\n    const checkAndCreatePath = (path, index, parent) => {\n        if (index < path.length - 1) {\n            if (!parent[path[index].id]) {\n                parent[path[index].id] = {\n                    plugin: path[index].plugin,\n                    children: {},\n                }\n            }\n            checkAndCreatePath(\n                action.path,\n                index + 1,\n                parent[path[index].id].children\n            )\n        } else {\n            parent[path[index].id] = {\n                plugin: path[index].plugin,\n                children: {},\n                ...action.size,\n            }\n        }\n    }\n    if (action.path.length > 0)\n        checkAndCreatePath(action.path, 0, state.hoveredElementSize)\n}\n\nconst removeFromHoveredSizes = (state, action) => {\n    // ,\n    // removedElements,\n    const checkAndRemoveElement = parent => {\n        for (const item in parent) {\n            if (parent[item].plugin === action.currentResource) {\n                for (const child in parent[item].children) {\n                    if (action.removedElements.includes(child))\n                        delete parent[item].children[child]\n                }\n            } else {\n                checkAndRemoveElement(parent.children)\n            }\n        }\n    }\n    checkAndRemoveElement(state.hoveredElementSize)\n}\n\nconst toggleFindMode = (state, action) => {\n    if (action.value) {\n        if (state.findMode === action.value) {\n            state.findMode = null\n        } else {\n            state.findMode = action.value\n        }\n    } else {\n        state.findMode = null\n    }\n}\n\nconst reducer = createReducer(initialState, {\n    REMOVE_RESOURCE_FROM_UNSAVED: (state, action) =>\n        resources.removeResourceFromUnsaved(state, action),\n    ACTION_START_IMAGE_UPLOAD: (state, action) =>\n        images.actionStartImageUpload(state),\n    ACTION_FAIL_IMAGE_UPLOAD: (state, action) =>\n        images.actionFailImageUpload(state, action),\n    ACTION_SUCCESS_IMAGE_UPLOAD: (state, action) =>\n        images.actionSuccessImageUpload(state),\n    CHOOSE_IMAGE: (state, action) => images.chooseImage(state, action),\n\n    SIZE_IS_CHANGING: (state, action) => {\n        state.sizeIsChanging = action.isChanging\n    },\n    ACTION_START: (state, action) => {\n        state.error = null\n        state.pagesLoading = true\n    },\n    ACTION_FAIL: (state, action) => {\n        state.error = action.error\n        state.pagesLoading = false\n    },\n    ACTION_SUCCESS: (state, action) => {\n        state.error = null\n        state.pagesLoading = false\n    },\n\n    ADD_RESOURCE_VERSION: (state, action) =>\n        resources.addResourceVersion(state, action),\n    UNDO_RESOURCE_VERSION: (state, action) =>\n        resources.undoResourceVersion(state, action),\n    REDO_RESOURCE_VERSION: (state, action) =>\n        resources.redoResourceVersion(state, action),\n\n    AUTH_START: (state, action) => auth.authStart(state),\n    AUTH_SUCCESS: (state, action) => auth.authSuccess(state, action),\n    AUTH_FAIL: (state, action) => auth.authFail(state, action),\n    AUTH_LOGOUT: (state, action) => auth.authLogout(state),\n    CHANGE_BAR_SIZE: (state, action) => auth.changeBarSize(state, action),\n    SET_CURRENT_TOP_TAB: (state, action) => {\n        state.currentTopTab = action.currentTopTab\n    },\n\n    SAVE_HOVERED_ELEMENT_RECT: (state: Object, action: Object) =>\n        saveHoveredElementRect(state, action),\n    REMOVE_FROM_HOVERED_SIZES: (state: Object, action: Object) =>\n        removeFromHoveredSizes(state, action),\n    HOVER_ELEMENT: (state: Object, action: Object) => {\n        state.hoveredElementId = action.id\n        state.hoverMode = action.mode\n        state.fromFrame = action.fromFrame\n    },\n    UNHOVER_ELEMENT: (state: Object, action: Object) => {\n        state.hoveredElementId = null\n        state.fromFrame = false\n    },\n    TOGGLE_FIND_MODE: (state: Object, action: Object) =>\n        toggleFindMode(state, action),\n    MARK_REFRESHING: (state: Object, action: Object) => {\n        state.isRefreshing = action.refreshing\n    },\n    MARK_SHOULD_REFRESHING: (state: Object, action: Object) => {\n        state.shouldRefresh = action.value\n    },\n    CHOOSE_USER_IN_WEBSITE_SHARING: (state: Object, action: Object) => {\n        state.currentUserInWebsiteSharing = action.id\n    },\n    SET_CURRENT_SITEBUILDER_MODE: (state: Object, action: Object) => {\n        state.currentSiteBuilderMode = action.mode\n    },\n    SAVE_MAIN_DATA: (state: Object, action: Object) => {\n        state.mD = action.mD\n    },\n    //ws\n    ADD_RESOURCE: (state: Object, action: Object) => {\n        const { mD } = state\n        if (action.data) {\n            if (action.data._id) {\n                if (mD.resourcesObjects[action.data._id]) {\n                    if (mD.resourcesObjects[action.data._id].draft) {\n                        state.resourcesObjects[action.data._id] = {\n                            ...mD.resourcesObjects[action.data._id],\n                            draft: action.data.draft,\n                            __v: action.data.__v,\n                        }\n                        let saved\n                        if (\n                            !mD.resourcesObjects[action.data._id].present\n                                .structure\n                        )\n                            saved = true\n                        else\n                            saved = resourcesAreEqual(\n                                action.data.draft,\n                                mD.resourcesObjects[action.data._id].present\n                            )\n\n                        if (saved) {\n                            resources.removeResourceFromUnsaved(state, {\n                                _id: action.data._id,\n                            })\n                            resources.removeResourceFromNewVersions(state, {\n                                _id: action.data._id,\n                            })\n                        } else {\n                            resources.addResourceToUnsaved(state, {\n                                _id: action.data._id,\n                            })\n                            resources.addResourceToNewVersions(state, {\n                                _id: action.data._id,\n                            })\n                        }\n                    } else {\n                        state.resourcesObjects[action.data._id] = {\n                            ...state.resourcesObjects[action.data._id],\n                            ...action.data,\n                        }\n                    }\n                } else state.resourcesObjects[action.data._id] = action.data\n                if (action.data._id.toString() === mD.userId.toString()) {\n                    if (action.data.settings)\n                        if (action.data.settings.barSizes)\n                            state.barSizes = action.data.settings.barSizes\n                }\n            }\n        }\n    },\n\n    DELETE_RESOURCE: (state: Object, action: Object) => {\n        if (action.data) {\n            delete state.resourcesObjects[action.data.resourceId]\n        }\n    },\n    REVERT_RESOURCE: (state: Object, action: Object) => {\n        if (action.data) {\n            state.resourcesObjects[action.data._id].present = action.data.draft\n            if (action.data.to === 'draft') {\n                resources.removeResourceFromUnsaved(state, {\n                    _id: action.data._id,\n                })\n                resources.removeResourceFromNewVersions(state, {\n                    _id: action.data._id,\n                })\n            }\n        }\n    },\n    SAVE_OBJECT: (state: Object, action: Object) => {\n        if (action.data) {\n            state.resourcesObjects[action.data._id] = action.data\n        }\n    },\n})\n\nexport default reducer\n","import { initialState } from './reducer'\n\nexport const actionStartImageUpload = (state: Object) => ({\n    ...state,\n    error: null,\n    loading: true,\n})\n\nexport const actionSuccessImageUpload = (state: Object) => ({\n    ...state,\n    error: null,\n    loading: false,\n})\n\nexport const actionFailImageUpload = (state: Object, action: Object) => ({\n    ...state,\n    error: action.error,\n    loading: false,\n})\n\nexport const chooseImage = (state: Object = initialState, action: Object) => {\n    state.currentImage = action.image\n}\n","export const authStart = (state: Object) => {\n    state.loading = true\n    state.error = null\n}\n\nexport const authFail = (state: Object, action: Object) => {\n    state.loading = false\n    state.error = action.error\n    state.userId = null\n}\n\nexport const authLogout = (state: Object) => {\n    state.userId = null\n}\n\nexport const authSuccess = (state: Object, action: Object) => {\n    state.userId = action.data._id\n    state.accountInfo = action.data.accountInfo\n    state.error = null\n    state.loading = false\n    state.barSizes = { ...state.barSizes, ...action.data.barSizes }\n    state.tryWebsiter = action.data.tryWebsiter\n}\n\nexport const changeBarSize = (state: Object, action: Object) => {\n    state.barSizes[action.key] = action.value\n}\n","import React, { Component } from 'react'\nimport { Route, Switch, withRouter, Redirect } from 'react-router-dom'\nimport { connect } from 'react-redux'\n\nimport Logout from './containers/Auth/Logout/Logout'\nimport asyncComponent from './hoc/asyncComponent'\nimport * as actions from './store/actions/index'\nimport Auth from './containers/Auth/Auth'\nimport Spinner from './components/UI/Spinner/Spinner'\n\nimport { initialState } from './store/reducer/reducer'\n\nconst asyncSiteBuilderLayout = asyncComponent(() => {\n    return import('./components/SiteBuilderLayout/SiteBuilderLayout')\n})\n\ntype Props = {\n    onTryAutoSignup: Function,\n    isAuthenticated: boolean,\n    loading: typeof initialState.loading,\n}\n\nclass App extends Component<Props> {\n    componentDidMount() {\n        this.props.onTryAutoSignup()\n    }\n\n    render() {\n        let routes = (\n            <Switch>\n                <Route path=\"/login\" component={Auth} />\n                <Redirect to=\"/login\" />\n            </Switch>\n        )\n        if (this.props.isAuthenticated) {\n            routes = (\n                <div style={{ height: '100%' }}>\n                    <Switch>\n                        <Route\n                            path=\"/editor\"\n                            component={asyncSiteBuilderLayout}\n                        />\n                        <Route path=\"/logout\" component={Logout} />\n                        <Redirect to=\"/editor\" />\n                    </Switch>\n                </div>\n            )\n        }\n        return (\n            <>\n                {routes} {this.props.loading ? <Spinner cover /> : null}\n            </>\n        )\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n        isAuthenticated: state.userId !== null,\n        loading: state.loading,\n    }\n}\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        onTryAutoSignup: () => dispatch(actions.authCheckState()),\n    }\n}\n\nexport default withRouter(\n    connect(\n        mapStateToProps,\n        mapDispatchToProps\n    )(App)\n)\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { BrowserRouter } from 'react-router-dom'\nimport { Provider } from 'react-redux'\nimport { createStore, applyMiddleware } from 'redux'\nimport thunk from 'redux-thunk'\nimport axios from 'axios'\nimport throttle from './store/middleware/throttle'\n\nimport './index.css'\nimport App from './App'\n//import * as serviceWorker from './serviceWorker';\nimport reducer from './store/reducer/reducer'\n// $FlowFixMe\nimport 'react-sortable-tree/style.css'\n\n// const composeEnhancers =\n//     process.env.NODE_ENV === 'development'\n//         ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\n//         : null || compose\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\n\nif (process.env.NODE_ENV === 'development') {\n    axios.defaults.baseURL = 'http://api.websiter.dev:5000'\n} else {\n    axios.defaults.baseURL = 'https://api.websiter.dev'\n}\n\nconst defaultWait = 300\nconst defaultThrottleOption = {\n    leading: true,\n    trailing: true,\n}\n\nconst throttleMiddleware = throttle(defaultWait, defaultThrottleOption)\n\nexport const store = createStore(\n    reducer,\n    composeEnhancers\n        ? composeEnhancers(applyMiddleware(throttleMiddleware, thunk))\n        : applyMiddleware(throttleMiddleware, thunk)\n)\n\nconst app = (\n    <Provider store={store}>\n        <BrowserRouter>\n            <App />\n        </BrowserRouter>\n    </Provider>\n)\nconst inIframe = window.self !== window.top\n\nconst root = document.getElementById('root')\nif (root !== null && !inIframe) {\n    ReactDOM.render(app, root)\n}\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\n//serviceWorker.unregister();\n","const addConnectedResources = (\n    draft,\n    id,\n    newRequestedResourcesList,\n    currentWebsiteObject,\n    resourcesObjects\n) => {\n    if (!resourcesObjects[id])\n        newRequestedResourcesList.push({\n            id,\n            type: 'resource',\n        })\n    if (draft)\n        if (draft.connectedResources)\n            draft.connectedResources.forEach(connectedResource => {\n                let nextResourceItem\n                if (connectedResource.type === 'plugin') {\n                    nextResourceItem = currentWebsiteObject.pluginsStructure.find(\n                        item => item.name === connectedResource.name\n                    )\n                }\n                if (nextResourceItem) {\n                    const nextResourceObject =\n                        resourcesObjects[nextResourceItem.id]\n                    let nextResourceDraft = {}\n                    if (nextResourceObject) {\n                        nextResourceDraft = nextResourceObject.present.structure\n                            ? nextResourceObject.present\n                            : nextResourceObject.draft\n                    }\n                    addConnectedResources(\n                        nextResourceDraft,\n                        nextResourceItem.id,\n                        newRequestedResourcesList,\n                        currentWebsiteObject,\n                        resourcesObjects\n                    )\n                }\n            })\n}\n\nexport default props => {\n    const { mD } = props\n    let newRequestedResourcesList = []\n    if (mD.userId && mD.resourcesObjects) {\n        if (!mD.userObject) {\n            newRequestedResourcesList.push({\n                id: mD.userId,\n                type: 'user',\n            })\n        } else {\n            let currentWebsiteId = mD.currentWebsiteId\n            for (let item of mD.websites) {\n                newRequestedResourcesList.push({\n                    id: item.id,\n                    type: 'website',\n                })\n            }\n            if (!currentWebsiteId) {\n                if (mD.websites.length > 0) currentWebsiteId = mD.websites[0].id\n                if (currentWebsiteId) {\n                    props.chooseWebsite(currentWebsiteId)\n                }\n            } else {\n                if (mD.currentPageId) {\n                    // if (!mD.currentPageObject) {\n                    //     newRequestedResourcesList.push({\n                    //         id: mD.currentPageId,\n                    //         type: 'resource',\n                    //     })\n                    // }\n\n                    addConnectedResources(\n                        mD.currentPageDraft,\n                        mD.currentPageId,\n                        newRequestedResourcesList,\n                        mD.currentWebsiteObject,\n                        mD.resourcesObjects\n                    )\n                    if (mD.pageTemplateId) {\n                        addConnectedResources(\n                            mD.pageTemplateDraft,\n                            mD.pageTemplateId,\n                            newRequestedResourcesList,\n                            mD.currentWebsiteObject,\n                            mD.resourcesObjects\n                        )\n                    }\n                }\n                if (mD.currentTemplateId) {\n                    addConnectedResources(\n                        mD.currentTemplateDraft,\n                        mD.currentTemplateId,\n                        newRequestedResourcesList,\n                        mD.currentWebsiteObject,\n                        mD.resourcesObjects\n                    )\n                }\n                if (mD.currentPluginId) {\n                    addConnectedResources(\n                        mD.currentPluginDraft,\n                        mD.currentPluginId,\n                        newRequestedResourcesList,\n                        mD.currentWebsiteObject,\n                        mD.resourcesObjects\n                    )\n                }\n            }\n        }\n    }\n    newRequestedResourcesList = Array.from(new Set(newRequestedResourcesList))\n    return newRequestedResourcesList\n}\n","import React from 'react'\n\nimport { connect } from 'react-redux'\nimport axios from 'axios'\n\nimport * as actions from '../../store/actions/index'\nimport { Component } from 'react'\nimport getListOfNeededResources from './methods/getListOfNeededResources'\nimport getEssentialData from '../../utils/getEssentialData'\n\ntype Props = {\n    loadedWebsite: string,\n}\n\ntype State = {\n    requestedResources: Array<{}>,\n    taskId: number,\n}\n\nexport let webSocket = false\n\nclass ReserveWebsiteInn extends Component<Props, State> {\n    state = {\n        requestedResources: [],\n        taskId: 0,\n    }\n\n    start = () => {\n        let url\n        if (process.env.NODE_ENV === 'development') {\n            url = 'ws://api.websiter.dev:5000'\n        } else {\n            url = 'wss://api.websiter.dev'\n        }\n        let pingTimeout, authInterval\n        webSocket = new WebSocket(url)\n\n        const heartbeat = () => {\n            clearTimeout(pingTimeout)\n            pingTimeout = setTimeout(() => {\n                webSocket.close()\n            }, 30000 + 1000)\n            const versions = {}\n            for (let id in this.props.mD.resourcesObjects) {\n                versions[id] = {\n                    __v: this.props.mD.resourcesObjects[id].__v,\n                    type: this.props.mD.resourcesObjects[id].draft\n                        ? 'resource'\n                        : this.props.mD.resourcesObjects[id].pagesStructure\n                        ? 'website'\n                        : 'user',\n                }\n            }\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'heartbeat',\n                    versions,\n                })\n            )\n        }\n\n        webSocket.onopen = event => {\n            webSocket.send(\n                JSON.stringify({\n                    messageCode: 'auth',\n                    user: axios.defaults.headers.common['x-auth-token'],\n                    tryWebsiter: sessionStorage.getItem('tryWebsiter'),\n                })\n            )\n            authInterval = setInterval(\n                () =>\n                    webSocket.send(\n                        JSON.stringify({\n                            messageCode: 'auth',\n                            noRequest: true,\n                            user: axios.defaults.headers.common['x-auth-token'],\n                            tryWebsiter: sessionStorage.getItem('tryWebsiter'),\n                        })\n                    ),\n                600000\n            )\n            heartbeat()\n        }\n        webSocket.onmessage = event => {\n            const data = JSON.parse(event.data)\n\n            switch (data.messageCode) {\n                case 'heartbeat':\n                    heartbeat()\n                    break\n                case 'logout':\n                    this.props.logout()\n                    break\n                case 'addResource':\n                    let resource = data.resource\n                    this.props.addResource(resource)\n                    break\n                case 'updateuser':\n                    this.props.updateUser(data, webSocket)\n                    break\n                case 'updatewebsite':\n                    this.props.updateWebsite(data, webSocket)\n                    break\n                case 'updateresource':\n                    this.props.updateResource(data, webSocket)\n                    break\n                case 'revertResource':\n                    this.props.revertResource(data)\n                    break\n                case 'deleteuser':\n                case 'deletewebsite':\n                case 'deleteresource':\n                    this.props.deleteResource(data)\n                    break\n                case 'confirmSaved':\n                    this.props.confirmSaved(data)\n                    break\n                case 'notFoundResource':\n                    this.markNotFoundResource(data)\n                    break\n                case 'error':\n                    alert(data.text)\n                    break\n                default:\n                    break\n            }\n        }\n        webSocket.onclose = event => {\n            clearTimeout(pingTimeout)\n            clearInterval(authInterval)\n        }\n    }\n\n    markNotFoundResource = data => {\n        const requestedResources = this.state.requestedResources.filter(\n            item => item.id.toString() === data._id.toString()\n        )\n        this.setState({ requestedResources })\n    }\n\n    checkInterval = null\n\n    check = () => {\n        if (!webSocket || webSocket.readyState === 3) {\n            this.start()\n        }\n    }\n    componentWillMount() {\n        this.checkInterval = setInterval(this.check, 5000)\n    }\n\n    reRequestResourcesInterval = null\n    reRequestResources = () => {\n        for (let requestedResource of this.state.requestedResources) {\n            if (requestedResource)\n                if (!this.props.mD.resourcesObjects[requestedResource.id]) {\n                    if (webSocket && webSocket.readyState !== 3) {\n                        webSocket.send(\n                            JSON.stringify({\n                                messageCode: 'requestResource',\n                                id: requestedResource.id,\n                                type: requestedResource.type,\n                            })\n                        )\n                    }\n                }\n        }\n    }\n    componentWillUnmount() {\n        clearInterval(this.reRequestResourcesInterval)\n        clearInterval(this.checkInterval)\n        if (webSocket) {\n            webSocket.close()\n        }\n    }\n\n    componentWillReceiveProps(nextProps) {\n        const newRequestedResourcesList = getListOfNeededResources(nextProps)\n        const requestedResources = []\n        for (const requestItem of newRequestedResourcesList) {\n            if (requestItem) {\n                let requestedResourceItem = this.state.requestedResources.find(\n                    item => item.id === requestItem.id\n                )\n                if (!requestedResourceItem) {\n                    if (webSocket && webSocket.readyState !== 3) {\n                        webSocket.send(\n                            JSON.stringify({\n                                messageCode: 'requestResource',\n                                id: requestItem.id,\n                                type: requestItem.type,\n                            })\n                        )\n                        requestedResourceItem = {\n                            id: requestItem.id,\n                            type: requestItem.type,\n                            state: 'sent',\n                        }\n                    }\n                }\n                if (requestedResourceItem)\n                    requestedResources.push(requestedResourceItem)\n            }\n        }\n        this.setState({ requestedResources })\n        clearInterval(this.reRequestResourcesInterval)\n        this.reRequestResourcesInterval = setInterval(\n            this.reRequestResources,\n            3000\n        )\n    }\n\n    render() {\n        return null\n    }\n}\n\nconst mapStateToPropsDo = state => {\n    return {\n        mD: state.mD,\n    }\n}\n\nconst mapDispatchToPropsDo = dispatch => {\n    return {\n        logout: () => dispatch(actions.logout()),\n        addResource: data => dispatch(actions.addResource(data)),\n        updateUser: (data, webSocket) =>\n            dispatch(actions.updateUser(data, webSocket)),\n        updateWebsite: (data, webSocket) =>\n            dispatch(actions.updateWebsite(data, webSocket)),\n        updateResource: (data, webSocket) =>\n            dispatch(actions.updateResource(data, webSocket)),\n        deleteResource: data => dispatch(actions.deleteResource(data)),\n        revertResource: data => dispatch(actions.revertResource(data)),\n        chooseWebsite: currentWebsiteId =>\n            dispatch(actions.chooseWebsite(currentWebsiteId)),\n        confirmSaved: data => dispatch(actions.removeResourceFromUnsaved(data)),\n    }\n}\n\nconst ReserveWebsiteDo = connect(\n    mapStateToPropsDo,\n    mapDispatchToPropsDo\n)(ReserveWebsiteInn)\n\nconst ReserveWebsite = props => {\n    const mainData = getEssentialData(\n        props.userId,\n        props.resourcesObjects,\n        props.tryWebsiter\n    )\n\n    props.saveMainData(mainData)\n    return <ReserveWebsiteDo />\n}\n\nconst mapStateToProps = state => {\n    return {\n        userId: state.userId,\n        resourcesObjects: state.resourcesObjects,\n        tryWebsiter: state.tryWebsiter,\n    }\n}\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        saveMainData: mD => dispatch(actions.saveMainData(mD)),\n    }\n}\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(ReserveWebsite)\n","export default (userId, resourcesObjects, tryWebsiter) => {\n    const userObject = resourcesObjects[userId]\n    let websites,\n        currentWebsiteItem,\n        currentWebsiteId,\n        currentWebsiteObject,\n        pagesStructure = [],\n        templatesStructure = [],\n        pluginsStructure = [],\n        currentPageId = '',\n        currentTemplateId = '',\n        currentPluginId = '',\n        currentPageItem,\n        currentTemplateItem,\n        currentPluginItem,\n        currentPageObject,\n        currentTemplateObject,\n        currentPluginObject,\n        currentPageDraft,\n        currentTemplateDraft,\n        currentPluginDraft,\n        pageTemplateName = '',\n        pageTemplateId = '',\n        pageTemplateItem,\n        pageTemplateObject,\n        pageTemplateDraft,\n        tooltipsOff\n    if (userObject) {\n        websites = userObject.websites\n        if (websites) {\n            if (websites.length > 0 && userObject.settings) {\n                tooltipsOff = userObject.settings.tooltipsOff\n                if (userObject.settings.currentWebsite) {\n                    currentWebsiteItem = websites.find(\n                        item => item.id === userObject.settings.currentWebsite\n                    )\n                }\n                if (currentWebsiteItem) {\n                    currentWebsiteId = currentWebsiteItem.id\n                    currentWebsiteObject = resourcesObjects[currentWebsiteId]\n                    if (currentWebsiteObject) {\n                        pagesStructure = currentWebsiteObject.pagesStructure\n                        templatesStructure =\n                            currentWebsiteObject.templatesStructure\n                        pluginsStructure = currentWebsiteObject.pluginsStructure\n\n                        const currentWebsiteItemSettings =\n                            userObject.settings.websites[currentWebsiteId]\n                        if (currentWebsiteItemSettings) {\n                            currentPageId =\n                                currentWebsiteItemSettings.currentPageId\n                            currentTemplateId =\n                                currentWebsiteItemSettings.currentTemplateId\n                            currentPluginId =\n                                currentWebsiteItemSettings.currentPluginId\n\n                            currentPageItem = pagesStructure.find(\n                                item => item.id === currentPageId\n                            )\n                            currentTemplateItem = templatesStructure.find(\n                                item => item.id === currentTemplateId\n                            )\n                            currentPluginItem = pluginsStructure.find(\n                                item => item.id === currentPluginId\n                            )\n                            if (currentPageItem) {\n                                currentPageObject =\n                                    resourcesObjects[currentPageId]\n                                if (currentPageObject) {\n                                    currentPageDraft = !currentPageObject\n                                        .present.structure\n                                        ? currentPageObject.draft\n                                        : currentPageObject.present\n                                }\n                                pageTemplateName =\n                                    currentPageItem.template || ''\n                                if (pageTemplateName) {\n                                    pageTemplateItem = templatesStructure.find(\n                                        item => item.name === pageTemplateName\n                                    )\n                                    if (pageTemplateItem) {\n                                        pageTemplateId = pageTemplateItem.id\n                                        pageTemplateObject =\n                                            resourcesObjects[pageTemplateId]\n                                        if (pageTemplateObject) {\n                                            pageTemplateDraft = !pageTemplateObject\n                                                .present.structure\n                                                ? pageTemplateObject.draft\n                                                : pageTemplateObject.present\n                                        }\n                                    }\n                                }\n                            }\n                            if (currentTemplateItem) {\n                                currentTemplateObject =\n                                    resourcesObjects[currentTemplateId]\n                                if (currentTemplateObject) {\n                                    currentTemplateDraft = !currentTemplateObject\n                                        .present.structure\n                                        ? currentTemplateObject.draft\n                                        : currentTemplateObject.present\n                                }\n                            }\n                            if (currentPluginItem) {\n                                currentPluginObject =\n                                    resourcesObjects[currentPluginId]\n                                if (currentPluginObject) {\n                                    currentPluginDraft = !currentPluginObject\n                                        .present.structure\n                                        ? currentPluginObject.draft\n                                        : currentPluginObject.present\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n    return {\n        userObject,\n        websites,\n        currentWebsiteItem,\n        currentWebsiteId,\n        currentWebsiteObject,\n        pagesStructure,\n        templatesStructure,\n        pluginsStructure,\n        currentPageId,\n        currentTemplateId,\n        currentPluginId,\n        currentPageItem,\n        currentTemplateItem,\n        currentPluginItem,\n        currentPageObject,\n        currentTemplateObject,\n        currentPluginObject,\n        currentPageDraft,\n        currentTemplateDraft,\n        currentPluginDraft,\n        pageTemplateName,\n        pageTemplateId,\n        pageTemplateItem,\n        pageTemplateObject,\n        pageTemplateDraft,\n        resourcesObjects,\n        userId,\n        tryWebsiter,\n        tooltipsOff,\n    }\n}\n","export const structure = {\n    page: 'pagesStructure',\n    plugin: 'pluginsStructure',\n    template: 'templatesStructure',\n}\n\nexport const current = {\n    page: 'currentPageId',\n    plugin: 'currentPluginId',\n    template: 'currentTemplateId',\n}\n\nexport const resourceDraftIndex = {\n    page: 'currentPageDraft',\n    plugin: 'currentPluginDraft',\n    template: 'currentTemplateDraft',\n}\n\nexport const resourceItemIndex = {\n    page: 'currentPageItem',\n    plugin: 'currentPluginItem',\n    template: 'currentTemplateItem',\n}\n\nexport const resourceObjectIndex = {\n    page: 'currentPageObject',\n    plugin: 'currentPluginObject',\n    template: 'currentTemplateObject',\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Div\":\"Checkbox_Div__2PqSf\",\"Input\":\"Checkbox_Input__1KbTF\",\"StyleControls\":\"Checkbox_StyleControls__cb7Ky\",\"Inline\":\"Checkbox_Inline__3XkB8\"};","import React from 'react'\n\ntype Props = {\n    className?: string,\n    icon: ?string,\n    datatestid?: string,\n}\n\ntype Element = {\n    type: string,\n    children: Array<Element>,\n    fill: string,\n    d: string,\n}\n\nexport const Svg = (props: Props) => {\n    const svgStringToObj = (svg: string): Object => {\n        const obj = []\n\n        const stack = []\n\n        while (svg.length > 0) {\n            svg = svg.trim()\n            if (svg.indexOf('</') === 0) {\n                svg = svg.substring(2)\n                if (svg.indexOf('<') > 0) {\n                    svg = svg.substring(svg.indexOf('<'))\n                    stack.pop()\n                } else {\n                    svg = ''\n                }\n            } else {\n                svg = svg.substring(svg.indexOf('<'))\n                const curObj = {\n                    type: svg.substring(1, svg.indexOf(' ')),\n                    children: [],\n                }\n                svg = svg.substring(svg.indexOf(' '))\n                let attr = svg.substring(0, svg.indexOf('>'))\n                let selfclosing = attr.indexOf('/>') >= 0\n\n                svg = svg.substring(svg.indexOf('>') + 1).trim()\n                while (attr.length > 0) {\n                    let key = attr.substring(0, attr.indexOf('=')).trim()\n                    attr = attr.substring(attr.indexOf('\"') + 1)\n                    let value = attr.substring(0, attr.indexOf('\"')).trim()\n                    attr = attr.substring(attr.indexOf('\"') + 1).trim()\n                    curObj[key] = value\n                }\n                if (stack.length === 0) {\n                    obj.push(curObj)\n                } else {\n                    stack[stack.length - 1].children.push(curObj)\n                }\n                if (!selfclosing) {\n                    stack.push(curObj)\n                }\n            }\n        }\n        return obj[0]\n    }\n\n    const svgChildrenToElements = (element: Element, elementIndex: number) => {\n        switch (element.type) {\n            case 'path':\n                return (\n                    <path key={elementIndex} d={element.d} fill={element.fill}>\n                        {element.children.map((el: Element, index) =>\n                            svgChildrenToElements(el, index)\n                        )}\n                    </path>\n                )\n            case 'g':\n                return (\n                    <g key={elementIndex} fill={element.fill}>\n                        {element.children.map((el: Element, index) =>\n                            svgChildrenToElements(el, index)\n                        )}\n                    </g>\n                )\n            default:\n                return\n        }\n    }\n\n    let result = null\n    if (props.icon) {\n        const objectSvg = svgStringToObj(props.icon)\n\n        result = (\n            <svg\n                data-testid={props.datatestid || 'svg'}\n                height={objectSvg.height}\n                width={objectSvg.width}\n                viewBox={objectSvg.viewBox}\n                className={props.className}\n            >\n                {objectSvg.children.map((element, index) =>\n                    svgChildrenToElements(element, index)\n                )}\n            </svg>\n        )\n    }\n    return result\n}\n\nexport default Svg\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Loader\":\"Spinner_Loader__2Sex0\",\"load3\":\"Spinner_load3__jNmcI\",\"Cover\":\"Spinner_Cover__3iRbu\"};"],"sourceRoot":""}